plot(E)
E <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "FUNL", distribution="normal",fit_type = "laplace",BMR=2,ewald = F,transform = T)
plot(E)
D <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "polynomial", distribution="normal",fit_type = "laplace", degree = 2, BMR = 1.5,ewald = F,transform = T)
plot(D)
temp <- PFOA_Liver %>% filter(X1 =="TDO2_9997")
v1 <- as.numeric(temp[2:length(temp)])
D <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "polynomial", distribution="normal",fit_type = "laplace", degree = 2, BMR = 1.5,ewald = F,transform = T)
plot(D)
temp <- PFOA_Liver %>% filter(X1 =="NPL_33133")
v1 <- as.numeric(temp[2:length(temp)])
D <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "polynomial", distribution="normal",fit_type = "laplace", degree = 2, BMR = 2,ewald = F,transform = T)
E <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "FUNL", distribution="normal",fit_type = "laplace",BMR=2,ewald = F,transform = T)
plot(D)
plot(E)
D <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "polynomial", distribution="normal",fit_type = "laplace", degree = 2, BMR = 2,ewald = F,transform = T)
D <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "polynomial", distribution="normal",fit_type = "laplace", degree = 2, BMR = 1.5,ewald = F,transform = T)
plot(D)
D$parameters
ds <- seq(0,100,1)
das <- arcsinh(ds)
das <- asinh(ds)
Ys <- 3.44 -0.459*das+0.0658*das^2
plot(ds,das)
plot(das,Ys)
plot(ds,Ys)
temp <- PFOA_Liver %>% filter(X1 =="EDM1_8524")
v1 <- as.numeric(temp[2:length(temp)])
D <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "polynomial", distribution="normal",fit_type = "laplace", degree = 2, BMR = 1.5,ewald = F,transform = T)
E <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "FUNL", distribution="normal",fit_type = "laplace",BMR=2,ewald = F,transform = T)
plot(doses,v1)
v1
temp <- PFOA_Liver %>% filter(X1 =="EDML_8524")
v1 <- as.numeric(temp[2:length(temp)])
D <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "polynomial", distribution="normal",fit_type = "laplace", degree = 2, BMR = 1.5,ewald = F,transform = T)
E <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "FUNL", distribution="normal",fit_type = "laplace",BMR=2,ewald = F,transform = T)
temp <- PFOA_Liver %>% filter(X1 =="EDEM1_8524")
v1 <- as.numeric(temp[2:length(temp)])
D <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "polynomial", distribution="normal",fit_type = "laplace", degree = 2, BMR = 1.5,ewald = F,transform = T)
E <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "FUNL", distribution="normal",fit_type = "laplace",BMR=2,ewald = F,transform = T)
plot(E)
plot(D)
temp <- PFOA_Liver %>% filter(X1 =="IGFBP1_32306")
v1 <- as.numeric(temp[2:length(temp)])
D <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "polynomial", distribution="normal",fit_type = "laplace", degree = 2, BMR = 1.5,ewald = F,transform = T)
E <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "FUNL", distribution="normal",fit_type = "laplace",BMR=2,ewald = F,transform = T)
plot(D)
plot(E)
library(ToxicR)
library(dplyr)
library(ggplot2)
D <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "polynomial", distribution="normal",fit_type = "laplace", degree = 2, BMR = 1.5,ewald = F,transform = T)
E <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "FUNL", distribution="normal",fit_type = "laplace",BMR=2,ewald = F,transform = T)
plot(E)
E <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "FUNL", distribution="normal",fit_type = "laplace",BMR=2,ewald = F,transform = F)
plot(E)
library(ToxicR)
library(dplyr)
library(ggplot2)
D <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "polynomial", distribution="normal",fit_type = "laplace", degree = 2, BMR = 1.5,ewald = F,transform = T)
E <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "FUNL", distribution="normal",fit_type = "laplace",BMR=2,ewald = F,transform = F)
plot(E)
E <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "FUNL", distribution="normal",fit_type = "laplace",BMR=2,ewald = F,transform = T)
plot(E)
D <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "polynomial", distribution="normal",fit_type = "laplace", degree = 2, BMR = 1.5,ewald = F,transform = T)
plot(D)
D <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "polynomial", distribution="normal",fit_type = "laplace", degree = 2, BMR = 1,ewald = F,transform = T)
E <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "FUNL", distribution="normal",fit_type = "laplace",BMR=1,ewald = F,transform = T)
plot(D)
plot(E)
D <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "polynomial", distribution="normal",fit_type = "laplace", degree = 2, BMR = 1,ewald = F,transform = T)
E <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "FUNL", distribution="normal",fit_type = "laplace",BMR=1,ewald = F,transform = T)
library(ToxicR)
library(dplyr)
library(ggplot2)
D <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "polynomial", distribution="normal",fit_type = "laplace", degree = 2, BMR = 1,ewald = F,transform = T)
E <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "FUNL", distribution="normal",fit_type = "laplace",BMR=1,ewald = F,transform = T)
plot(E)
E$parameters
plot(D)
temp <- PFOA_Liver %>% filter(X1 =="SULT1C2_33309")
v1 <- as.numeric(temp[2:length(temp)])
D <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "polynomial", distribution="normal",fit_type = "laplace", degree = 2, BMR = 1,ewald = F,transform = T)
E <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "FUNL", distribution="normal",fit_type = "laplace",BMR=1,ewald = F,transform = T)
plot(E)
plot(D)
temp <- PFOA_Liver %>% filter(X1 =="CD3D_33153")
D <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "polynomial", distribution="normal",fit_type = "laplace", degree = 2, BMR = 1,ewald = F,transform = T)
E <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "FUNL", distribution="normal",fit_type = "laplace",BMR=1,ewald = F,transform = T)
plot(E)
temp <- PFOA_Liver %>% filter(X1 =="CD3D_33153")
v1 <- as.numeric(temp[2:length(temp)])
D <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "polynomial", distribution="normal",fit_type = "laplace", degree = 2, BMR = 1,ewald = F,transform = T)
E <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "FUNL", distribution="normal",fit_type = "laplace",BMR=1,ewald = F,transform = T)
plot(E)
plot(D)
D <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "polynomial", distribution="normal",fit_type = "laplace", degree = 2, BMR = 1,ewald = F,transform = T)
E <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "FUNL", distribution="normal",fit_type = "laplace",BMR=1,ewald = F,transform = T)
plot(D)
plot(E)
temp <- PFOA_Liver %>% filter(X1 =="ADRB2_7997")
D <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "polynomial", distribution="normal",fit_type = "laplace", degree = 2, BMR = 1,ewald = F,transform = T)
E <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "FUNL", distribution="normal",fit_type = "laplace",BMR=1,ewald = F,transform = T)
plot(E)
temp <- PFOA_Liver %>% filter(X1 =="ADRB2_7997")
v1 <- as.numeric(temp[2:length(temp)])
D <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "polynomial", distribution="normal",fit_type = "laplace", degree = 2, BMR = 1,ewald = F,transform = T)
E <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "FUNL", distribution="normal",fit_type = "laplace",BMR=1,ewald = F,transform = T)
plot(E)
plot(D)
Conc_nM	<-c(0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
4.742541,	4.742541,	4.742541,	14.997233,	14.997233,
14.997233,	47.425413999999996,	47.425413999999996,
47.425413999999996,	149.97232699999998,	149.97232699999998,
149.97232699999998,	474.254138,	474.254138,	474.254138,
1499.723265,	1499.723265,	1499.723265,	4742.541378,
4742.541378, 4742.541378,	14997.232650000002,
14997.232650000002,	14997.232650000002,	47425.41378,	47425.41378,
47425.41378,	149972.3265,	149972.3265,	149972.3265)
PFOA_Liver <- read_table2("~/Downloads/compound16-2d-run1-plate1.txt",
col_names = FALSE)
library(readr)
PFOA_Liver <- read_table2("~/Downloads/compound16-2d-run1-plate1.txt",
col_names = FALSE)
doses<-c(0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
4.742541,	4.742541,	4.742541,	14.997233,	14.997233,
14.997233,	47.425413999999996,	47.425413999999996,
47.425413999999996,	149.97232699999998,	149.97232699999998,
149.97232699999998,	474.254138,	474.254138,	474.254138,
1499.723265,	1499.723265,	1499.723265,	4742.541378,
4742.541378, 4742.541378,	14997.232650000002,
14997.232650000002,	14997.232650000002,	47425.41378,	47425.41378,
47425.41378,	149972.3265,	149972.3265,	149972.3265)
doses2 <- asinh(doses)
temp <- PFOA_Liver %>% filter(X1 =="AEN_18198")
temp
PFOA_Liver <- read_table2("~/Downloads/compound16-2d-run1-plate1.txt",
col_names = TRUE)
temp <- PFOA_Liver %>% filter(X1 =="AEN_18198")
PFOA_Liver$V1
temp <- PFOA_Liver %>% filter(V1 =="AEN_18198")
v1 <- as.numeric(temp[2:length(temp)])
system.time({BB <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "hill", distribution="normal",fit_type = "laplace",BMR=1,ewald = T,transform = T)})
system.time({BB <- single_continuous_fit(as.matrix(doses),as.matrix(v2),distribution = "normal",model_type = "exp-3", fit_type = "mle",isFast = T)})
system.time({BB <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "hill", distribution="normal",fit_type = "laplace",BMR=1,ewald = T,transform = T)})
system.time({BB <- single_continuous_fit(as.matrix(doses),as.matrix(v1),distribution = "normal",model_type = "exp-3", fit_type = "mle",isFast = T)})
v1
system.time({BB <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "hill", distribution="normal",fit_type = "laplace",BMR=1,ewald = T,transform = T)})
D <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "polynomial", distribution="normal",fit_type = "laplace", degree = 2, BMR = 1,ewald = F,transform = T)
E <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "FUNL", distribution="normal",fit_type = "laplace",BMR=1,ewald = F,transform = T)
plot(E)
temp <- PFOA_Liver %>% filter(V1 =="ATP6V1D_574")
system.time({BB <- single_continuous_fit(as.matrix(doses),as.matrix(v1),distribution = "normal",model_type = "exp-3", fit_type = "mle",isFast = T)})
v1
E <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "FUNL", distribution="normal",fit_type = "laplace",BMR=1,ewald = F,transform = T)
plot(E)
v1 <- as.numeric(temp[2:length(temp)])
E <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "FUNL", distribution="normal",fit_type = "laplace",BMR=1,ewald = F,transform = T)
plot(E)
E <- single_continuous_fit(as.matrix(doses),as.matrix(asinh(v1)),model_type = "FUNL", distribution="normal",fit_type = "laplace",BMR=1,ewald = F,transform = T)
plot(E)
temp <- PFOA_Liver %>% filter(V1 =="AEN_18198")
v1 <- as.numeric(temp[2:length(temp)])
E <- single_continuous_fit(as.matrix(doses),as.matrix(asinh(v1)),model_type = "FUNL", distribution="normal",fit_type = "laplace",BMR=1,ewald = F,transform = T)
plot(E)
E <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "FUNL", distribution="normal",fit_type = "laplace",BMR=1,ewald = F,transform = T)
plot(E)
E <- single_continuous_fit(as.matrix(doses),as.matrix(asinh(v1)),model_type = "FUNL", distribution="normal",fit_type = "laplace",BMR=1,ewald = F,transform = T)
plot(E)+scale_x_continuous(trans="pseudo_log")
D <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "polynomial", distribution="normal",fit_type = "laplace", degree = 2, BMR = 1,ewald = F,transform = T)
plot(D)+scale_x_continuous(trans="pseudo_log")
D <- single_continuous_fit(as.matrix(doses),as.matrix(asinh(v1)),model_type = "polynomial", distribution="normal",fit_type = "laplace", degree = 2, BMR = 1,ewald = F,transform = T)
plot(D)+scale_x_continuous(trans="pseudo_log")
E <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "FUNL", distribution="normal",fit_type = "laplace",BMR=1,ewald = F,transform = T)
plot(D)+scale_x_continuous(trans="pseudo_log")
E <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "FUNL", distribution="normal",fit_type = "laplace",BMR=1,ewald = F,transform = T)
plot(E)+scale_x_continuous(trans="pseudo_log")
ty <- v1[doses != 0]
tt <- doses[doses !=0]
D <- single_continuous_fit(as.matrix(td),as.matrix(asinh(ty)),model_type = "polynomial", distribution="normal",fit_type = "laplace", degree = 2, BMR = 1,ewald = F,transform = T)
E <- single_continuous_fit(as.matrix(td),as.matrix(ty1),model_type = "FUNL", distribution="normal",fit_type = "laplace",BMR=1,ewald = F,transform = T)
ty
ty <- v1[v1 != 0]
tt <- doses[v1 !=0]
D <- single_continuous_fit(as.matrix(td),as.matrix(asinh(ty)),model_type = "polynomial", distribution="normal",fit_type = "laplace", degree = 2, BMR = 1,ewald = F,transform = T)
E <- single_continuous_fit(as.matrix(td),as.matrix(ty1),model_type = "FUNL", distribution="normal",fit_type = "laplace",BMR=1,ewald = F,transform = T)
ty <- v1[v1 != 0]
tt <- doses[v1 !=0]
D <- single_continuous_fit(as.matrix(td),as.matrix(asinh(ty)),model_type = "polynomial", distribution="normal",fit_type = "laplace", degree = 2, BMR = 1,ewald = F,transform = T)
E <- single_continuous_fit(as.matrix(td),as.matrix(ty),model_type = "FUNL", distribution="normal",fit_type = "laplace",BMR=1,ewald = F,transform = T)
ty <- v1[v1 != 0]
td <- doses[v1 !=0]
D <- single_continuous_fit(as.matrix(td),as.matrix(asinh(ty)),model_type = "polynomial", distribution="normal",fit_type = "laplace", degree = 2, BMR = 1,ewald = F,transform = T)
E <- single_continuous_fit(as.matrix(td),as.matrix(ty),model_type = "FUNL", distribution="normal",fit_type = "laplace",BMR=1,ewald = F,transform = T)
plot(E)
ty <- v1[v1 >10 ]
td <- doses[v1 > 10]
D <- single_continuous_fit(as.matrix(td),as.matrix(asinh(ty)),model_type = "polynomial", distribution="normal",fit_type = "laplace", degree = 2, BMR = 1,ewald = F,transform = T)
E <- single_continuous_fit(as.matrix(td),as.matrix(ty),model_type = "FUNL", distribution="normal",fit_type = "laplace",BMR=1,ewald = F,transform = T)
plot(E)
plot(D)
doses
ty <- v1[doses > 5000 ]
td <- doses[doses > 5000]
D <- single_continuous_fit(as.matrix(td),as.matrix(asinh(ty)),model_type = "polynomial", distribution="normal",fit_type = "laplace", degree = 2, BMR = 1,ewald = F,transform = T)
E <- single_continuous_fit(as.matrix(td),as.matrix(ty),model_type = "FUNL", distribution="normal",fit_type = "laplace",BMR=1,ewald = F,transform = T)
plot(E)
ty <- v1[doses < 5000 ]
td <- doses[doses < 5000]
D <- single_continuous_fit(as.matrix(td),as.matrix(asinh(ty)),model_type = "polynomial", distribution="normal",fit_type = "laplace", degree = 2, BMR = 1,ewald = F,transform = T)
E <- single_continuous_fit(as.matrix(td),as.matrix(ty),model_type = "FUNL", distribution="normal",fit_type = "laplace",BMR=1,ewald = F,transform = T)
plot(E)+scale_x_continuous(trans="pseudo_log")
doses
ty <- v1[doses < 50000 ]
td <- doses[doses < 50000]
D <- single_continuous_fit(as.matrix(td),as.matrix(asinh(ty)),model_type = "polynomial", distribution="normal",fit_type = "laplace", degree = 2, BMR = 1,ewald = F,transform = T)
E <- single_continuous_fit(as.matrix(td),as.matrix(ty),model_type = "FUNL", distribution="normal",fit_type = "laplace",BMR=1,ewald = F,transform = T)
plot(E)+scale_x_continuous(trans="pseudo_log")
plot(E)
D <- single_continuous_fit(as.matrix(td),as.matrix(asinh(ty)),model_type = "polynomial", distribution="normal",fit_type = "laplace", degree = 2, BMR = 1,ewald = F,transform = F)
E <- single_continuous_fit(as.matrix(td),as.matrix(ty),model_type = "FUNL", distribution="normal",fit_type = "laplace",BMR=1,ewald = F,transform = F)
plot(E)
E <- single_continuous_fit(as.matrix(td),as.matrix(asinh(ty)),model_type = "FUNL", distribution="normal",fit_type = "laplace",BMR=1,ewald = F,transform = F)
plot(E)
plot(E)+scale_x_continuous(trans="pseudo_log")
doses = 0:100
v <- 1/(1+exp(-(doses-10)/10))
plot(doses,v)
v <- 1/(1+exp(-(doses+10)/10))
plot(doses,v)
v <- 1/(1+exp(-(doses+10)/0.10))
plot(doses,v)
v <- 1/(1+exp(-(arcsin(doses)+10)/0.10))
v <- 1/(1+exp(-(asinh(doses)+10)/0.10))
plot(doses,v)
v <- 1/(1+exp(-(asinh(doses)+10)/10))
plot(doses,v)
plot(doses,v*dnorm(doses,30,sqrt(100)))
plot(doses,v*dnorm(doses,10,sqrt(100)))
skewN<-function(d,m,s,a){
return(dnorm((d-m)/s)*pnorm(a*(d-m)/s))
}
doses
plot(doses,sdkewN(doses,10,10,-1))
plot(doses,skewN(doses,10,10,-1))
plot(doses,skewN(doses,20,10,-1))
plot(doses,skewN(doses,20,10,-10))
plot(doses,skewN(doses,20,40,-10))
plot(doses,skewN(doses,40,40,-10))
plot(doses,skewN(doses,40,40,-5))
plot(doses,skewN(doses,40,40,-10))
plot(doses,skewN(doses,40,30,-10))
plot(doses,skewN(doses,40,250,-10))
plot(doses,skewN(doses,40,25,-10))
plot(doses,skewN(doses,40,19,-10))
plot(doses,skewN(doses,40,19,-5))
plot(doses,skewN(doses,40,19,-0))
plot(doses,skewN(doses,40,19,-1))
plot(doses,skewN(doses,40,19,-3))
plot(doses,skewN(doses,50,19,-3))
plot(doses,skewN(doses,50,29,-3))
skewL<-function(d,m,s,a){
return(dnorm((d-m)/s)*(1/exp(-a*(d-m)/s))
}
skewL<-function(d,m,s,a){
return(dnorm((d-m)/s)*(1/exp(-a*(d-m)/s)))
}
plot(doses,skewL(doses,50,29,-3))
plot(doses,skewL(doses,100,29,-3))
plot(doses,skewL(doses,100,10,-3))
skewL<-function(d,m,s,a){
return( exp((d-m)/s)/(1+exp((d-m)/s))^a)
}
plot(doses,skewL(doses,50,29,-3))
plot(doses,skewL(doses,50,29,3))
plot(doses,skewL(doses,30,5,3))
plot(doses,skewL(doses,30,5,5))
plot(doses,skewL(doses,30,5,10))
plot(doses,skewL(doses,30,50,10))
plot(doses,skewL(doses,30,15,10))
plot(doses,skewL(doses,20,15,10))
plot(doses,skewL(doses,40,15,10))
plot(doses,skewL(doses,60,15,10))
plot(doses,skewL(doses,80,15,10))
plot(doses,skewL(doses,80,15,20))
plot(doses,skewL(doses,80,15,-1))
plot(doses,skewL(doses,80,15,-2))
plot(doses,skewL(doses,80,15,2))
plot(doses,skewL(doses,80,15,200))
plot(doses,skewL(doses,80,15,20))
beta(1,1)
beta(10,10)
skewL<-function(d,m,s,a){
return( a*exp(-(d-m)/s)/(1+exp(-(d-m)/s))^a)
}
skewL<-function(d,m,s,a){
return( a*exp(-(d-m)/s)/(1+exp(-(d-m)/s))^(a+1))
}
plot(doses,skewL(doses,80,15,20))
plot(doses,skewL(doses,80,15,2))
plot(doses,skewL(doses,80,15,23))
plot(doses,skewL(doses,80,15,3))
plot(doses,skewL(doses,30,15,3))
plot(doses,skewL(doses,30,15,-3))
plot(doses,skewL(doses,30,15,-1))
plot(doses,skewL(doses,30,15,1))
plot(doses,skewL(doses,30,1,1))
skewN<-function(d,m,s,a){
return(dnorm((d-m)/s)*pnorm(a*(d-m)/s))
}
plot(doses,skewN(doses,30,1,1))
plot(doses,skewN(doses,30,13,1))
plot(doses,skewN(doses,30,13,-1))
plot(doses,skewN(doses,30,13,-61))
plot(doses,skewN(doses,30,100,-61))
plot(doses,skewN(doses,30,300,-61))
plot(doses,skewN(doses,80,300,-61))
plot(doses,skewN(doses,80,100,-61))
plot(doses,skewN(doses,80,50,-61))
plot(doses,skewN(doses,80,50,1))
plot(doses,skewN(doses,80,20,1))
skewL<-function(d,m,s,a){
return( exp(-a(d-m)/s)/(1+exp(-(d-m)/s))^(2*a))
}
plot(doses,skewN(doses,80,20,1))
plot(doses,skewL(doses,80,20,1))
skewL<-function(d,m,s,a){
return( exp(-a*(d-m)/s)/(1+exp(-(d-m)/s))^(2*a))
}
plot(doses,skewL(doses,80,20,1))
plot(doses,skewL(doses,80,20,2))
plot(doses,skewL(doses,80,30,2))
plot(doses,skewL(doses,80,30,50))
plot(doses,skewL(doses,80,100,50))
plot(doses,skewL(doses,80,100,10))
plot(doses,skewL(doses,80,100,2000))
skewL<-function(d,m,s,a,b){
r = 2/(a+2)*exp(-(d-m)/s)/(1+exp(-(d-m)/s))
s = (1 + a*exp(-b*(d-m)/s)/(1+exp(-b*(d-m)/s)))
return( r*s )
}
plot(doses,50,10,1,5)
plot(doses,skewL(doses,50,10,1,5))
plot(doses,skewL(doses,50,10,1,1))
plot(doses,skewL(doses,50,12,1,1))
skewL<-function(d,m,s,a,b){
r = 2/(a+2)*exp(-(d-m)/s)/(1+exp(-(d-m)/s))^2
s = (1 + a*exp(-b*(d-m)/s)/(1+exp(-b*(d-m)/s)))
return( r*s )
}
plot(doses,skewL(doses,50,12,1,1))
plot(doses,skewL(doses,50,12,1,2))
plot(doses,skewL(doses,50,12,1,10))
plot(doses,skewL(doses,50,12,1,20))
plot(doses,skewL(doses,50,12,20,20))
plot(doses,skewL(doses,50,12,20,1))
plot(doses,skewL(doses,50,12,1000,1))
plot(doses,skewL(doses,50,12,20,1))
plot(doses,skewL(doses,50,1,20,1))
plot(doses,skewL(doses,50,1,20,5))
plot(doses,skewL(doses,0,1,20,5))
plot(doses,skewL(doses,0,10,20,5))
plot(doses,skewL(doses,50,10,20,5))
plot(doses,skewL(doses,50,10,20,1))
plot(doses,skewL(doses,50,10,20,5))
plot(doses,skewL(doses,50,10,20,10))
plot(doses,skewL(doses,50,10,50,10))
plot(doses,skewL(doses,50,30,50,10))
plot(doses,skewL(doses,50,33,50,10))
plot(doses,skewL(doses,50,253,50,10))
plot(doses,skewL(doses,50,25,50,10))
plot(doses,skewL(doses,50,25,50,20))
plot(doses,skewL(doses,50,25,3,20))
plot(doses,skewL(doses,50,25,3,20))
plot(doses,skewL(doses,50,25,4,20))
plot(doses,skewL(doses,50,25,1.5,20))
plot(doses,skewL(doses,50,25,1.25,20))
plot(doses,skewL(doses,50,25,0.25,20))
plot(doses,skewL(doses,50,35,0.25,20))
plot(doses,skewL(doses,50,35,0.25,20))
library(ToxicR)
library(ToxicR)
library(ggplot2)
prior <- create_prior_list(normprior(0,1,-100,100),
normprior(0,10,-1e4,1e4),
lnormprior(0,1,0,100),
lnormprior(log(2),0.4215,0,18),
#lnormprior(0, 0.75,0,100),
normprior(0, 10,-100,100));
bob = create_continuous_prior(prior,"exp-5","lognormal")
v1 <- c(13.184152,12.8906975,12.359554,13.073001,12.861814,12.967434,12.88052,
13.249991,	12.992931,	13.022338,	13.614057,	13.287018,	13.449239,	13.950747,
13.239134,	13.82321,	15.080262,	14.85966,	14.7805395,	15.238369,	14.749196,
14.913585,	15.181719,	15.051697,	15.065641,	15.16396,	15.484345,	16.493923,
15.633442,	15.96033,	15.388061)
prior <- create_prior_list(lnormprior(0,1,-100 ,100),
normprior( 0, 1,-100,100),#normprior(1,2,-18,18),
lnormprior(0 ,1,0   ,100),
lnormprior(0,1 ,0   ,18 ),
normprior(0,2  ,-18 ,18));
Bob <- ma_continuous_fit(as.matrix(doses),as.matrix(v1)+10,fit_type ="laplace",BMR = 1, model_list = a )
library(readr)
PFOA_Liver <- read_table2("~/OneDrive - National Institutes of Health/Projects/2021/Continuous MA/data/PFOA_Liver_lin_Control_Ratio.txt",
col_names = FALSE)
PFOA_Liver <- PFOA_Liver[-(1:2),]
doses	<- c(0,	0,	0,	0,	0.156,	0.156,	0.156,	0.3125,	0.3125,	0.3125,
0.625,	0.625,	0.625,	1.25,	1.25,	1.25,	2.5,	2.5,	2.5,	5,5,
5,	5,	10,	10,	10,	10,	20,	20,	20,	20)
R  <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "hill", distribution="normal",fit_type = "laplace",BMR = 1,isFast = FALSE)
R  <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "hill", distribution="normal",fit_type = "laplace",BMR = 1,ewald = FALSE)
R
Bob <- ma_continuous_fit(as.matrix(doses),as.matrix(v1),fit_type = "mcmc",BMR = 2,model_list = model_list )
library(ToxicR)
library(ggplot2)
prior <- create_prior_list(normprior(0,1,-100,100),
normprior(0,10,-1e4,1e4),
lnormprior(0,1,0,100),
lnormprior(log(2),0.4215,0,18),
#lnormprior(0, 0.75,0,100),
normprior(0, 10,-100,100));
bob = create_continuous_prior(prior,"exp-5","lognormal")
library(ToxicR)
doses <- c(0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.948669,0.948669,0.948669,2.999955,2.999955,2.999955,9.48669,9.48669,9.48669,29.999548,29.999548,29.999548,94.8669,94.8669,94.8669,299.99548,299.99548,299.99548,948.669,948.669,948.669,2999.9548,2999.9548,2999.9548,9486.69,9486.69,9486.69)
v2 <- c(6.957,7.838,7.157,7.589,7.808,7.305,7.143,7.778,7.449,7.761,7.485,8.03,6.863,7.062,7.611,7.135,7.484,7.161,7.272,7.603,7.428,7.291,7.048,7.562,7.324,7.17,7.072,7.252,7.249,7.397,6.983,7.175,7.13,8.341,8.289,8.201,8.838,8.865,8.971)
v1 <- c(13.184152,12.8906975,12.359554,13.073001,12.861814,12.967434,12.88052,
13.249991,	12.992931,	13.022338,	13.614057,	13.287018,	13.449239,	13.950747,
13.239134,	13.82321,	15.080262,	14.85966,	14.7805395,	15.238369,	14.749196,
14.913585,	15.181719,	15.051697,	15.065641,	15.16396,	15.484345,	16.493923,
15.633442,	15.96033,	15.388061)
v2 <- v1/mean(v1[doses==0])
prior <- create_prior_list(lnormprior(0,1,-100,100),
normprior( 0, 1,-100,100),#normprior(1,2,-18,18),
lnormprior(0 ,1,0,100),
lnormprior(0,1,0,18),
normprior(0,2,-18,18));
library(readr)
PFOA_Liver <- read_table2("~/Documents/PFOA_Liver.txt",
col_names = FALSE)
PFOA_Liver <- read_table2("~/Downloads/compound16-2d-run1-plate1.txt",
col_names = TRUE)
doses<- c(0,0,0,0,0.156,0.156,0.156,0.3125,0.3125,0.3125,
0.625,0.625,0.625,1.25,1.25,1.25,2.5,2.5,2.5,5,5,
5,5,10,10,10,10,20,20,20,20)
doses<-c(0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,
4.742541,	4.742541,	4.742541,	14.997233,	14.997233,
14.997233,	47.425413999999996,	47.425413999999996,
47.425413999999996,	149.97232699999998,	149.97232699999998,
149.97232699999998,	474.254138,	474.254138,	474.254138,
1499.723265,	1499.723265,	1499.723265,	4742.541378,
4742.541378, 4742.541378,	14997.232650000002,
14997.232650000002,	14997.232650000002,	47425.41378,	47425.41378,
47425.41378,	149972.3265,	149972.3265,	149972.3265)
doses2 <- asinh(doses)
library(ToxicR)
library(dplyr)
library(ggplot2)
temp <- PFOA_Liver %>% filter(X1 =="LOC100912409_9106")
temp <- PFOA_Liver %>% filter(V1 =="AEN_18198")
v1 <- as.numeric(temp[2:length(temp)])
BB <- ma_continuous_fit(as.matrix(doses)/20,as.matrix(v2),fit_type = "laplace",BMR = 1)
BB <- ma_continuous_fit(as.matrix(doses),as.matrix(v1),fit_type = "laplace")
class(R)
class(BB$Individual_Model_1)
class(BB)
mData <- matrix(c(0, 2,50,
1, 2,50,
3, 10, 50,
16, 18,50,
32, 18,50,
33, 17,50),nrow=6,ncol=3,byrow=T)
A = ma_dichotomous_fit(mData[,1],mData[,2],mData[,3],fit_type = "mcmc")
plot(G)
G = single_dichotomous_fit(mData[,1],mData[,2],mData[,3],model_type = "gamma", fit_type = "mle")
plot(G)
G = single_dichotomous_fit(mData[,1],mData[,2],mData[,3],model_type = "hill", fit_type = "mle")
plot(G)
#06/07/21 SL update
library(ToxicR)
M2           <- matrix(0,nrow=5,ncol=4)
# double D[] = {0,50, 100, 150, 200};
# double Y[] = {10, 0 , -10, -20 ,-30};
# double N[] = {100, 100, 100, 100, 100};
# double SD[] = {3, 4, 5, 6, 7};
colnames(M2) <- c("Dose","Resp","N","StDev")
#M2[, 1]      <- c(0,	0.156,	0.312,	0.625,	1.25,	2.5)
#M2[, 2]      <- c(33.52,	37.66,	40.08,	44.25,	50.84,	67.75)
#M2[, 3]      <- c(10,	10,	10,	10,	10,	10)
#M2[, 4]      <- c(2.371708245,	2.814427118,	1.77087549,	2.593067681,	2.118726032,	2.846049894)
M2[,1] <- c(0,25,50,100,200)
M2[,3] <- c(20,20,19,20,20)
M2[,2] <- c(6,5.2,2.4,1.1,0.75)
M2[,4]<-  c(1.2,1.1,0.81,0.74,0.66)
c = single_continuous_fit(M2[,1,drop=F],M2[,2:4],BMD_TYPE="sd",BMR=1,
distribution = "normal",fit_type="laplace",model_type = "hill",degree = 4,isFast=F)
c = single_continuous_fit(M2[,1,drop=F],M2[,2:4],BMD_TYPE="sd",BMR=1,
distribution = "normal",fit_type="laplace",model_type = "hill",degree = 4,ewald=F)
plot(c)
cleveland_plot(B)
B = ma_dichotomous_fit(mData[,1],mData[,2],mData[,3],fit_type = "mcmc")
cleveland_plot(B)
MAdensity_plot(B)
B$Individual_Model_1$mcmc_result$BMD_samples
lnormprior(0,1,-100,100)
prior <- create_prior_list(lnormprior(0,1,-100,100),
normprior( 0, 1,-100,100),#normprior(1,2,-18,18),
lnormprior(0 ,1,0,100),
lnormprior(0,1,0,18),
normprior(0,2,-18,18));
prior
create_continuous_prior(prior,"hill")
create_continuous_prior(prior,"normal","hill")
create_continuous_prior(prior,"hill","normal")
