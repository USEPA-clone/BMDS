d = 10
for (ii in 1:7){
d = d - dFUN(B,d)/d2FUN(B,d)
}
lines(doses,FUN(B,doses),col=2,lwd=3)
FUN(B,0.44597) - FUN(B,0)
set.seed(893223)
D <- rep(seq(0,1.0,1/4),each=11)
mean <- 2.3  - 2/(1+exp(-(D-0.37)*5))*(1/(1+exp(-(0.75-D)*3)))
Y <- mean + rnorm(length(mean),0,0.025)
system.time({B <-test_skn(as.matrix(Y), as.matrix(D))})
FUN(B,0.350016) - FUN(B,0)
plot(D,Y,pch=16)
doses <- seq(0,1,0.01)
FUN <-function(A,doses){
b <- A[1] + A[2]*exp((doses-A[5])^2*(-A[6]))*(1/(1+exp(-(doses-A[3])/A[4])))
return(b)
}
dFUN <- function(A,d){
a = -2*A[6]*(d-A[5]) + (1/A[4])*exp(-(1/A[4])*(d-A[3]))/(1  + exp(-(1/A[4])*(d-A[3])))
return (a)
}
d2FUN <- function(A,d){
a = -2*A[6] - (1/A[4])^2*exp(-(1/A[4])*(d-A[3]))/((1  + exp(-(1/A[4])*(d-A[3]))))^2
return (a)
}
d = 10
for (ii in 1:7){
d = d - dFUN(B,d)/d2FUN(B,d)
}
lines(doses,FUN(B,doses),col=2,lwd=3)
FUN(B,0.44597) - FUN(B,0)
FUN(B,0.200362)
library(ToxicR)
set.seed(893223)
D <- rep(seq(0,1.0,1/4),each=11)
mean <- 2.3  - 2/(1+exp(-(D-0.37)*5))*(1/(1+exp(-(0.75-D)*3)))
Y <- mean + rnorm(length(mean),0,0.025)
system.time({B <-test_skn(as.matrix(Y), as.matrix(D))})
FUN(B,0.350016) - FUN(B,0)
plot(D,Y,pch=16)
doses <- seq(0,1,0.01)
d = 10
for (ii in 1:7){
d = d - dFUN(B,d)/d2FUN(B,d)
}
lines(doses,FUN(B,doses),col=2,lwd=3)
FUN <-function(A,doses){
b <- A[1] + A[2]*exp((doses-A[5])^2*(-A[6]))*(1/(1+exp(-(doses-A[3])/A[4])))
return(b)
}
dFUN <- function(A,d){
a = -2*A[6]*(d-A[5]) + (1/A[4])*exp(-(1/A[4])*(d-A[3]))/(1  + exp(-(1/A[4])*(d-A[3])))
return (a)
}
d2FUN <- function(A,d){
a = -2*A[6] - (1/A[4])^2*exp(-(1/A[4])*(d-A[3]))/((1  + exp(-(1/A[4])*(d-A[3]))))^2
return (a)
}
library(ToxicR)
set.seed(893223)
D <- rep(seq(0,1.0,1/4),each=11)
mean <- 2.3  - 2/(1+exp(-(D-0.37)*5))*(1/(1+exp(-(0.75-D)*3)))
Y <- mean + rnorm(length(mean),0,0.025)
system.time({B <-test_skn(as.matrix(Y), as.matrix(D))})
B
set.seed(893223)
D <- rep(seq(0,1.0,1/4),each=11)
mean <- 2.3  + 2/(1+exp(-(D-0.37)*5))*(1/(1+exp(-(0.75-D)*3)))
Y <- mean + rnorm(length(mean),0,0.025)
FUN <-function(A,doses){
b <- A[1] + A[2]*exp((doses-A[5])^2*(-A[6]))*(1/(1+exp(-(doses-A[3])/A[4])))
return(b)
}
dFUN <- function(A,d){
a = -2*A[6]*(d-A[5]) + (1/A[4])*exp(-(1/A[4])*(d-A[3]))/(1  + exp(-(1/A[4])*(d-A[3])))
return (a)
}
d2FUN <- function(A,d){
a = -2*A[6] - (1/A[4])^2*exp(-(1/A[4])*(d-A[3]))/((1  + exp(-(1/A[4])*(d-A[3]))))^2
return (a)
}
library(ToxicR)
set.seed(893223)
D <- rep(seq(0,1.0,1/4),each=11)
mean <- 2.3  + 2/(1+exp(-(D-0.37)*5))*(1/(1+exp(-(0.75-D)*3)))
Y <- mean + rnorm(length(mean),0,0.025)
plot(D,Y,pch=16)
Y <- mean + rnorm(length(mean),0,0.025)
system.time({B <-test_skn(as.matrix(Y), as.matrix(D))})
B
FUN <-function(A,doses){
b <- A[1] + A[2]*exp((doses-A[5])^2*(-A[6]))*(1/(1+exp(-(doses-A[3])/A[4])))
return(b)
}
dFUN <- function(A,d){
a = -2*A[6]*(d-A[5]) + (1/A[4])*exp(-(1/A[4])*(d-A[3]))/(1  + exp(-(1/A[4])*(d-A[3])))
return (a)
}
d2FUN <- function(A,d){
a = -2*A[6] - (1/A[4])^2*exp(-(1/A[4])*(d-A[3]))/((1  + exp(-(1/A[4])*(d-A[3]))))^2
return (a)
}
library(ToxicR)
set.seed(893223)
D <- rep(seq(0,1.0,1/4),each=11)
mean <- 2.3  + 2/(1+exp(-(D-0.37)*5))*(1/(1+exp(-(0.75-D)*3)))
Y <- mean + rnorm(length(mean),0,0.025)
system.time({B <-test_skn(as.matrix(Y), as.matrix(D))})
FUN <-function(A,doses){
b <- A[1] + A[2]*exp((doses-A[5])^2*(-A[6]))*(1/(1+exp(-(doses-A[3])/A[4])))
return(b)
}
dFUN <- function(A,d){
a = -2*A[6]*(d-A[5]) + (1/A[4])*exp(-(1/A[4])*(d-A[3]))/(1  + exp(-(1/A[4])*(d-A[3])))
return (a)
}
d2FUN <- function(A,d){
a = -2*A[6] - (1/A[4])^2*exp(-(1/A[4])*(d-A[3]))/((1  + exp(-(1/A[4])*(d-A[3]))))^2
return (a)
}
library(ToxicR)
set.seed(893223)
D <- rep(seq(0,1.0,1/4),each=11)
mean <- 2.3  + 2/(1+exp(-(D-0.37)*5))*(1/(1+exp(-(0.75-D)*3)))
Y <- mean + rnorm(length(mean),0,0.025)
system.time({B <-test_skn(as.matrix(Y), as.matrix(D))})
FUN <-function(A,doses){
b <- A[1] + A[2]*exp((doses-A[5])^2*(-A[6]))*(1/(1+exp(-(doses-A[3])/A[4])))
return(b)
}
dFUN <- function(A,d){
a = -2*A[6]*(d-A[5]) + (1/A[4])*exp(-(1/A[4])*(d-A[3]))/(1  + exp(-(1/A[4])*(d-A[3])))
return (a)
}
d2FUN <- function(A,d){
a = -2*A[6] - (1/A[4])^2*exp(-(1/A[4])*(d-A[3]))/((1  + exp(-(1/A[4])*(d-A[3]))))^2
return (a)
}
library(ToxicR)
set.seed(893223)
D <- rep(seq(0,1.0,1/4),each=11)
mean <- 2.3  + 2/(1+exp(-(D-0.37)*5))*(1/(1+exp(-(0.75-D)*3)))
Y <- mean + rnorm(length(mean),0,0.025)
system.time({B <-test_skn(as.matrix(Y), as.matrix(D))})
B
FUN <-function(A,doses){
b <- A[1] + A[2]*exp((doses-A[5])^2*(-A[6]))*(1/(1+exp(-(doses-A[3])/A[4])))
return(b)
}
dFUN <- function(A,d){
a = -2*A[6]*(d-A[5]) + (1/A[4])*exp(-(1/A[4])*(d-A[3]))/(1  + exp(-(1/A[4])*(d-A[3])))
return (a)
}
d2FUN <- function(A,d){
a = -2*A[6] - (1/A[4])^2*exp(-(1/A[4])*(d-A[3]))/((1  + exp(-(1/A[4])*(d-A[3]))))^2
return (a)
}
library(ToxicR)
set.seed(893223)
D <- rep(seq(0,1.0,1/4),each=11)
mean <- 2.3  + 2/(1+exp(-(D-0.37)*5))*(1/(1+exp(-(0.75-D)*3)))
Y <- mean + rnorm(length(mean),0,0.025)
system.time({B <-test_skn(as.matrix(Y), as.matrix(D))})
q
B
FUN <-function(A,doses){
b <- A[1] + A[2]*exp((doses-A[5])^2*(-A[6]))*(1/(1+exp(-(doses-A[3])/A[4])))
return(b)
}
dFUN <- function(A,d){
a = -2*A[6]*(d-A[5]) + (1/A[4])*exp(-(1/A[4])*(d-A[3]))/(1  + exp(-(1/A[4])*(d-A[3])))
return (a)
}
d2FUN <- function(A,d){
a = -2*A[6] - (1/A[4])^2*exp(-(1/A[4])*(d-A[3]))/((1  + exp(-(1/A[4])*(d-A[3]))))^2
return (a)
}
library(ToxicR)
set.seed(893223)
D <- rep(seq(0,1.0,1/4),each=11)
mean <- 2.3  + 2/(1+exp(-(D-0.37)*5))*(1/(1+exp(-(0.75-D)*3)))
Y <- mean + rnorm(length(mean),0,0.025)
system.time({B <-test_skn(as.matrix(Y), as.matrix(D))})
FUN(B,0.350016) - FUN(B,0)
plot(D,Y,pch=16)
doses <- seq(0,1,0.01)
B
FUN(a,0.0872385) - FUN(a,0)
a <- c(2.30327,
1.51189,
0.409881,
0.123981,
0.243472,
1.44061,
-7.31321)
FUN(a,0.0872385) - FUN(a,0)
FUN(b,0.0872385) - FUN(a,0)
b <- c(2.30326,
1.51572,
0.366407,
0.237504,
0.24084,
1.44048,
-7.31321)
FUN(b,0.0872385) - FUN(a,0)
FUN(b,0.0872385) - FUN(b,0)
FUN(a,0.0872385) - FUN(a,0)
FUN <-function(A,doses){
b <- A[1] + A[2]*exp((doses-A[5])^2*(-A[6]))*(1/(1+exp(-(doses-A[3])/A[4])))
return(b)
}
dFUN <- function(A,d){
a = -2*A[6]*(d-A[5]) + (1/A[4])*exp(-(1/A[4])*(d-A[3]))/(1  + exp(-(1/A[4])*(d-A[3])))
return (a)
}
d2FUN <- function(A,d){
a = -2*A[6] - (1/A[4])^2*exp(-(1/A[4])*(d-A[3]))/((1  + exp(-(1/A[4])*(d-A[3]))))^2
return (a)
}
library(ToxicR)
set.seed(893223)
D <- rep(seq(0,1.0,1/4),each=11)
mean <- 2.3  + 2/(1+exp(-(D-0.37)*5))*(1/(1+exp(-(0.75-D)*3)))
Y <- mean + rnorm(length(mean),0,0.025)
system.time({B <-test_skn(as.matrix(Y), as.matrix(D))})
a <- c(2.30327,
1.51189,
0.409881,
0.123981,
0.243472,
1.44061,
-7.31321)
b <- c(2.30326,
1.51572,
0.366407,
0.237504,
0.24084,
1.44048,
-7.31321)
FUN(a,0.0872385) - FUN(a,0)
FUN <-function(A,doses){
b <- A[1] + A[2]*exp((doses-A[5])^2*(-A[6]))*(1/(1+exp(-(doses-A[3])/A[4])))
return(b)
}
dFUN <- function(A,d){
a = -2*A[6]*(d-A[5]) + (1/A[4])*exp(-(1/A[4])*(d-A[3]))/(1  + exp(-(1/A[4])*(d-A[3])))
return (a)
}
d2FUN <- function(A,d){
a = -2*A[6] - (1/A[4])^2*exp(-(1/A[4])*(d-A[3]))/((1  + exp(-(1/A[4])*(d-A[3]))))^2
return (a)
}
library(ToxicR)
set.seed(893223)
D <- rep(seq(0,1.0,1/4),each=11)
mean <- 2.3  + 2/(1+exp(-(D-0.37)*5))*(1/(1+exp(-(0.75-D)*3)))
Y <- mean + rnorm(length(mean),0,0.025)
system.time({B <-test_skn(as.matrix(Y), as.matrix(D))})
FUN(B,0.350016) - FUN(B,0)
plot(D,Y,pch=16)
doses <- seq(0,1,0.01)
B
FUN(a,0.08636607) - FUN(a,0)
FUN(a,0.08811084) - FUN(a,0)
a <- c(2.30324,
1.03787,
0.407873,
0.14622,
0.243903,
1.44069,
-7.31321)
FUN(a,0.08811084) - FUN(a,0)
B
FUN(a,0.08636607) - FUN(a,0)
FUN(b,0.08811084) - FUN(b,0)
FUN <-function(A,doses){
b <- A[1] + A[2]*exp((doses-A[5])^2*(-A[6]))*(1/(1+exp(-(doses-A[3])/A[4])))
return(b)
}
dFUN <- function(A,d){
a = -2*A[6]*(d-A[5]) + (1/A[4])*exp(-(1/A[4])*(d-A[3]))/(1  + exp(-(1/A[4])*(d-A[3])))
return (a)
}
d2FUN <- function(A,d){
a = -2*A[6] - (1/A[4])^2*exp(-(1/A[4])*(d-A[3]))/((1  + exp(-(1/A[4])*(d-A[3]))))^2
return (a)
}
library(ToxicR)
set.seed(893223)
D <- rep(seq(0,1.0,1/4),each=11)
mean <- 2.3  + 2/(1+exp(-(D-0.37)*5))*(1/(1+exp(-(0.75-D)*3)))
Y <- mean + rnorm(length(mean),0,0.025)
system.time({B <-test_skn(as.matrix(Y), as.matrix(D))})
B
pchisq(0.05)
pchisq(1,0.05)
pchisq(1,0.95)
pchisq(0.95,1)
qchisq(0.95,1)
qchisq(0.95,1)/2
FUN <-function(A,doses){
b <- A[1] + A[2]*exp((doses-A[5])^2*(-A[6]))*(1/(1+exp(-(doses-A[3])/A[4])))
return(b)
}
dFUN <- function(A,d){
a = -2*A[6]*(d-A[5]) + (1/A[4])*exp(-(1/A[4])*(d-A[3]))/(1  + exp(-(1/A[4])*(d-A[3])))
return (a)
}
d2FUN <- function(A,d){
a = -2*A[6] - (1/A[4])^2*exp(-(1/A[4])*(d-A[3]))/((1  + exp(-(1/A[4])*(d-A[3]))))^2
return (a)
}
library(ToxicR)
set.seed(893223)
D <- rep(seq(0,1.0,1/4),each=11)
mean <- 2.3  + 2/(1+exp(-(D-0.37)*5))*(1/(1+exp(-(0.75-D)*3)))
Y <- mean + rnorm(length(mean),0,0.025)
system.time({B <-test_skn(as.matrix(Y), as.matrix(D))})
B
system.time({B <-test_skn(as.matrix(Y), as.matrix(D))})
system.time({B <-test_skn(as.matrix(Y), as.matrix(D))})
system.time({B <-test_skn(as.matrix(Y), as.matrix(D))})
system.time({B <-test_skn(as.matrix(Y), as.matrix(D))})
system.time({B <-test_skn(as.matrix(Y), as.matrix(D))})
B
FUN <-function(A,doses){
b <- A[1] + A[2]*exp((doses-A[5])^2*(-A[6]))*(1/(1+exp(-(doses-A[3])/A[4])))
return(b)
}
dFUN <- function(A,d){
a = -2*A[6]*(d-A[5]) + (1/A[4])*exp(-(1/A[4])*(d-A[3]))/(1  + exp(-(1/A[4])*(d-A[3])))
return (a)
}
d2FUN <- function(A,d){
a = -2*A[6] - (1/A[4])^2*exp(-(1/A[4])*(d-A[3]))/((1  + exp(-(1/A[4])*(d-A[3]))))^2
return (a)
}
library(ToxicR)
set.seed(893223)
D <- rep(seq(0,1.0,1/4),each=11)
mean <- 2.3  + 2/(1+exp(-(D-0.37)*5))*(1/(1+exp(-(0.75-D)*3)))
Y <- mean + rnorm(length(mean),0,0.025)
system.time({B <-test_skn(as.matrix(Y), as.matrix(D))})
B
FUN <-function(A,doses){
b <- A[1] + A[2]*exp((doses-A[5])^2*(-A[6]))*(1/(1+exp(-(doses-A[3])/A[4])))
return(b)
}
dFUN <- function(A,d){
a = -2*A[6]*(d-A[5]) + (1/A[4])*exp(-(1/A[4])*(d-A[3]))/(1  + exp(-(1/A[4])*(d-A[3])))
return (a)
}
d2FUN <- function(A,d){
a = -2*A[6] - (1/A[4])^2*exp(-(1/A[4])*(d-A[3]))/((1  + exp(-(1/A[4])*(d-A[3]))))^2
return (a)
}
library(ToxicR)
set.seed(893223)
D <- rep(seq(0,1.0,1/4),each=11)
mean <- 2.3  + 2/(1+exp(-(D-0.37)*5))*(1/(1+exp(-(0.75-D)*3)))
Y <- mean + rnorm(length(mean),0,0.025)
system.time({B <-test_skn(as.matrix(Y), as.matrix(D))})
B
FUN <-function(A,doses){
b <- A[1] + A[2]*exp((doses-A[5])^2*(-A[6]))*(1/(1+exp(-(doses-A[3])/A[4])))
return(b)
}
dFUN <- function(A,d){
a = -2*A[6]*(d-A[5]) + (1/A[4])*exp(-(1/A[4])*(d-A[3]))/(1  + exp(-(1/A[4])*(d-A[3])))
return (a)
}
d2FUN <- function(A,d){
a = -2*A[6] - (1/A[4])^2*exp(-(1/A[4])*(d-A[3]))/((1  + exp(-(1/A[4])*(d-A[3]))))^2
return (a)
}
library(ToxicR)
set.seed(893223)
D <- rep(seq(0,1.0,1/4),each=11)
mean <- 2.3  + 2/(1+exp(-(D-0.37)*5))*(1/(1+exp(-(0.75-D)*3)))
Y <- mean + rnorm(length(mean),0,0.025)
system.time({B <-test_skn(as.matrix(Y), as.matrix(D))})
B
D <- rep(seq(0,1.0,1/4),each=5)
mean <- 2.3  + 2/(1+exp(-(D-0.37)*5))*(1/(1+exp(-(0.75-D)*3)))
Y <- mean + rnorm(length(mean),0,0.025)
system.time({B <-test_skn(as.matrix(Y), as.matrix(D))})
B
Y <- mean + rnorm(length(mean),0,0.05)
system.time({B <-test_skn(as.matrix(Y), as.matrix(D))})
FUN <-function(A,doses){
b <- A[1] + A[2]*exp((doses-A[5])^2*(-A[6]))*(1/(1+exp(-(doses-A[3])/A[4])))
return(b)
}
dFUN <- function(A,d){
a = -2*A[6]*(d-A[5]) + (1/A[4])*exp(-(1/A[4])*(d-A[3]))/(1  + exp(-(1/A[4])*(d-A[3])))
return (a)
}
d2FUN <- function(A,d){
a = -2*A[6] - (1/A[4])^2*exp(-(1/A[4])*(d-A[3]))/((1  + exp(-(1/A[4])*(d-A[3]))))^2
return (a)
}
library(ToxicR)
set.seed(893223)
D <- rep(seq(0,1.0,1/4),each=5)
mean <- 2.3  + 2/(1+exp(-(D-0.37)*5))*(1/(1+exp(-(0.75-D)*3)))
Y <- mean + rnorm(length(mean),0,0.05)
system.time({B <-test_skn(as.matrix(Y), as.matrix(D))})
B
plot(D,Y,pch=16)
FUN <-function(A,doses){
b <- A[1] + A[2]*exp((doses-A[5])^2*(-A[6]))*(1/(1+exp(-(doses-A[3])/A[4])))
return(b)
}
dFUN <- function(A,d){
a = -2*A[6]*(d-A[5]) + (1/A[4])*exp(-(1/A[4])*(d-A[3]))/(1  + exp(-(1/A[4])*(d-A[3])))
return (a)
}
d2FUN <- function(A,d){
a = -2*A[6] - (1/A[4])^2*exp(-(1/A[4])*(d-A[3]))/((1  + exp(-(1/A[4])*(d-A[3]))))^2
return (a)
}
library(ToxicR)
set.seed(893223)
D <- rep(seq(0,1.0,1/4),each=5)
mean <- 2.3  + 2/(1+exp(-(D-0.37)*5))*(1/(1+exp(-(0.75-D)*3)))
Y <- mean + rnorm(length(mean),0,0.05)
system.time({B <-test_skn(as.matrix(Y), as.matrix(D))})
B
FUN <-function(A,doses){
b <- A[1] + A[2]*exp((doses-A[5])^2*(-A[6]))*(1/(1+exp(-(doses-A[3])/A[4])))
return(b)
}
dFUN <- function(A,d){
a = -2*A[6]*(d-A[5]) + (1/A[4])*exp(-(1/A[4])*(d-A[3]))/(1  + exp(-(1/A[4])*(d-A[3])))
return (a)
}
d2FUN <- function(A,d){
a = -2*A[6] - (1/A[4])^2*exp(-(1/A[4])*(d-A[3]))/((1  + exp(-(1/A[4])*(d-A[3]))))^2
return (a)
}
library(ToxicR)
set.seed(893223)
D <- rep(seq(0,1.0,1/4),each=5)
mean <- 2.3  + 2/(1+exp(-(D-0.37)*5))*(1/(1+exp(-(0.75-D)*3)))
Y <- mean + rnorm(length(mean),0,0.05)
system.time({B <-test_skn(as.matrix(Y), as.matrix(D))})
B
FUN <-function(A,doses){
b <- A[1] + A[2]*exp((doses-A[5])^2*(-A[6]))*(1/(1+exp(-(doses-A[3])/A[4])))
return(b)
}
dFUN <- function(A,d){
a = -2*A[6]*(d-A[5]) + (1/A[4])*exp(-(1/A[4])*(d-A[3]))/(1  + exp(-(1/A[4])*(d-A[3])))
return (a)
}
d2FUN <- function(A,d){
a = -2*A[6] - (1/A[4])^2*exp(-(1/A[4])*(d-A[3]))/((1  + exp(-(1/A[4])*(d-A[3]))))^2
return (a)
}
library(ToxicR)
set.seed(893223)
D <- rep(seq(0,1.0,1/4),each=5)
mean <- 2.3  + 2/(1+exp(-(D-0.37)*5))*(1/(1+exp(-(0.75-D)*3)))
Y <- mean + rnorm(length(mean),0,0.05)
system.time({B <-test_skn(as.matrix(Y), as.matrix(D))})
B
FUN <-function(A,doses){
b <- A[1] + A[2]*exp((doses-A[5])^2*(-A[6]))*(1/(1+exp(-(doses-A[3])/A[4])))
return(b)
}
dFUN <- function(A,d){
a = -2*A[6]*(d-A[5]) + (1/A[4])*exp(-(1/A[4])*(d-A[3]))/(1  + exp(-(1/A[4])*(d-A[3])))
return (a)
}
d2FUN <- function(A,d){
a = -2*A[6] - (1/A[4])^2*exp(-(1/A[4])*(d-A[3]))/((1  + exp(-(1/A[4])*(d-A[3]))))^2
return (a)
}
library(ToxicR)
set.seed(893223)
D <- rep(seq(0,1.0,1/4),each=5)
mean <- 2.3  + 2/(1+exp(-(D-0.37)*5))*(1/(1+exp(-(0.75-D)*3)))
Y <- mean + rnorm(length(mean),0,0.05)
system.time({B <-test_skn(as.matrix(Y), as.matrix(D))})
B
plot(D,Y,pch=16)
B
Y <- mean + rnorm(length(mean),0,0.5)
system.time({B <-test_skn(as.matrix(Y), as.matrix(D))})
FUN <-function(A,doses){
b <- A[1] + A[2]*exp((doses-A[5])^2*(-A[6]))*(1/(1+exp(-(doses-A[3])/A[4])))
return(b)
}
dFUN <- function(A,d){
a = -2*A[6]*(d-A[5]) + (1/A[4])*exp(-(1/A[4])*(d-A[3]))/(1  + exp(-(1/A[4])*(d-A[3])))
return (a)
}
d2FUN <- function(A,d){
a = -2*A[6] - (1/A[4])^2*exp(-(1/A[4])*(d-A[3]))/((1  + exp(-(1/A[4])*(d-A[3]))))^2
return (a)
}
library(ToxicR)
set.seed(893223)
D <- rep(seq(0,1.0,1/4),each=5)
mean <- 2.3  + 2/(1+exp(-(D-0.37)*5))*(1/(1+exp(-(0.75-D)*3)))
Y <- mean + rnorm(length(mean),0,0.5)
system.time({B <-test_skn(as.matrix(Y), as.matrix(D))})
B
66.2+72.5+160
288.7* 1.125^20
288.7* 1.145^20
