library(dplyr)
temp <- PFOA_Liver %>% filter(X1 == "SQLE_9935")
v1 <- as.numeric(temp[2:length(temp)])
BB <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "pow", distribution="normal",fit_type = "mle",sstat = F,)
plot(BB)
library(ToxicR)
v1 <- c(13.184152,12.8906975,12.359554,13.073001,12.861814,12.967434,12.88052,
13.249991,	12.992931,	13.022338,	13.614057,	13.287018,	13.449239,	13.950747,
13.239134,	13.82321,	15.080262,	14.85966,	14.7805395,	15.238369,	14.749196,
14.913585,	15.181719,	15.051697,	15.065641,	15.16396,	15.484345,	16.493923,
15.633442,	15.96033,	15.388061)
prior <- create_prior_list(lnormprior(0,1,-100,100),
normprior( 0, 1,-100,100),#normprior(1,2,-18,18),
lnormprior(0 ,1,0,100),
lnormprior(0,1,0,18),
normprior(0,2,-18,18));
library(readr)
PFOA_Liver <- read_table2("~/Documents/PFOA_Liver.txt",
col_names = FALSE)
doses	<- c(0,	0,	0,	0,	0.156,	0.156,	0.156,	0.3125,	0.3125,	0.3125,
0.625,	0.625,	0.625,	1.25,	1.25,	1.25,	2.5,	2.5,	2.5,	5,5,
5,	5,	10,	10,	10,	10,	20,	20,	20,	20)
#B <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "hill", fit_type = "laplace",sstat = F)
#BB <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "hill", distribution="normal",fit_type = "mle",sstat = F,)
library(dplyr)
temp <- PFOA_Liver %>% filter(X1 == "SQLE_9935")
v1 <- as.numeric(temp[2:length(temp)])
BB <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "pow", distribution="normal",fit_type = "mle",sstat = F,)
plot(BB)
temp <- PFOA_Liver %>% filter(X1 == "SQLE_9935")
v1 <- as.numeric(temp[2:length(temp)])
BB <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "power", distribution="normal",fit_type = "mle",sstat = F,)
plot(BB)
temp <- PFOA_Liver %>% filter(X1 == "ACAA2_7955")
v1 <- as.numeric(temp[2:length(temp)])
BB <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "power", distribution="normal",fit_type = "mle",sstat = F,)
plot(BB)
BB$parameters
temp <- PFOA_Liver %>% filter(X1 == "ACADL_32776")
v1 <- as.numeric(temp[2:length(temp)])
BB <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "power", distribution="normal",fit_type = "mle",sstat = F,)
plot(BB)
temp <- PFOA_Liver %>% filter(X1 == "AIF1_32886")
v1 <- as.numeric(temp[2:length(temp)])
BB <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "power", distribution="normal",fit_type = "mle",sstat = F,)
plot(BB)
temp <- PFOA_Liver %>% filter(X1 == "AIF1_32886")
v1 <- as.numeric(temp[2:length(temp)])
BB <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "power", distribution="normal",fit_type = "mle",sstat = F,)
plot(BB)
temp <- PFOA_Liver %>% filter(X1 == "SQLE_9935")
v1 <- as.numeric(temp[2:length(temp)])
BB <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "power", distribution="normal",fit_type = "mle",sstat = F,)
plot(BB)
library(ToxicR)
v1 <- c(13.184152,12.8906975,12.359554,13.073001,12.861814,12.967434,12.88052,
13.249991,	12.992931,	13.022338,	13.614057,	13.287018,	13.449239,	13.950747,
13.239134,	13.82321,	15.080262,	14.85966,	14.7805395,	15.238369,	14.749196,
14.913585,	15.181719,	15.051697,	15.065641,	15.16396,	15.484345,	16.493923,
15.633442,	15.96033,	15.388061)
prior <- create_prior_list(lnormprior(0,1,-100,100),
normprior( 0, 1,-100,100),#normprior(1,2,-18,18),
lnormprior(0 ,1,0,100),
lnormprior(0,1,0,18),
normprior(0,2,-18,18));
library(readr)
PFOA_Liver <- read_table2("~/Documents/PFOA_Liver.txt",
col_names = FALSE)
doses	<- c(0,	0,	0,	0,	0.156,	0.156,	0.156,	0.3125,	0.3125,	0.3125,
0.625,	0.625,	0.625,	1.25,	1.25,	1.25,	2.5,	2.5,	2.5,	5,5,
5,	5,	10,	10,	10,	10,	20,	20,	20,	20)
#B <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "hill", fit_type = "laplace",sstat = F)
#BB <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "hill", distribution="normal",fit_type = "mle",sstat = F,)
library(dplyr)
temp <- PFOA_Liver %>% filter(X1 == "SQLE_9935")
v1 <- as.numeric(temp[2:length(temp)])
BB <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "power", distribution="normal",fit_type = "mle",sstat = F,)
plot(BB)
library(dplyr)
temp <- PFOA_Liver %>% filter(X1 == "SQLE_9935")
v1 <- as.numeric(temp[2:length(temp)])
BB <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "power", distribution="normal",fit_type = "mcmc",sstat = F,)
plot(BB)
BB$mcmc_result
BB$fitted_model$parameters
library(dplyr)
temp <- PFOA_Liver %>% filter(X1 == "SQLE_9935")
v1 <- as.numeric(temp[2:length(temp)])
BB <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "power", distribution="normal",fit_type = "mcmc",sstat = F,)
plot(BB)
library(dplyr)
temp <- PFOA_Liver %>% filter(X1 == "SQLE_9935")
v1 <- as.numeric(temp[2:length(temp)])
BB <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "hill", distribution="normal",fit_type = "mcmc",sstat = F,)
plot(BB)
library(ToxicR)
v1 <- c(13.184152,12.8906975,12.359554,13.073001,12.861814,12.967434,12.88052,
13.249991,	12.992931,	13.022338,	13.614057,	13.287018,	13.449239,	13.950747,
13.239134,	13.82321,	15.080262,	14.85966,	14.7805395,	15.238369,	14.749196,
14.913585,	15.181719,	15.051697,	15.065641,	15.16396,	15.484345,	16.493923,
15.633442,	15.96033,	15.388061)
prior <- create_prior_list(lnormprior(0,1,-100,100),
normprior( 0, 1,-100,100),#normprior(1,2,-18,18),
lnormprior(0 ,1,0,100),
lnormprior(0,1,0,18),
normprior(0,2,-18,18));
library(readr)
PFOA_Liver <- read_table2("~/Documents/PFOA_Liver.txt",
col_names = FALSE)
doses	<- c(0,	0,	0,	0,	0.156,	0.156,	0.156,	0.3125,	0.3125,	0.3125,
0.625,	0.625,	0.625,	1.25,	1.25,	1.25,	2.5,	2.5,	2.5,	5,5,
5,	5,	10,	10,	10,	10,	20,	20,	20,	20)
#B <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "hill", fit_type = "laplace",sstat = F)
#BB <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "hill", distribution="normal",fit_type = "mle",sstat = F,)
library(dplyr)
temp <- PFOA_Liver %>% filter(X1 == "SQLE_9935")
v1 <- as.numeric(temp[2:length(temp)])
BB <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "power", distribution="normal",fit_type = "mle",sstat = F,)
plot(BB)
temp <- PFOA_Liver %>% filter(X1 == "SQLE_9935")
v1 <- as.numeric(temp[2:length(temp)])
BB <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "power", distribution="normal",fit_type = "mcmc",sstat = F,)
plot(BB)
temp <- PFOA_Liver %>% filter(X1 == "ACAA2_7955")
v1 <- as.numeric(temp[2:length(temp)])
BB <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "power", distribution="normal",fit_type = "mle",sstat = F,)
plot(BB)
temp <- PFOA_Liver %>% filter(X1 == "ACAA2_7955")
v1 <- as.numeric(temp[2:length(temp)])
BB <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "power", distribution="normal",fit_type = "mcmc",sstat = F,)
plot(BB)
temp <- PFOA_Liver %>% filter(X1 == "ACADL_32776")
v1 <- as.numeric(temp[2:length(temp)])
BB <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "power", distribution="normal",fit_type = "mle",sstat = F,)
plot(BB)
temp <- PFOA_Liver %>% filter(X1 == "ACADL_32776")
v1 <- as.numeric(temp[2:length(temp)])
BB <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "power", distribution="normal",fit_type = "mcmc",sstat = F,)
plot(BB)
temp <- PFOA_Liver %>% filter(X1 == "LOC100912409_9106")
v1 <- as.numeric(temp[2:length(temp)])
BB <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "power", distribution="normal",fit_type = "mle",sstat = F,)
plot(BB)
temp <- PFOA_Liver %>% filter(X1 == "LOC100912409_9106")
v1 <- as.numeric(temp[2:length(temp)])
BB <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "power", distribution="normal",fit_type = "mcmc",sstat = F,)
plot(BB)
temp <- PFOA_Liver %>% filter(X1 == "SQLE_9935")
v1 <- as.numeric(temp[2:length(temp)])
BB <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "power", distribution="normal",fit_type = "mcmc",sstat = F,)
plot(BB)
library(ToxicR)
v1 <- c(13.184152,12.8906975,12.359554,13.073001,12.861814,12.967434,12.88052,
13.249991,	12.992931,	13.022338,	13.614057,	13.287018,	13.449239,	13.950747,
13.239134,	13.82321,	15.080262,	14.85966,	14.7805395,	15.238369,	14.749196,
14.913585,	15.181719,	15.051697,	15.065641,	15.16396,	15.484345,	16.493923,
15.633442,	15.96033,	15.388061)
prior <- create_prior_list(lnormprior(0,1,-100,100),
normprior( 0, 1,-100,100),#normprior(1,2,-18,18),
lnormprior(0 ,1,0,100),
lnormprior(0,1,0,18),
normprior(0,2,-18,18));
library(readr)
PFOA_Liver <- read_table2("~/Documents/PFOA_Liver.txt",
col_names = FALSE)
doses	<- c(0,	0,	0,	0,	0.156,	0.156,	0.156,	0.3125,	0.3125,	0.3125,
0.625,	0.625,	0.625,	1.25,	1.25,	1.25,	2.5,	2.5,	2.5,	5,5,
5,	5,	10,	10,	10,	10,	20,	20,	20,	20)
#B <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "hill", fit_type = "laplace",sstat = F)
#BB <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "hill", distribution="normal",fit_type = "mle",sstat = F,)
library(dplyr)
AA <- ma_continuous_fit(as.matrix(doses),as.matrix(v1),fit_type = "laplace")
plot(AA)
AA <- ma_continuous_fit(as.matrix(doses),as.matrix(v1),fit_type = "mcmc")
plot(AA)
temp <- PFOA_Liver %>% filter(X1 == "SQLE_9935")
v1 <- as.numeric(temp[2:length(temp)])
BB <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "power", distribution="normal",fit_type = "mcmc",sstat = F,)
AA <- ma_continuous_fit(as.matrix(doses),as.matrix(v1),fit_type = "mcmc")
plot(BB)
plot(AA)
AA <- ma_continuous_fit(as.matrix(doses),as.matrix(v1),fit_type = "laplace")
plot(BB)
plot(AA)
temp <- PFOA_Liver %>% filter(X1 == "ACAA2_7955")
v1 <- as.numeric(temp[2:length(temp)])
BB <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "power", distribution="normal",fit_type = "mle",sstat = F,)
plot(BB)
temp <- PFOA_Liver %>% filter(X1 == "ACADL_32776")
v1 <- as.numeric(temp[2:length(temp)])
BB <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "hill", distribution="normal",fit_type = "mcmc",sstat = F,)
plot(BB)
temp <- PFOA_Liver %>% filter(X1 == "ACADL_32776")
v1 <- as.numeric(temp[2:length(temp)])
BB <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "hill", distribution="normal",fit_type = "mle",sstat = F,)
plot(BB)
temp <- PFOA_Liver %>% filter(X1 == "LOC100912409_9106")
v1 <- as.numeric(temp[2:length(temp)])
BB <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "power", distribution="normal",fit_type = "mle",sstat = F,)
plot(BB)
temp <- PFOA_Liver %>% filter(X1 == "LOC100912409_9106")
v1 <- as.numeric(temp[2:length(temp)])
BB <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "hill", distribution="normal",fit_type = "mle",sstat = F,)
plot(BB)
temp <- PFOA_Liver %>% filter(X1 == "AIF1_32886")
v1 <- as.numeric(temp[2:length(temp)])
BB <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "hill", distribution="normal",fit_type = "mle",sstat = F,)
plot(BB)
temp <- PFOA_Liver %>% filter(X1 == "AIF1_32886")
v1 <- as.numeric(temp[2:length(temp)])
BB <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "hill", distribution="normal",fit_type = "mle",sstat = F,)
plot(BB)
temp <- PFOA_Liver %>% filter(X1 == "AIF1_32886")
v1 <- as.numeric(temp[2:length(temp)])
BB <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "hill", distribution="normal",fit_type = "mle",sstat = F,)
plot(BB)
temp <- PFOA_Liver %>% filter(X1 == "ACAA2_7955")
v1 <- as.numeric(temp[2:length(temp)])
BB <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "power", distribution="normal",fit_type = "mle",sstat = F,)
plot(BB)
v1 <- as.numeric(temp[2:length(temp)])
BB <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "hill", distribution="normal",fit_type = "mle",sstat = F,)
plot(BB)
temp <- PFOA_Liver %>% filter(X1 == "ACAA2_7955")
v1 <- as.numeric(temp[2:length(temp)])
BB <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "hill", distribution="lognormal",fit_type = "mle",sstat = F,)
plot(BB)
library(ToxicR)
v1 <- c(13.184152,12.8906975,12.359554,13.073001,12.861814,12.967434,12.88052,
13.249991,	12.992931,	13.022338,	13.614057,	13.287018,	13.449239,	13.950747,
13.239134,	13.82321,	15.080262,	14.85966,	14.7805395,	15.238369,	14.749196,
14.913585,	15.181719,	15.051697,	15.065641,	15.16396,	15.484345,	16.493923,
15.633442,	15.96033,	15.388061)
prior <- create_prior_list(lnormprior(0,1,-100,100),
normprior( 0, 1,-100,100),#normprior(1,2,-18,18),
lnormprior(0 ,1,0,100),
lnormprior(0,1,0,18),
normprior(0,2,-18,18));
library(readr)
PFOA_Liver <- read_table2("~/Documents/PFOA_Liver.txt",
col_names = FALSE)
doses	<- c(0,	0,	0,	0,	0.156,	0.156,	0.156,	0.3125,	0.3125,	0.3125,
0.625,	0.625,	0.625,	1.25,	1.25,	1.25,	2.5,	2.5,	2.5,	5,5,
5,	5,	10,	10,	10,	10,	20,	20,	20,	20)
#B <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "hill", fit_type = "laplace",sstat = F)
#BB <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "hill", distribution="normal",fit_type = "mle",sstat = F,)
library(dplyr)
temp <- PFOA_Liver %>% filter(X1 == "SQLE_9935")
v1 <- as.numeric(temp[2:length(temp)])
BB <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "power", distribution="normal",fit_type = "mcmc",sstat = F,)
AA <- ma_continuous_fit(as.matrix(doses),as.matrix(v1),fit_type = "laplace")
plot(BB)
temp <- PFOA_Liver %>% filter(X1 == "ACAA2_7955")
v1 <- as.numeric(temp[2:length(temp)])
BB <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "hill", distribution="lognormal",fit_type = "mle",sstat = F,)
plot(BB)
temp <- PFOA_Liver %>% filter(X1 == "ACAA2_7955")
v1 <- as.numeric(temp[2:length(temp)])
BB <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "hill", distribution="normal",fit_type = "mle",sstat = F,)
plot(BB)
library(ToxicR)
v1 <- c(13.184152,12.8906975,12.359554,13.073001,12.861814,12.967434,12.88052,
13.249991,	12.992931,	13.022338,	13.614057,	13.287018,	13.449239,	13.950747,
13.239134,	13.82321,	15.080262,	14.85966,	14.7805395,	15.238369,	14.749196,
14.913585,	15.181719,	15.051697,	15.065641,	15.16396,	15.484345,	16.493923,
15.633442,	15.96033,	15.388061)
prior <- create_prior_list(lnormprior(0,1,-100,100),
normprior( 0, 1,-100,100),#normprior(1,2,-18,18),
lnormprior(0 ,1,0,100),
lnormprior(0,1,0,18),
normprior(0,2,-18,18));
library(readr)
PFOA_Liver <- read_table2("~/Documents/PFOA_Liver.txt",
col_names = FALSE)
doses	<- c(0,	0,	0,	0,	0.156,	0.156,	0.156,	0.3125,	0.3125,	0.3125,
0.625,	0.625,	0.625,	1.25,	1.25,	1.25,	2.5,	2.5,	2.5,	5,5,
5,	5,	10,	10,	10,	10,	20,	20,	20,	20)
#B <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "hill", fit_type = "laplace",sstat = F)
#BB <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "hill", distribution="normal",fit_type = "mle",sstat = F,)
library(dplyr)
temp <- PFOA_Liver %>% filter(X1 == "ACAA2_7955")
v1 <- as.numeric(temp[2:length(temp)])
BB <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "hill", distribution="normal",fit_type = "mle",sstat = F,)
plot(BB)
library(ToxicR)
v1 <- c(13.184152,12.8906975,12.359554,13.073001,12.861814,12.967434,12.88052,
13.249991,	12.992931,	13.022338,	13.614057,	13.287018,	13.449239,	13.950747,
13.239134,	13.82321,	15.080262,	14.85966,	14.7805395,	15.238369,	14.749196,
14.913585,	15.181719,	15.051697,	15.065641,	15.16396,	15.484345,	16.493923,
15.633442,	15.96033,	15.388061)
prior <- create_prior_list(lnormprior(0,1,-100,100),
normprior( 0, 1,-100,100),#normprior(1,2,-18,18),
lnormprior(0 ,1,0,100),
lnormprior(0,1,0,18),
normprior(0,2,-18,18));
library(readr)
PFOA_Liver <- read_table2("~/Documents/PFOA_Liver.txt",
col_names = FALSE)
doses	<- c(0,	0,	0,	0,	0.156,	0.156,	0.156,	0.3125,	0.3125,	0.3125,
0.625,	0.625,	0.625,	1.25,	1.25,	1.25,	2.5,	2.5,	2.5,	5,5,
5,	5,	10,	10,	10,	10,	20,	20,	20,	20)
#B <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "hill", fit_type = "laplace",sstat = F)
#BB <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "hill", distribution="normal",fit_type = "mle",sstat = F,)
library(dplyr)
temp <- PFOA_Liver %>% filter(X1 == "SQLE_9935")
v1 <- as.numeric(temp[2:length(temp)])
BB <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "power", distribution="normal",fit_type = "mcmc",sstat = F,)
AA <- ma_continuous_fit(as.matrix(doses),as.matrix(v1),fit_type = "laplace")
plot(BB)
temp <- PFOA_Liver %>% filter(X1 == "ACAA2_7955")
v1 <- as.numeric(temp[2:length(temp)])
BB <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "hill", distribution="normal",fit_type = "mle",sstat = F,)
plot(BB)
temp <- PFOA_Liver %>% filter(X1 == "ACAA2_7955")
v1 <- as.numeric(temp[2:length(temp)])
BB <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "exp-5", distribution="normal",fit_type = "mle",sstat = F,)
plot(BB)
temp <- PFOA_Liver %>% filter(X1 == "ACAA2_7955")
v1 <- as.numeric(temp[2:length(temp)])
BB <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "exp-3", distribution="normal",fit_type = "mle",sstat = F,)
plot(BB)
1.5/0.75
1.75/0.75
192+150+60
192+150+65
192+150+65+20
library(ToxicR)
v1 <- c(13.184152,12.8906975,12.359554,13.073001,12.861814,12.967434,12.88052,
13.249991,	12.992931,	13.022338,	13.614057,	13.287018,	13.449239,	13.950747,
13.239134,	13.82321,	15.080262,	14.85966,	14.7805395,	15.238369,	14.749196,
14.913585,	15.181719,	15.051697,	15.065641,	15.16396,	15.484345,	16.493923,
15.633442,	15.96033,	15.388061)
prior <- create_prior_list(lnormprior(0,1,-100,100),
normprior( 0, 1,-100,100),#normprior(1,2,-18,18),
lnormprior(0 ,1,0,100),
lnormprior(0,1,0,18),
normprior(0,2,-18,18));
library(readr)
PFOA_Liver <- read_table2("~/Documents/PFOA_Liver.txt",
col_names = FALSE)
doses	<- c(0,	0,	0,	0,	0.156,	0.156,	0.156,	0.3125,	0.3125,	0.3125,
0.625,	0.625,	0.625,	1.25,	1.25,	1.25,	2.5,	2.5,	2.5,	5,5,
5,	5,	10,	10,	10,	10,	20,	20,	20,	20)
#B <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "hill", fit_type = "laplace",sstat = F)
#BB <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "hill", distribution="normal",fit_type = "mle",sstat = F,)
library(dplyr)
temp <- PFOA_Liver %>% filter(X1 == "SQLE_9935")
v1 <- as.numeric(temp[2:length(temp)])
BB <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "power", distribution="normal",fit_type = "mcmc",sstat = F,)
AA <- ma_continuous_fit(as.matrix(doses),as.matrix(v1),fit_type = "laplace")
plot(BB)
plot(AA)
cleveland_plot(AA)
AA <- ma_continuous_fit(as.matrix(doses),as.matrix(v1),fit_type = "mcmc")
plot(AA)
cleveland_plot(AA)
setwd("~/Documents/r_software/RBMDS/ToxicR/R")
model_list = data.frame(model_list = c(rep("hill",3),rep("exp-3",3),rep("exp-5",3),rep("power",2)),
distribution_list =  c(rep(c("normal","normal-ncv","lognormal"),3),"normal",
"normal-ncv","normal","normal-ncv"))
model_list = data.frame(model_list = c(rep("hill",3),rep("exp-3",3),rep("exp-5",3),rep("power",2)),
distribution_list =  c(rep(c("normal","normal-ncv","lognormal"),3),"normal",
"normal-ncv"))
library(ToxicR)
v1 <- c(13.184152,12.8906975,12.359554,13.073001,12.861814,12.967434,12.88052,
13.249991,	12.992931,	13.022338,	13.614057,	13.287018,	13.449239,	13.950747,
13.239134,	13.82321,	15.080262,	14.85966,	14.7805395,	15.238369,	14.749196,
14.913585,	15.181719,	15.051697,	15.065641,	15.16396,	15.484345,	16.493923,
15.633442,	15.96033,	15.388061)
prior <- create_prior_list(lnormprior(0,1,-100,100),
normprior( 0, 1,-100,100),#normprior(1,2,-18,18),
lnormprior(0 ,1,0,100),
lnormprior(0,1,0,18),
normprior(0,2,-18,18));
library(readr)
PFOA_Liver <- read_table2("~/Documents/PFOA_Liver.txt",
col_names = FALSE)
doses	<- c(0,	0,	0,	0,	0.156,	0.156,	0.156,	0.3125,	0.3125,	0.3125,
0.625,	0.625,	0.625,	1.25,	1.25,	1.25,	2.5,	2.5,	2.5,	5,5,
5,	5,	10,	10,	10,	10,	20,	20,	20,	20)
AA <- ma_continuous_fit(as.matrix(doses),as.matrix(v1),model_list=model_list,
fit_type = "mcmc")
CC <- ma_continuous_fit(as.matrix(doses),as.matrix(v1),model_list=model_list,
fit_type = "laplace")
model_list = data.frame(model_list = c(rep("hill",3),rep("exp-3",3),rep("exp-5",3),rep("power",2)),
distribution_list =  c(rep(c("normal","normal-ncv","lognormal"),3),"normal",
"normal-ncv"))
AA <- ma_continuous_fit(as.matrix(doses),as.matrix(v1),model_list=model_list,
fit_type = "mcmc")
CC <- ma_continuous_fit(as.matrix(doses),as.matrix(v1),model_list=model_list,
fit_type = "laplace")
model_list = data.frame(model_list = c(rep("hill",3),rep("exp-3",3),rep("exp-5",3),rep("power",2)),
distribution_list =  c(rep(c("normal","normal-ncv","lognormal"),3),"normal",
"normal-ncv"))
library(ToxicR)
v1 <- c(13.184152,12.8906975,12.359554,13.073001,12.861814,12.967434,12.88052,
13.249991,	12.992931,	13.022338,	13.614057,	13.287018,	13.449239,	13.950747,
13.239134,	13.82321,	15.080262,	14.85966,	14.7805395,	15.238369,	14.749196,
14.913585,	15.181719,	15.051697,	15.065641,	15.16396,	15.484345,	16.493923,
15.633442,	15.96033,	15.388061)
prior <- create_prior_list(lnormprior(0,1,-100,100),
normprior( 0, 1,-100,100),#normprior(1,2,-18,18),
lnormprior(0 ,1,0,100),
lnormprior(0,1,0,18),
normprior(0,2,-18,18));
doses	<- c(0,	0,	0,	0,	0.156,	0.156,	0.156,	0.3125,	0.3125,	0.3125,
0.625,	0.625,	0.625,	1.25,	1.25,	1.25,	2.5,	2.5,	2.5,	5,5,
5,	5,	10,	10,	10,	10,	20,	20,	20,	20)
AA <- ma_continuous_fit(as.matrix(doses),as.matrix(v1),model_list=model_list,
fit_type = "mcmc")
CC <- ma_continuous_fit(as.matrix(doses),as.matrix(v1),model_list=model_list,
fit_type = "laplace")
model_list$model_list
model_list$distribution_list
model_list = data.frame(model_list = c(rep("hill",3),rep("exp-3",3),rep("exp-5",3),rep("power",2)),
distribution_list =  c(rep(c("normal","normal-ncv","lognormal"),3),"normal",
"normal-ncv"))
library(ToxicR)
v1 <- c(13.184152,12.8906975,12.359554,13.073001,12.861814,12.967434,12.88052,
13.249991,	12.992931,	13.022338,	13.614057,	13.287018,	13.449239,	13.950747,
13.239134,	13.82321,	15.080262,	14.85966,	14.7805395,	15.238369,	14.749196,
14.913585,	15.181719,	15.051697,	15.065641,	15.16396,	15.484345,	16.493923,
15.633442,	15.96033,	15.388061)
prior <- create_prior_list(lnormprior(0,1,-100,100),
normprior( 0, 1,-100,100),#normprior(1,2,-18,18),
lnormprior(0 ,1,0,100),
lnormprior(0,1,0,18),
normprior(0,2,-18,18));
doses	<- c(0,	0,	0,	0,	0.156,	0.156,	0.156,	0.3125,	0.3125,	0.3125,
0.625,	0.625,	0.625,	1.25,	1.25,	1.25,	2.5,	2.5,	2.5,	5,5,
5,	5,	10,	10,	10,	10,	20,	20,	20,	20)
AA <- ma_continuous_fit(as.matrix(doses),as.matrix(v1),model_list=model_list,
fit_type = "mcmc")
CC <- ma_continuous_fit(as.matrix(doses),as.matrix(v1),model_list=model_list,
fit_type = "laplace")
model_list = data.frame(model_list = c(rep("hill",3),rep("exp-3",3),rep("exp-5",3),rep("power",2)),
distribution_list =  c(rep(c("normal","normal-ncv","lognormal"),3),"normal",
"normal-ncv"))
AA <- ma_continuous_fit(as.matrix(doses),as.matrix(v1),model_list=model_list,
fit_type = "mcmc")
CC <- ma_continuous_fit(as.matrix(doses),as.matrix(v1),model_list=model_list,
fit_type = "laplace")
model_list = data.frame(model_list = c(rep("hill",3),rep("exp-3",3),rep("exp-5",3),rep("power",2)),
distribution_list =  c(rep(c("normal","normal-ncv","lognormal"),3),"normal",
"normal-ncv"))
library(ToxicR)
v1 <- c(13.184152,12.8906975,12.359554,13.073001,12.861814,12.967434,12.88052,
13.249991,	12.992931,	13.022338,	13.614057,	13.287018,	13.449239,	13.950747,
13.239134,	13.82321,	15.080262,	14.85966,	14.7805395,	15.238369,	14.749196,
14.913585,	15.181719,	15.051697,	15.065641,	15.16396,	15.484345,	16.493923,
15.633442,	15.96033,	15.388061)
prior <- create_prior_list(lnormprior(0,1,-100,100),
normprior( 0, 1,-100,100),#normprior(1,2,-18,18),
lnormprior(0 ,1,0,100),
lnormprior(0,1,0,18),
normprior(0,2,-18,18));
doses	<- c(0,	0,	0,	0,	0.156,	0.156,	0.156,	0.3125,	0.3125,	0.3125,
0.625,	0.625,	0.625,	1.25,	1.25,	1.25,	2.5,	2.5,	2.5,	5,5,
5,	5,	10,	10,	10,	10,	20,	20,	20,	20)
AA <- ma_continuous_fit(as.matrix(doses),as.matrix(v1),model_list=model_list,
fit_type = "mcmc")
CC <- ma_continuous_fit(as.matrix(doses),as.matrix(v1),model_list=model_list,
fit_type = "laplace")
AA <- ma_continuous_fit(as.matrix(doses),as.matrix(v1),model_list=model_list,
fit_type = "mcmc")
CC <- ma_continuous_fit(as.matrix(doses),as.matrix(v1),model_list=model_list,
fit_type = "laplace")
model_list = data.frame(model_list = c(rep("hill",3),rep("exp-3",3),rep("exp-5",3),rep("power",2)),
distribution_list =  c(rep(c("normal","normal-ncv","lognormal"),3),"normal",
"normal-ncv"))
library(ToxicR)
v1 <- c(13.184152,12.8906975,12.359554,13.073001,12.861814,12.967434,12.88052,
13.249991,	12.992931,	13.022338,	13.614057,	13.287018,	13.449239,	13.950747,
13.239134,	13.82321,	15.080262,	14.85966,	14.7805395,	15.238369,	14.749196,
14.913585,	15.181719,	15.051697,	15.065641,	15.16396,	15.484345,	16.493923,
15.633442,	15.96033,	15.388061)
prior <- create_prior_list(lnormprior(0,1,-100,100),
normprior( 0, 1,-100,100),#normprior(1,2,-18,18),
lnormprior(0 ,1,0,100),
lnormprior(0,1,0,18),
normprior(0,2,-18,18));
doses	<- c(0,	0,	0,	0,	0.156,	0.156,	0.156,	0.3125,	0.3125,	0.3125,
0.625,	0.625,	0.625,	1.25,	1.25,	1.25,	2.5,	2.5,	2.5,	5,5,
5,	5,	10,	10,	10,	10,	20,	20,	20,	20)
AA <- ma_continuous_fit(as.matrix(doses),as.matrix(v1),model_list=model_list,
fit_type = "mcmc")
plot(AA)
CC <- ma_continuous_fit(as.matrix(doses),as.matrix(v1),model_list=model_list,
fit_type = "laplace")
model_list = data.frame(model_list = c(rep("hill",3),rep("exp-3",3),rep("exp-5",3),rep("power",2)),
distribution_list =  c(rep(c("normal","normal-ncv","lognormal"),3),"normal",
"normal-ncv"))
library(ToxicR)
v1 <- c(13.184152,12.8906975,12.359554,13.073001,12.861814,12.967434,12.88052,
13.249991,	12.992931,	13.022338,	13.614057,	13.287018,	13.449239,	13.950747,
13.239134,	13.82321,	15.080262,	14.85966,	14.7805395,	15.238369,	14.749196,
14.913585,	15.181719,	15.051697,	15.065641,	15.16396,	15.484345,	16.493923,
15.633442,	15.96033,	15.388061)
prior <- create_prior_list(lnormprior(0,1,-100,100),
normprior( 0, 1,-100,100),#normprior(1,2,-18,18),
lnormprior(0 ,1,0,100),
lnormprior(0,1,0,18),
normprior(0,2,-18,18));
doses	<- c(0,	0,	0,	0,	0.156,	0.156,	0.156,	0.3125,	0.3125,	0.3125,
0.625,	0.625,	0.625,	1.25,	1.25,	1.25,	2.5,	2.5,	2.5,	5,5,
5,	5,	10,	10,	10,	10,	20,	20,	20,	20)
AA <- ma_continuous_fit(as.matrix(doses),as.matrix(v1),model_list=model_list,
fit_type = "mcmc")
CC <- ma_continuous_fit(as.matrix(doses),as.matrix(v1),model_list=model_list,
fit_type = "laplace")
CC$bmd
AA$bmd
