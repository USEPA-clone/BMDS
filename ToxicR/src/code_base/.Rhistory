setwd("~/Documents/r_software/RBMDS/ToxicR/src/code_base")
library(ToxicR)
name_i <- "CAR5A_32361"
# index <- which(genes==name_i)
# data_i <- responses[index,]
sd0 <- 0.2974572
data_i <- c( 5.456381, 4.731022, 5.635566 ,5.541646 ,5.449247, 5.860161 ,5.685841 ,5.509405,
5.476675, 5.482365, 5.811073 ,5.210282, 5.668813, 4.608400, 5.252754 ,5.731935,
4.753121, 4.666748 ,5.815585, 5.103474 ,4.932729, 3.975435 ,3.856961 ,5.085413,
5.164002, 5.444334 ,5.131910 ,2.610040, 3.821137, 3.342455, 3.850739)
doses <- c(0.0000,  0.0000,  0.0000 , 0.0000 , 0.1560,  0.1560 , 0.1560,  0.3125,  0.3125,
0.3125,  0.6250 , 0.6250 , 0.6250  ,1.2500 , 1.2500 , 1.2500  ,2.5000 , 2.5000,
2.5000,  5.0000 , 5.0000 , 5.0000 , 5.0000 ,10.0000 ,10.0000 ,10.0000, 10.0000,
20.0000, 20.0000, 20.0000 ,20.0000)
fit_mle <- single_continuous_fit(
D=as.matrix(doses),Y=as.matrix(data_i),
BMR=3*sd0,BMD_TYPE='abs',
model_type = "hill", distribution="normal",
fit_type = 'mle',sstat = F)
fit_mle$bmd
library(ToxicR)
name_i <- "CAR5A_32361"
# index <- which(genes==name_i)
# data_i <- responses[index,]
sd0 <- 0.2974572
data_i <- c( 5.456381, 4.731022, 5.635566 ,5.541646 ,5.449247, 5.860161 ,5.685841 ,5.509405,
5.476675, 5.482365, 5.811073 ,5.210282, 5.668813, 4.608400, 5.252754 ,5.731935,
4.753121, 4.666748 ,5.815585, 5.103474 ,4.932729, 3.975435 ,3.856961 ,5.085413,
5.164002, 5.444334 ,5.131910 ,2.610040, 3.821137, 3.342455, 3.850739)
doses <- c(0.0000,  0.0000,  0.0000 , 0.0000 , 0.1560,  0.1560 , 0.1560,  0.3125,  0.3125,
0.3125,  0.6250 , 0.6250 , 0.6250  ,1.2500 , 1.2500 , 1.2500  ,2.5000 , 2.5000,
2.5000,  5.0000 , 5.0000 , 5.0000 , 5.0000 ,10.0000 ,10.0000 ,10.0000, 10.0000,
20.0000, 20.0000, 20.0000 ,20.0000)
fit_mle <- single_continuous_fit(
D=as.matrix(doses),Y=as.matrix(data_i),
BMR=3*sd0,BMD_TYPE='abs',
model_type = "hill", distribution="normal",
fit_type = 'mle',sstat = F)
fit_mle$bmd
fit_laplace <- single_continuous_fit(
D=as.matrix(doses),Y=as.matrix(data_i),
BMR=3*sd0,BMD_TYPE='abs',
model_type = "hill", distribution="normal",
fit_type = 'laplace',sstat = F)
fit_laplace$bmd
