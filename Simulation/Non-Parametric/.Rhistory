lines(pred.dates,pred.Y)
}
lines(index(v.da),log(v.da),col=2)
####################################################+3333
NASDAQ <-getSymbols("^IXIC", from = as.Date("1970-01-01"), to = as.Date("2020-09-08"), auto.assign = FALSE)
v.da <- NASDAQ$IXIC.Close
X<-as.Date(index(v.da))
pred.dates <- seq(min(X),max(X),(max(X)-min(X))/2)
fitLM <- function(a){
V <-sample(v.da,40)
K = coefficients(lm(log(V)~index(V)))
return(K)
}
s <- 1:2000
D = q <- mapply(fitLM,s)
plot(index(v.da),log(v.da),col=2,type='l',xlim = c((18499-700),18499),ylim=c(7.0,9.5))
for (i in 1:200){
pred.Y <- D[1,i] +  D[2,i]*as.numeric(pred.dates)
pred <- xts(x = pred.Y, order.by = pred.dates)
lines(pred.dates,pred.Y)
}
rowMeans(D)
lines(index(v.da),log(v.da),col=2)
x = c((18499-700):18499)
lines(x,4.22264+0.00026293*x,col=3,lwd=3)
####
fitLM <- function(a){
V <-sample(v.da,40)
K = coefficients(lm(log(V)~index(V)))
return(K)
}
s <- 1:2000
D = q <- mapply(fitLM,s)
plot(index(v.da),log(v.da),col=2,type='l')#,xlim = c((18499-700),18499),ylim=c(7.0,9.5))
for (i in 1:200){
pred.Y <- D[1,i] +  D[2,i]*as.numeric(pred.dates)
pred <- xts(x = pred.Y, order.by = pred.dates)
lines(pred.dates,pred.Y)
}
####################################################3333
SNP <-getSymbols("^GSPC", from = as.Date("1960-01-01"), to = as.Date("2020-12-04"), auto.assign = FALSE)
v.da <- SNP$GSPC.Close
X<-as.Date(index(v.da))
pred.dates <- seq(min(X),max(X),(max(X)-min(X))/2)
fitLM <- function(a){
V <-sample(v.da,50)
K = coefficients(lm(log(V)~index(V)))
return(K)
}
s <- 1:2000
D = q <- mapply(fitLM,s)
plot(index(v.da),log(v.da),col=2,type='l')
for (i in 1:2000){
pred.Y <- D[1,i] +  D[2,i]*as.numeric(pred.dates)
pred <- xts(x = pred.Y, order.by = pred.dates)
lines(pred.dates,pred.Y)
}
lines(index(v.da),log(v.da),col=2)
RUS  <-getSymbols("^RUT", from = as.Date("1960-01-01"), to = as.Date("2020-12-04"), auto.assign = FALSE)
View(RUS)
v.da <- RUT$NEAR.Close
X<-as.Date(index(v.da))
pred.dates <- seq(min(X),max(X),(max(X)-min(X))/2)
fitLM <- function(a){
V <-sample(v.da,50)
K = coefficients(lm(log(V)~index(V)))
return(K)
}
s <- 1:2000
D = q <- mapply(fitLM,s)
plot(index(v.da),log(v.da),col=2,type='l')
for (i in 1:2000){
pred.Y <- D[1,i] +  D[2,i]*as.numeric(pred.dates)
pred <- xts(x = pred.Y, order.by = pred.dates)
lines(pred.dates,pred.Y)
}
RUS  <-getSymbols("^RUT", from = as.Date("1960-01-01"), to = as.Date("2020-12-04"), auto.assign = FALSE)
v.da <- RUS$NEAR.Close
X<-as.Date(index(v.da))
pred.dates <- seq(min(X),max(X),(max(X)-min(X))/2)
fitLM <- function(a){
V <-sample(v.da,50)
K = coefficients(lm(log(V)~index(V)))
return(K)
}
s <- 1:2000
D = q <- mapply(fitLM,s)
plot(index(v.da),log(v.da),col=2,type='l')
for (i in 1:2000){
pred.Y <- D[1,i] +  D[2,i]*as.numeric(pred.dates)
pred <- xts(x = pred.Y, order.by = pred.dates)
lines(pred.dates,pred.Y)
}
lines(index(v.da),log(v.da),col=2)
RUS  <-getSymbols("^RUT", from = as.Date("1960-01-01"), to = as.Date("2020-12-04"), auto.assign = FALSE)
v.da <- RUS$RUT.Close
X<-as.Date(index(v.da))
pred.dates <- seq(min(X),max(X),(max(X)-min(X))/2)
fitLM <- function(a){
V <-sample(v.da,50)
K = coefficients(lm(log(V)~index(V)))
return(K)
}
s <- 1:2000
D = q <- mapply(fitLM,s)
plot(index(v.da),log(v.da),col=2,type='l')
for (i in 1:2000){
pred.Y <- D[1,i] +  D[2,i]*as.numeric(pred.dates)
pred <- xts(x = pred.Y, order.by = pred.dates)
lines(pred.dates,pred.Y)
}
lines(index(v.da),log(v.da),col=2)
library(quantmod)
NASDAQ <-getSymbols("^IXIC", from = as.Date("1960-01-01"), to =as.Date("2020-12-04"), auto.assign = FALSE)
v.da <- b$IXIC.Close
DOW <- getSymbols("^DJI", from = as.Date("1950-01-01"), to = as.Date("2020-12-04"), auto.assign = FALSE)
DOW.dab <- DOW$DJI.Close
X <- index(DOW.dab)
pred.dates <- seq(min(X),max(X),(max(X)-min(X))/2)
fitLM <- function(a){
V <-sample(DOW.dab,50)
K = coefficients(lm(log(V)~index(V)))
return(K)
}
s <- 1:2000
D = q <- mapply(fitLM,s)
plot(index(DOW.dab),log(DOW.dab),col=2,type='l')
for (i in 1:2000){
pred.Y <- D[1,i] +  D[2,i]*as.numeric(pred.dates)
pred <- xts(x = pred.Y, order.by = pred.dates)
lines(pred.dates,pred.Y)
}
lines(index(DOW.dab),log(DOW.dab),col=2)
m <- rowMeans(D)
library(quantmod)
NASDAQ <-getSymbols("^IXIC", from = as.Date("1960-01-01"), to =as.Date("2020-12-04"), auto.assign = FALSE)
v.da <- b$IXIC.Close
DOW <- getSymbols("^DJI", from = as.Date("1950-01-01"), to = as.Date("2020-12-04"), auto.assign = FALSE)
DOW.dab <- DOW$DJI.Close
X <- index(DOW.dab)
pred.dates <- seq(min(X),max(X),(max(X)-min(X))/2)
fitLM <- function(a){
V <-sample(DOW.dab,100)
K = coefficients(lm(log(V)~index(V)))
return(K)
}
s <- 1:2000
D = q <- mapply(fitLM,s)
plot(index(DOW.dab),log(DOW.dab),col=2,type='l')
for (i in 1:2000){
pred.Y <- D[1,i] +  D[2,i]*as.numeric(pred.dates)
pred <- xts(x = pred.Y, order.by = pred.dates)
lines(pred.dates,pred.Y)
}
lines(index(DOW.dab),log(DOW.dab),col=2)
m <- rowMeans(D)
setwd("~/Documents/r_packages/RBMDS/RBMDS/Simulation/Non-Parametric")
library(ToxicR)
model_list  = data.frame(model_list = c(rep("hill",3),rep("exp-3",3),rep("exp-5",3),rep("power",2)),
distribution_list =  c(rep(c("normal","normal-ncv","lognormal"),3),"normal",
"normal-ncv"))
model_list2 = data.frame(model_list = c(rep("hill",1),rep("exp-3",1),rep("exp-5",1),rep("power",1)),
distribution_list =  c(rep(c("normal"),4)))
file_list = dir()
file_list = file_list[!(file_list %in% "results")]
options(warn=-1)
for (ii in 1:length(file_list)){
load(file_list[ii])
BMD_result_SD_ML1_mcmc = matrix(NA,1000,3)
BMD_result_SD_ML1_lapl = matrix(NA,1000,3)
BMD_result_SD_ML2_mcmc = matrix(NA,1000,3)
BMD_result_SD_ML2_lapl = matrix(NA,1000,3)
BMD_result_HB_ML1_mcmc = matrix(NA,1000,3)
BMD_result_HB_ML1_lapl = matrix(NA,1000,3)
BMD_result_HB_ML2_mcmc = matrix(NA,1000,3)
BMD_result_HB_ML2_lapl = matrix(NA,1000,3)
pprobs_ML1 = matrix(NA,1000,11)
pprobs_ML2 = matrix(NA,1000,4)
for (jj in 1:1000){#nrow(sim_data)){
print(sprintf("File:%d Iter:%d.",ii,jj))
###############################################################################
y = sim_data[jj,]
AA <- ma_continuous_fit(as.matrix(doses),as.matrix(y),model_list=model_list,
fit_type = "mcmc",BMD_TYPE = 'sd',BMR = 1)
BB <- ma_continuous_fit(as.matrix(doses),as.matrix(y),model_list=model_list2,
fit_type = "mcmc",BMD_TYPE = 'sd',BMR = 1)
AA_l <- ma_continuous_fit(as.matrix(doses),as.matrix(y),model_list=model_list,
fit_type = "laplace",BMD_TYPE = 'sd',BMR = 1)
BB_l <- ma_continuous_fit(as.matrix(doses),as.matrix(y),model_list=model_list2,
fit_type = "laplace",BMD_TYPE = 'sd',BMR = 1)
BMD_result_SD_ML1_mcmc[jj,] = AA$bmd
BMD_result_SD_ML1_lapl[jj,] = AA_l$bmd
BMD_result_SD_ML2_mcmc[jj,] = BB$bmd
BMD_result_SD_ML2_lapl[jj,] = BB_l$bmd
pprobs_ML1[jj,] = AA$posterior_probs
pprobs_ML2[jj,] = BB$posterior_probs
###############################################################################
AA <- ma_continuous_fit(as.matrix(doses),as.matrix(y),model_list=model_list,
fit_type = "mcmc",BMD_TYPE = 'hybrid',BMR = 0.05,point_p = 0.025)
BB <- ma_continuous_fit(as.matrix(doses),as.matrix(y),model_list=model_list2,
fit_type = "mcmc",BMD_TYPE = 'hybrid',BMR = 0.05,point_p = 0.025)
AA_l <- ma_continuous_fit(as.matrix(doses),as.matrix(y),model_list=model_list,
fit_type = "laplace",BMD_TYPE = 'hybrid',BMR = 0.05,point_p = 0.025)
BB_l <- ma_continuous_fit(as.matrix(doses),as.matrix(y),model_list=model_list2,
fit_type = "laplace",BMD_TYPE = 'hybrid',BMR = 0.05,point_p = 0.025)
BMD_result_HB_ML1_mcmc[jj,] = AA$bmd
BMD_result_HB_ML1_lapl[jj,] = AA_l$bmd
BMD_result_HB_ML2_mcmc[jj,] = BB$bmd
BMD_result_HB_ML2_lapl[jj,] = BB_l$bmd
################################################################################
}
save(BMD_result_HB_ML1_lapl,BMD_result_HB_ML2_lapl,
BMD_result_HB_ML1_mcmc,BMD_result_HB_ML2_mcmc,
BMD_result_SD_ML1_lapl,BMD_result_SD_ML2_lapl,
BMD_result_SD_ML1_mcmc,BMD_result_SD_ML2_mcmc,
pprobs_ML1,pprobs_ML2,file=sprintf("./results/simrun_%s",file_list[ii]))
}
dir
dir()
plot(doses,y)
plot(AA)
plot(BB)
AA <- ma_continuous_fit(as.matrix(doses),as.matrix(y),model_list=model_list,
fit_type = "mcmc",BMD_TYPE = 'sd',BMR = 1)
BB <- ma_continuous_fit(as.matrix(doses),as.matrix(y),model_list=model_list2,
fit_type = "mcmc",BMD_TYPE = 'sd',BMR = 1)
AA_l <- ma_continuous_fit(as.matrix(doses),as.matrix(y),model_list=model_list,
fit_type = "laplace",BMD_TYPE = 'sd',BMR = 1)
BB_l <- ma_continuous_fit(as.matrix(doses),as.matrix(y),model_list=model_list2,
fit_type = "laplace",BMD_TYPE = 'sd',BMR = 1)
AA <- ma_continuous_fit(as.matrix(doses),as.matrix(y),model_list=model_list,
fit_type = "mcmc",BMD_TYPE = 'hybrid',BMR = 0.05,point_p = 0.025)
BB <- ma_continuous_fit(as.matrix(doses),as.matrix(y),model_list=model_list2,
fit_type = "mcmc",BMD_TYPE = 'hybrid',BMR = 0.05,point_p = 0.025)
AA_l <- ma_continuous_fit(as.matrix(doses),as.matrix(y),model_list=model_list,
fit_type = "laplace",BMD_TYPE = 'hybrid',BMR = 0.05,point_p = 0.025)
BB_l <- ma_continuous_fit(as.matrix(doses),as.matrix(y),model_list=model_list2,
fit_type = "laplace",BMD_TYPE = 'hybrid',BMR = 0.05,point_p = 0.025)
AA$posterior_probs
pprobs_ML1[1:jj]
pprobs_ML1[1:jj,]
rowMeans(pprobs_ML1[1:jj,])
colMeans(pprobs_ML1[1:jj,])
colMeans(pprobs_ML1[1:jj,])*10
colMeans(pprobs_ML1[1:jj,])*100
?splinefun
x <- runif(10)
cummin(x)
cummin(x) == x
cummin(x) == sort(x)
AA$ma_bmd
library(ToxicR)
y = sim_data[jj,]
AA <- ma_continuous_fit(as.matrix(doses),as.matrix(y),model_list=model_list,
fit_type = "mcmc",BMD_TYPE = 'sd',BMR = 1)
BB <- ma_continuous_fit(as.matrix(doses),as.matrix(y),model_list=model_list2,
fit_type = "mcmc",BMD_TYPE = 'sd',BMR = 1)
AA_l <- ma_continuous_fit(as.matrix(doses),as.matrix(y),model_list=model_list,
fit_type = "laplace",BMD_TYPE = 'sd',BMR = 1)
BB_l <- ma_continuous_fit(as.matrix(doses),as.matrix(y),model_list=model_list2,
fit_type = "laplace",BMD_TYPE = 'sd',BMR = 1)
BMD_result_SD_ML1_mcmc[jj,] = AA$bmd
BMD_result_SD_ML1_lapl[jj,] = AA_l$bmd
BMD_result_SD_ML2_mcmc[jj,] = BB$bmd
BMD_result_SD_ML2_lapl[jj,] = BB_l$bmd
plot(AA)
AA <- ma_continuous_fit(as.matrix(doses),as.matrix(y),model_list=model_list,
fit_type = "mcmc",BMD_TYPE = 'hybrid',BMR = 0.05,point_p = 0.025)
BB <- ma_continuous_fit(as.matrix(doses),as.matrix(y),model_list=model_list2,
fit_type = "mcmc",BMD_TYPE = 'hybrid',BMR = 0.05,point_p = 0.025)
AA_l <- ma_continuous_fit(as.matrix(doses),as.matrix(y),model_list=model_list,
fit_type = "laplace",BMD_TYPE = 'hybrid',BMR = 0.05,point_p = 0.025)
BB_l <- ma_continuous_fit(as.matrix(doses),as.matrix(y),model_list=model_list2,
fit_type = "laplace",BMD_TYPE = 'hybrid',BMR = 0.05,point_p = 0.025)
plot(AAA_l)
AA_l$ma_bmd
AA$ma_bmd
options(warn=-1)
for (ii in 1:length(file_list)){
load(file_list[ii])
BMD_result_SD_ML1_mcmc = matrix(NA,1000,3)
BMD_result_SD_ML1_lapl = matrix(NA,1000,3)
BMD_result_SD_ML2_mcmc = matrix(NA,1000,3)
BMD_result_SD_ML2_lapl = matrix(NA,1000,3)
BMD_result_HB_ML1_mcmc = matrix(NA,1000,3)
BMD_result_HB_ML1_lapl = matrix(NA,1000,3)
BMD_result_HB_ML2_mcmc = matrix(NA,1000,3)
BMD_result_HB_ML2_lapl = matrix(NA,1000,3)
pprobs_ML1 = matrix(NA,1000,11)
pprobs_ML2 = matrix(NA,1000,4)
for (jj in 1:1000){#nrow(sim_data)){
print(sprintf("File:%d Iter:%d.",ii,jj))
###############################################################################
y = sim_data[jj,]
AA <- ma_continuous_fit(as.matrix(doses),as.matrix(y),model_list=model_list,
fit_type = "mcmc",BMD_TYPE = 'sd',BMR = 1)
BB <- ma_continuous_fit(as.matrix(doses),as.matrix(y),model_list=model_list2,
fit_type = "mcmc",BMD_TYPE = 'sd',BMR = 1)
AA_l <- ma_continuous_fit(as.matrix(doses),as.matrix(y),model_list=model_list,
fit_type = "laplace",BMD_TYPE = 'sd',BMR = 1)
BB_l <- ma_continuous_fit(as.matrix(doses),as.matrix(y),model_list=model_list2,
fit_type = "laplace",BMD_TYPE = 'sd',BMR = 1)
BMD_result_SD_ML1_mcmc[jj,] = AA$bmd
BMD_result_SD_ML1_lapl[jj,] = AA_l$bmd
BMD_result_SD_ML2_mcmc[jj,] = BB$bmd
BMD_result_SD_ML2_lapl[jj,] = BB_l$bmd
pprobs_ML1[jj,] = AA$posterior_probs
pprobs_ML2[jj,] = BB$posterior_probs
###############################################################################
AA <- ma_continuous_fit(as.matrix(doses),as.matrix(y),model_list=model_list,
fit_type = "mcmc",BMD_TYPE = 'hybrid',BMR = 0.05,point_p = 0.025)
BB <- ma_continuous_fit(as.matrix(doses),as.matrix(y),model_list=model_list2,
fit_type = "mcmc",BMD_TYPE = 'hybrid',BMR = 0.05,point_p = 0.025)
AA_l <- ma_continuous_fit(as.matrix(doses),as.matrix(y),model_list=model_list,
fit_type = "laplace",BMD_TYPE = 'hybrid',BMR = 0.05,point_p = 0.025)
BB_l <- ma_continuous_fit(as.matrix(doses),as.matrix(y),model_list=model_list2,
fit_type = "laplace",BMD_TYPE = 'hybrid',BMR = 0.05,point_p = 0.025)
BMD_result_HB_ML1_mcmc[jj,] = AA$bmd
BMD_result_HB_ML1_lapl[jj,] = AA_l$bmd
BMD_result_HB_ML2_mcmc[jj,] = BB$bmd
BMD_result_HB_ML2_lapl[jj,] = BB_l$bmd
################################################################################
}
save(BMD_result_HB_ML1_lapl,BMD_result_HB_ML2_lapl,
BMD_result_HB_ML1_mcmc,BMD_result_HB_ML2_mcmc,
BMD_result_SD_ML1_lapl,BMD_result_SD_ML2_lapl,
BMD_result_SD_ML1_mcmc,BMD_result_SD_ML2_mcmc,
pprobs_ML1,pprobs_ML2,file=sprintf("./results/simrun_%s",file_list[ii]))
}
AA <- ma_continuous_fit(as.matrix(doses),as.matrix(y),model_list=model_list,
fit_type = "mcmc",BMD_TYPE = 'sd',BMR = 1)
BB <- ma_continuous_fit(as.matrix(doses),as.matrix(y),model_list=model_list2,
fit_type = "mcmc",BMD_TYPE = 'sd',BMR = 1)
AA_l <- ma_continuous_fit(as.matrix(doses),as.matrix(y),model_list=model_list,
fit_type = "laplace",BMD_TYPE = 'sd',BMR = 1)
BB_l <- ma_continuous_fit(as.matrix(doses),as.matrix(y),model_list=model_list2,
fit_type = "laplace",BMD_TYPE = 'sd',BMR = 1)
as.matrix(doses)
as.matrix(y)
plot(doses,y)
plot(AA)
plot(BB)
BB_l <- ma_continuous_fit(as.matrix(doses),as.matrix(y),model_list=model_list2,
fit_type = "laplace",BMD_TYPE = 'hybrid',BMR = 0.05,point_p = 0.025)
AA_l
AA <- ma_continuous_fit(as.matrix(doses),as.matrix(y),model_list=model_list,
fit_type = "mcmc",BMD_TYPE = 'sd',BMR = 1)
BB <- ma_continuous_fit(as.matrix(doses),as.matrix(y),model_list=model_list2,
fit_type = "mcmc",BMD_TYPE = 'sd',BMR = 1)
AA_l <- ma_continuous_fit(as.matrix(doses),as.matrix(y),model_list=model_list,
fit_type = "laplace",BMD_TYPE = 'sd',BMR = 1)
BB_l <- ma_continuous_fit(as.matrix(doses),as.matrix(y),model_list=model_list2,
fit_type = "laplace",BMD_TYPE = 'sd',BMR = 1)
AA_l$posterior_probs
load("~/Documents/r_packages/RBMDS/RBMDS/Simulation/Hill/results/simrun_Hill_invGaussian_e_4_sim_4.Rdata")
colMeans(HB_ML1_mcmc)
colMeans(BMD_result_HB_ML1_mcmc)
BMD_result_HB_ML1_lapl
BMD_result_HB_ML1_lapl[333:666,]
colMeans(BMD_result_HB_ML1_mcmc,na.rm=TRUE)
colMeans(BMD_result_HB_ML1_lapl,na.rm=TRUE)
colMeans(BMD_result_HB_ML2_mcmc,na.rm=TRUE)
colMeans(BMD_result_HB_ML2_lapl,na.rm=TRUE)
load("~/Documents/r_packages/RBMDS/RBMDS/Simulation/Hill/results/simrun_Hill_invGaussian_e_4_sim_4.Rdata")
colMeans(BMD_result_HB_ML2_mcmc,na.rm=TRUE)
plot(AA)
load("~/Documents/r_packages/RBMDS/RBMDS/Simulation/Hill/Hill_invGaussian_e_4_sim_1.Rdata")
y = sim_data[jj,]
plot(doses,y)
AA <- ma_continuous_fit(as.matrix(doses),as.matrix(y),model_list=model_list,
fit_type = "mcmc",BMD_TYPE = 'hybrid',BMR = 0.05,point_p = 0.025)
plot(AA)
jj
jj = 400
y = sim_data[jj,]
AA <- ma_continuous_fit(as.matrix(doses),as.matrix(y),model_list=model_list,
fit_type = "mcmc",BMD_TYPE = 'hybrid',BMR = 0.05,point_p = 0.025)
BMD_result_HB_ML1_mcmc[jj,] = AA$bmd
plot(AA)
jj = 600
AA <- ma_continuous_fit(as.matrix(doses),as.matrix(y),model_list=model_list,
fit_type = "mcmc",BMD_TYPE = 'hybrid',BMR = 0.05,point_p = 0.025)
plot(AA)
jj = 950
y = sim_data[jj,]
AA <- ma_continuous_fit(as.matrix(doses),as.matrix(y),model_list=model_list,
fit_type = "mcmc",BMD_TYPE = 'sd',BMR = 1)
plot(AA)
jj = 120
AA <- ma_continuous_fit(as.matrix(doses),as.matrix(y),model_list=model_list,
fit_type = "mcmc",BMD_TYPE = 'hybrid',BMR = 0.05,point_p = 0.025)
plot(AA)
y = sim_data[jj,]
AA <- ma_continuous_fit(as.matrix(doses),as.matrix(y),model_list=model_list,
fit_type = "mcmc",BMD_TYPE = 'hybrid',BMR = 0.05,point_p = 0.025)
plot(AA)
jj = 350
y = sim_data[jj,]
AA <- ma_continuous_fit(as.matrix(doses),as.matrix(y),model_list=model_list,
fit_type = "mcmc",BMD_TYPE = 'hybrid',BMR = 0.05,point_p = 0.025)
plot(AA)
AA <- ma_continuous_fit(as.matrix(doses),as.matrix(y),model_list=model_list,
fit_type = "mcmc",BMD_TYPE = 'sd',BMR = 1)
plot(AA)
BMD_result_HB_ML1_mcmc[jj,]
AA$bmd
AA_l$bmd
AA_l <- ma_continuous_fit(as.matrix(doses),as.matrix(y),model_list=model_list,
fit_type = "laplace",BMD_TYPE = 'hybrid',BMR = 0.05,point_p = 0.025)
AA_l$bmd
BMD_result_HB_ML1_mcmc[jj,] = AA$bmd
BMD_result_HB_ML1_lapl[jj,] = AA_l$bmd
BMD_result_HB_ML1_mcmc[jj,]
View(BMD_result_HB_ML1_mcmc)
load("~/Documents/r_packages/RBMDS/RBMDS/Simulation/Hill/Hill_invGaussian_e_4_sim_1.Rdata")
BMD_result_SD_ML1_mcmc = matrix(NA,1000,3)
BMD_result_SD_ML1_lapl = matrix(NA,1000,3)
BMD_result_SD_ML2_mcmc = matrix(NA,1000,3)
BMD_result_SD_ML2_lapl = matrix(NA,1000,3)
BMD_result_HB_ML1_mcmc = matrix(NA,1000,3)
BMD_result_HB_ML1_lapl = matrix(NA,1000,3)
BMD_result_HB_ML2_mcmc = matrix(NA,1000,3)
BMD_result_HB_ML2_lapl = matrix(NA,1000,3)
pprobs_ML1 = matrix(NA,1000,11)
pprobs_ML2 = matrix(NA,1000,4)
for (jj in 1:10){#nrow(sim_data)){
print(sprintf("File:%d Iter:%d.",ii,jj))
###############################################################################
y = sim_data[jj,]
AA <- ma_continuous_fit(as.matrix(doses),as.matrix(y),model_list=model_list,
fit_type = "mcmc",BMD_TYPE = 'sd',BMR = 1)
BB <- ma_continuous_fit(as.matrix(doses),as.matrix(y),model_list=model_list2,
fit_type = "mcmc",BMD_TYPE = 'sd',BMR = 1)
AA_l <- ma_continuous_fit(as.matrix(doses),as.matrix(y),model_list=model_list,
fit_type = "laplace",BMD_TYPE = 'sd',BMR = 1)
BB_l <- ma_continuous_fit(as.matrix(doses),as.matrix(y),model_list=model_list2,
fit_type = "laplace",BMD_TYPE = 'sd',BMR = 1)
BMD_result_SD_ML1_mcmc[jj,] = AA$bmd
BMD_result_SD_ML1_lapl[jj,] = AA_l$bmd
BMD_result_SD_ML2_mcmc[jj,] = BB$bmd
BMD_result_SD_ML2_lapl[jj,] = BB_l$bmd
pprobs_ML1[jj,] = AA$posterior_probs
pprobs_ML2[jj,] = BB$posterior_probs
###############################################################################
AA <- ma_continuous_fit(as.matrix(doses),as.matrix(y),model_list=model_list,
fit_type = "mcmc",BMD_TYPE = 'hybrid',BMR = 0.05,point_p = 0.025)
BB <- ma_continuous_fit(as.matrix(doses),as.matrix(y),model_list=model_list2,
fit_type = "mcmc",BMD_TYPE = 'hybrid',BMR = 0.05,point_p = 0.025)
AA_l <- ma_continuous_fit(as.matrix(doses),as.matrix(y),model_list=model_list,
fit_type = "laplace",BMD_TYPE = 'hybrid',BMR = 0.05,point_p = 0.025)
BB_l <- ma_continuous_fit(as.matrix(doses),as.matrix(y),model_list=model_list2,
fit_type = "laplace",BMD_TYPE = 'hybrid',BMR = 0.05,point_p = 0.025)
BMD_result_HB_ML1_mcmc[jj,] = AA$bmd
BMD_result_HB_ML1_lapl[jj,] = AA_l$bmd
BMD_result_HB_ML2_mcmc[jj,] = BB$bmd
BMD_result_HB_ML2_lapl[jj,] = BB_l$bmd
################################################################################
}
BMD_result_HB_ML1_mcmc[1:10,]
plot(AA)
jj = 10
AA <- ma_continuous_fit(as.matrix(doses),as.matrix(y),model_list=model_list,
fit_type = "mcmc",BMD_TYPE = 'hybrid',BMR = 0.05,point_p = 0.025)
plot(AA)
AA$bmd
KK = BMD_result_HB_ML1_mcmc[1:10,]
load("~/Documents/r_packages/RBMDS/RBMDS/Simulation/Hill/results/simrun_Hill_invGaussian_e_4_sim_1.Rdata")
GG = BMD_result_HB_ML1_mcmc[1:10,]
GG
mean(BMD_result_HB_ML1_mcmc[,1])
mean(BMD_result_HB_ML1_lapl[,1])
mean(BMD_result_SD_ML1_lapl[,1])
mean(BMD_result_SD_ML1_MCMC[,1])
mean(BMD_result_SD_ML1_mcmc[,1])
mean(BMD_result_SD_ML1_mcmc[,2] < 54.90)
mean(BMD_result_SD_ML1_mcmc[,3] > 54.90)
mean(BMD_result_SD_ML2_mcmc[,1])
mean(BMD_result_SD_ML1_mcmc[,1])
load("~/Documents/r_packages/RBMDS/RBMDS/Simulation/Hill/results/simrun_Hill_invGaussian_e_4_sim_4.Rdata")
mean(BMD_result_SD_ML1_mcmc[,1])
mean(BMD_result_SD_ML2_mcmc[,1])
mean(BMD_result_SD_ML2_lapl[,1])
mean(BMD_result_SD_ML1_lapl[,1])
load("~/Documents/r_packages/RBMDS/RBMDS/Simulation/Hill/results/simrun_Hill_invGaussian_e_4_sim_3.Rdata")
mean(BMD_result_SD_ML1_lapl[,1])
mean(BMD_result_SD_ML2_lapl[,1])
mean(BMD_result_SD_ML2_mcmc[,1])
mean(BMD_result_HB_ML2_mcmc[,1])
mean(BMD_result_HB_ML2_mcmc[,1],na.rm=TRUE)
hist(BMD_result_HB_ML2_mcmc[,1],na.rm=TRUE)
load("~/Documents/r_packages/RBMDS/RBMDS/Simulation/Hill/Hill_invGaussian_e_4_sim_3.Rdata")
y = sim_data[jj,]
plot(y,doses)
plot(doses,y)
AA <- ma_continuous_fit(as.matrix(doses),as.matrix(y),model_list=model_list,
fit_type = "mcmc",BMD_TYPE = 'hybrid',BMR = 0.05,point_p = 0.025)
plot(AA)
AA <- ma_continuous_fit(as.matrix(doses),as.matrix(y),model_list=model_list,
fit_type = "mcmc",BMD_TYPE = 'sd',BMR = 1)
plot(AA)
load("~/Documents/r_packages/RBMDS/RBMDS/Simulation/Hill/Hill_invGaussian_e_4_sim_2.Rdata")
plot(doses,y)
y = sim_data[jj,]
plot(doses,y)
AA <- ma_continuous_fit(as.matrix(doses),as.matrix(y),model_list=model_list,
fit_type = "mcmc",BMD_TYPE = 'hybrid',BMR = 0.05,point_p = 0.025)
plot(AA)
BB <- ma_continuous_fit(as.matrix(doses),as.matrix(y),model_list=model_list2,
fit_type = "mcmc",BMD_TYPE = 'hybrid',BMR = 0.05,point_p = 0.025)
plot(BB)
ii
jj
