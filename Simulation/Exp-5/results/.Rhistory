plot(doses,sim_data[1])
plot(doses,sim_data[1,])
BMD_result_HB_ML1_mcmc[1,]
# Study design drawn from
# https://www.fda.gov/regulatory-information/search-fda-guidance-documents/redbook-2000-ivc3a-short-term-toxicity-studies-rodents#exp
# Means and variances drawn from
# https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3620211/
# Body Weight
library(knitr)
library(ToxicR)
library(actuar)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
Hill.p <- rbind(c(481,-250.3,70,3.3),
c(481,-250.3,40,1.3),
c(481,-250.2,15,1.1),
c(481,-250.3,50,4) ,
c(10.58,9.7,70,3.5),
c(10.58,9.7,25,3),
c(10.58,9.7,15,2),
c(10.58,9.7,50,4))
hill <- data.frame(a=Hill.p[,1],b=Hill.p[,2],
c=Hill.p[,3],d=Hill.p[,4])
row.names(hill) <- c("Hill Simulation 1","Hill Simulation 2",
"Hill Simulation 3","Hill Simulation 4",
"Hill Simulation 5","Hill Simulation 6",
"hill Simulation 7","Hill Simulation 8")
#estimates of the Log-normal variance
f1 = function(x){log(exp(x)*expm1(x))-(log(77.5^2) -2*log(481))}
sqrt(uniroot(f1,c(0,1))$root)
f2 = function(x){log(exp(x)*expm1(x))-(log(2.28^2) -2*log(10.58))}
sqrt(uniroot(f2,c(0,1))$root)
doses <- seq(0,100,0.5)
X <- iSpline(doses,knots=seq(30,90,20),intercept=TRUE)
files[ii]
plot(doses,sim_data[1000,])
View(sim_data)
length(doses)
length(sim_data[100,])
files[ii]
load("~/Documents/r_software/RBMDS/Simulation/Non-Parametric/NP_normal_g_5_sim_4.Rdata")
length(sim_data[100,])
plot(doses,sim_data[1000,])
var(sim_data[1000,1:10])
load("~/Documents/r_software/RBMDS/Simulation/Non-Parametric/NP_normal_g_5_sim_1.Rdata")
var(sim_data[1000,1:10])
plot(sim_data[1000,])
load("~/Documents/r_software/RBMDS/Simulation/Non-Parametric/NP_normal_g_4_sim_3.Rdata")
plot(doses,sim_data[1000,])
load("~/Documents/r_software/RBMDS/Simulation/Non-Parametric/NP_invGaussian_e_4_sim_4.Rdata")
plot(doses,sim_data[1000,])
setwd("~/Documents/r_software/RBMDS/Documents CMA Paper")
481^3/18528.14
sqrt(481^3/18528.14)
#Create MA simulation
#Simulation Creation for the CMA paper
#iSpline copied from Simulation Conditions.Rmd (2/5/11)
library(ToxicR)
library(actuar)
set.seed(90101)
setwd('./Non-Parametric')
#log-transformed for fitting as in ToxicR use
beta1 <- c(0.15486274,0.14054532,0.05806702,0.67421470,0.18371405,0.92821744,1.60669594,1.04508522)
beta2 <- c(0.677816175,0.322787366,3.356424380,0.102841870,0.009085238,0.087907971,0.344255936,0.100000000)
#add 481 to get the background
beta3 <- c(-45.715480,-53.668821,-14.266726, -8.066441,-1.620326 ,-1.800000,-1.800000 ,-1.800000)
beta4 <- c(-11.9566632,-19.9908719,-39.3450020,-16.3895141,-2.8191037,-4.5801731,-0.834784,-0.7000000)
iS <- rbind(beta1,beta2,beta3,beta4)
dose_g_5 <- rep(c(0,6.25,12.5,25,50,100),each=10)
dose_e_5 <- rep(c(0,20,40,60,80,100),each=10)
dose_g_4 <- rep(c(0,12.5,25,50,100),each=10)
dose_e_4 <- rep(c(0,25,50,75,100),each=10)
library(splines2)
X_g_5 <- iSpline(dose_g_5,knots=seq(30,90,20))
X_e_5 <- iSpline(dose_e_5,knots=seq(30,90,20))
X_g_4 <- iSpline(dose_g_4,knots=seq(30,90,20))
X_e_4 <- iSpline(dose_e_4,knots=seq(30,90,20))
bkg = c(10.58,10.58,481,481)
sd    <- c(rep(2.28,4),rep(77.5,2))
#normal data
means_g_5 <- X_g_5%*%t(iS[i,,drop=F]) + bkg[i]
means_e_5 <- X_e_5%*%t(iS[i,,drop=F]) + bkg[i]
means_g_4 <- X_g_4%*%t(iS[i,,drop=F]) + bkg[i]
means_e_4 <- X_e_4%*%t(iS[i,,drop=F]) + bkg[i]
i = 1
i = 4
doses = dose_g_5
sim_data <- matrix(rnorm(1000*length(dose_g_5),means_g_5,sd[i]),nrow=1000,ncol=length(dose_g_5),byrow=T)
means_g_5 <- X_g_5%*%t(iS[i,,drop=F]) + bkg[i]
means_e_5 <- X_e_5%*%t(iS[i,,drop=F]) + bkg[i]
means_g_4 <- X_g_4%*%t(iS[i,,drop=F]) + bkg[i]
means_e_4 <- X_e_4%*%t(iS[i,,drop=F]) + bkg[i]
sim_data <- matrix(rnorm(1000*length(dose_g_5),means_g_5,sd[i]),nrow=1000,ncol=length(dose_g_5),byrow=T)
plot(sim_data)
sd[i]
bmds.H <- c(41.49,	57.19,	42.61,
10.61,	23.94,	11.35,
3.13,	8.18,	3.39,
32.48,	42.32,	33.2,
40.08,	54.81,	38.9,
13.04,	18.79,	12.6,
5.65,	9.78,	5.37,
30.7,	40.37,	29.91)
bmds.SD<- c(54.9,	54.91,	54.9,
21.59,	21.6,	21.59,
7.24,	7.25,	7.24,
40.92,	40.93,	40.92,
49.97,	49.97,	49.97,
16.87,	16.87,	16.87,
8.31,	8.31,	8.31,
37.23,	37.23,	37.23)
bmds.H <- c(41.49,	57.19,	42.61,
10.61,	23.94,	11.35,
3.13,	8.18,	3.39,
32.48,	42.32,	33.2,
40.08,	54.81,	38.9,
13.04,	18.79,	12.6,
5.65,	9.78,	5.37,
30.7,	40.37,	29.91)
BMD.H  <- matrix(bmds.H,nrow=4,ncol=3,byrow=T)
BMD.SD <- matrix(bmds.SD,nrow=4,ncol=3,byrow=T)
setwd("~/Documents/r_software/RBMDS/Simulation/Hill/results")
files <- dir()
length(files)
bmds.SD<- c(54.9,	54.91,	54.9,
21.59,	21.6,	21.59,
7.24,	7.25,	7.24,
40.92,	40.93,	40.92,
49.97,	49.97,	49.97,
16.87,	16.87,	16.87,
8.31,	8.31,	8.31,
37.23,	37.23,	37.23)
bmds.H <- c(41.49,	57.19,	42.61,
10.61,	23.94,	11.35,
3.13,	8.18,	3.39,
32.48,	42.32,	33.2,
40.08,	54.81,	38.9,
13.04,	18.79,	12.6,
5.65,	9.78,	5.37,
30.7,	40.37,	29.91)
BMD.H  <- matrix(bmds.H,nrow=4,ncol=3,byrow=T)
BMD.SD <- matrix(bmds.SD,nrow=4,ncol=3,byrow=T)
setwd("~/Documents/r_software/RBMDS/Simulation/Hill/results")
files <- dir()
ivgSims = grepl("invGaussian",files)
norSims = grepl("normal",files)
lnorSims = grepl("lognormal",files)
cond1 = grepl("sim_1",files)
cond2 = grepl("sim_2",files)
cond3 = grepl("sim_3",files)
cond4 = grepl("sim_4",files)
cond5 = grepl("sim_5",files)
cond6 = grepl("sim_6",files)
cond7 = grepl("sim_7",files)
cond8 = !(cond1 | cond2 | cond3 | cond4 | cond5 | cond6 | cond7)
is_geom = grepl("_g_",files)
is_4    = grepl("_4_",files)
lap1.sd <- array(NA,c(8,3,4))
lap2.sd <- array(NA,c(8,3,4))
mcmc1.sd <- array(NA,c(8,3,4))
mcmc2.sd <- array(NA,c(8,3,4))
lap1.h <- array(NA,c(8,3,4))
lap2.h <- array(NA,c(8,3,4))
mcmc1.h <- array(NA,c(8,3,4))
mcmc2.h <- array(NA,c(8,3,4))
for (ii in 1:length(files)){
load(files[ii])
simtype = 1
if (lnorSims[ii] == TRUE){
simtype = 2
}
if (ivgSims[ii] == TRUE){
simtype = 3
}
even = 1
if (is_geom[ii] == TRUE){
even = 3
}
if (!is_4[ii] == TRUE){ # for 5 dose groups
even = even + 1
}
#simulation condition
scond = which(c(cond1[ii],cond2[ii],cond3[ii],cond4[ii]))
true_BMD.h  = BMD.H[scond,simtype]
true_BMD.sd = BMD.SD[scond,simtype]
lap1.sd[scond,simtype,even]  = mean(BMD_result_SD_ML1_lapl[,2] < true_BMD.sd,na.rm=TRUE)
lap2.sd[scond,simtype,even]  = mean(BMD_result_SD_ML2_lapl[,2] < true_BMD.sd,na.rm=TRUE)
mcmc1.sd[scond,simtype,even] = mean(BMD_result_SD_ML1_mcmc[,2]  < true_BMD.sd,na.rm=TRUE)
mcmc2.sd[scond,simtype,even] = mean(BMD_result_SD_ML2_mcmc[,2]  < true_BMD.sd,na.rm=TRUE)
lap1.h[scond,simtype,even]   = mean(BMD_result_HB_ML1_lapl[,2] < true_BMD.h,na.rm=TRUE)
lap2.h[scond,simtype,even]   = mean(BMD_result_HB_ML2_lapl[,2] < true_BMD.h,na.rm=TRUE)
mcmc1.h[scond,simtype,even]  = mean(BMD_result_HB_ML1_mcmc[,2]  < true_BMD.h,na.rm=TRUE)
mcmc2.h[scond,simtype,even]  = mean(BMD_result_HB_ML2_mcmc[,2]  < true_BMD.h,na.rm=TRUE)
}
mcmc1.h[,,1]
for (ii in 1:length(files)){
load(files[ii])
simtype = 1
if (lnorSims[ii] == TRUE){
simtype = 2
}
if (ivgSims[ii] == TRUE){
simtype = 3
}
even = 1
if (is_geom[ii] == TRUE){
even = 3
}
if (!is_4[ii] == TRUE){ # for 5 dose groups
even = even + 1
}
#simulation condition
scond = which(c(cond1[ii],cond2[ii],cond3[ii],cond4[ii],cond5[ii],cond6[ii],cond7[ii],cond8[ii]))
true_BMD.h  = BMD.H[scond,simtype]
true_BMD.sd = BMD.SD[scond,simtype]
lap1.sd[scond,simtype,even]  = mean(BMD_result_SD_ML1_lapl[,2] < true_BMD.sd,na.rm=TRUE)
lap2.sd[scond,simtype,even]  = mean(BMD_result_SD_ML2_lapl[,2] < true_BMD.sd,na.rm=TRUE)
mcmc1.sd[scond,simtype,even] = mean(BMD_result_SD_ML1_mcmc[,2]  < true_BMD.sd,na.rm=TRUE)
mcmc2.sd[scond,simtype,even] = mean(BMD_result_SD_ML2_mcmc[,2]  < true_BMD.sd,na.rm=TRUE)
lap1.h[scond,simtype,even]   = mean(BMD_result_HB_ML1_lapl[,2] < true_BMD.h,na.rm=TRUE)
lap2.h[scond,simtype,even]   = mean(BMD_result_HB_ML2_lapl[,2] < true_BMD.h,na.rm=TRUE)
mcmc1.h[scond,simtype,even]  = mean(BMD_result_HB_ML1_mcmc[,2]  < true_BMD.h,na.rm=TRUE)
mcmc2.h[scond,simtype,even]  = mean(BMD_result_HB_ML2_mcmc[,2]  < true_BMD.h,na.rm=TRUE)
}
scond
bmds.SD<- c(54.9,	54.91,	54.9,
21.59,	21.6,	21.59,
7.24,	7.25,	7.24,
40.92,	40.93,	40.92,
49.97,	49.97,	49.97,
16.87,	16.87,	16.87,
8.31,	8.31,	8.31,
37.23,	37.23,	37.23)
bmds.H <- c(41.49,	57.19,	42.61,
10.61,	23.94,	11.35,
3.13,	8.18,	3.39,
32.48,	42.32,	33.2,
40.08,	54.81,	38.9,
13.04,	18.79,	12.6,
5.65,	9.78,	5.37,
30.7,	40.37,	29.91)
BMD.H  <- matrix(bmds.H,nrow=4,ncol=3,byrow=T)
BMD.SD <- matrix(bmds.SD,nrow=4,ncol=3,byrow=T)
setwd("~/Documents/r_software/RBMDS/Simulation/Hill/results")
files <- dir()
ivgSims = grepl("invGaussian",files)
norSims = grepl("normal",files)
lnorSims = grepl("lognormal",files)
cond1 = grepl("sim_1",files)
cond2 = grepl("sim_2",files)
cond3 = grepl("sim_3",files)
cond4 = grepl("sim_4",files)
cond5 = grepl("sim_5",files)
cond6 = grepl("sim_6",files)
cond7 = grepl("sim_7",files)
cond8 = !(cond1 | cond2 | cond3 | cond4 | cond5 | cond6 | cond7)
is_geom = grepl("_g_",files)
is_4    = grepl("_4_",files)
lap1.sd <- array(NA,c(8,3,4))
lap2.sd <- array(NA,c(8,3,4))
mcmc1.sd <- array(NA,c(8,3,4))
mcmc2.sd <- array(NA,c(8,3,4))
lap1.h <- array(NA,c(8,3,4))
lap2.h <- array(NA,c(8,3,4))
mcmc1.h <- array(NA,c(8,3,4))
mcmc2.h <- array(NA,c(8,3,4))
dim(mcmc1.h)
for (ii in 1:length(files)){
load(files[ii])
simtype = 1
if (lnorSims[ii] == TRUE){
simtype = 2
}
if (ivgSims[ii] == TRUE){
simtype = 3
}
even = 1
if (is_geom[ii] == TRUE){
even = 3
}
if (!is_4[ii] == TRUE){ # for 5 dose groups
even = even + 1
}
#simulation condition
scond = which(c(cond1[ii],cond2[ii],cond3[ii],cond4[ii],cond5[ii],cond6[ii],cond7[ii],cond8[ii]))
true_BMD.h  = BMD.H[scond,simtype]
true_BMD.sd = BMD.SD[scond,simtype]
lap1.sd[scond,simtype,even]  = mean(BMD_result_SD_ML1_lapl[,2] < true_BMD.sd,na.rm=TRUE)
lap2.sd[scond,simtype,even]  = mean(BMD_result_SD_ML2_lapl[,2] < true_BMD.sd,na.rm=TRUE)
mcmc1.sd[scond,simtype,even] = mean(BMD_result_SD_ML1_mcmc[,2]  < true_BMD.sd,na.rm=TRUE)
mcmc2.sd[scond,simtype,even] = mean(BMD_result_SD_ML2_mcmc[,2]  < true_BMD.sd,na.rm=TRUE)
lap1.h[scond,simtype,even]   = mean(BMD_result_HB_ML1_lapl[,2] < true_BMD.h,na.rm=TRUE)
lap2.h[scond,simtype,even]   = mean(BMD_result_HB_ML2_lapl[,2] < true_BMD.h,na.rm=TRUE)
mcmc1.h[scond,simtype,even]  = mean(BMD_result_HB_ML1_mcmc[,2]  < true_BMD.h,na.rm=TRUE)
mcmc2.h[scond,simtype,even]  = mean(BMD_result_HB_ML2_mcmc[,2]  < true_BMD.h,na.rm=TRUE)
}
bmds.SD<- c(54.9,	54.91,	54.9,
21.59,	21.6,	21.59,
7.24,	7.25,	7.24,
40.92,	40.93,	40.92,
49.97,	49.97,	49.97,
16.87,	16.87,	16.87,
8.31,	8.31,	8.31,
37.23,	37.23,	37.23)
bmds.H <- c(41.49,	57.19,	42.61,
10.61,	23.94,	11.35,
3.13,	8.18,	3.39,
32.48,	42.32,	33.2,
40.08,	54.81,	38.9,
13.04,	18.79,	12.6,
5.65,	9.78,	5.37,
30.7,	40.37,	29.91)
BMD.H  <- matrix(bmds.H,nrow=8,ncol=3,byrow=T)
BMD.SD <- matrix(bmds.SD,nrow=8,ncol=3,byrow=T)
bmds.SD<- c(54.9,	54.91,	54.9,
21.59,	21.6,	21.59,
7.24,	7.25,	7.24,
40.92,	40.93,	40.92,
49.97,	49.97,	49.97,
16.87,	16.87,	16.87,
8.31,	8.31,	8.31,
37.23,	37.23,	37.23)
bmds.H <- c(41.49,	57.19,	42.61,
10.61,	23.94,	11.35,
3.13,	8.18,	3.39,
32.48,	42.32,	33.2,
40.08,	54.81,	38.9,
13.04,	18.79,	12.6,
5.65,	9.78,	5.37,
30.7,	40.37,	29.91)
BMD.H  <- matrix(bmds.H,nrow=8,ncol=3,byrow=T)
BMD.SD <- matrix(bmds.SD,nrow=8,ncol=3,byrow=T)
setwd("~/Documents/r_software/RBMDS/Simulation/Hill/results")
files <- dir()
ivgSims = grepl("invGaussian",files)
norSims = grepl("normal",files)
lnorSims = grepl("lognormal",files)
cond1 = grepl("sim_1",files)
cond2 = grepl("sim_2",files)
cond3 = grepl("sim_3",files)
cond4 = grepl("sim_4",files)
cond5 = grepl("sim_5",files)
cond6 = grepl("sim_6",files)
cond7 = grepl("sim_7",files)
cond8 = !(cond1 | cond2 | cond3 | cond4 | cond5 | cond6 | cond7)
is_geom = grepl("_g_",files)
is_4    = grepl("_4_",files)
lap1.sd <- array(NA,c(8,3,4))
lap2.sd <- array(NA,c(8,3,4))
mcmc1.sd <- array(NA,c(8,3,4))
mcmc2.sd <- array(NA,c(8,3,4))
lap1.h <- array(NA,c(8,3,4))
lap2.h <- array(NA,c(8,3,4))
mcmc1.h <- array(NA,c(8,3,4))
mcmc2.h <- array(NA,c(8,3,4))
for (ii in 1:length(files)){
load(files[ii])
simtype = 1
if (lnorSims[ii] == TRUE){
simtype = 2
}
if (ivgSims[ii] == TRUE){
simtype = 3
}
even = 1
if (is_geom[ii] == TRUE){
even = 3
}
if (!is_4[ii] == TRUE){ # for 5 dose groups
even = even + 1
}
#simulation condition
scond = which(c(cond1[ii],cond2[ii],cond3[ii],cond4[ii],cond5[ii],cond6[ii],cond7[ii],cond8[ii]))
true_BMD.h  = BMD.H[scond,simtype]
true_BMD.sd = BMD.SD[scond,simtype]
lap1.sd[scond,simtype,even]  = mean(BMD_result_SD_ML1_lapl[,2] < true_BMD.sd,na.rm=TRUE)
lap2.sd[scond,simtype,even]  = mean(BMD_result_SD_ML2_lapl[,2] < true_BMD.sd,na.rm=TRUE)
mcmc1.sd[scond,simtype,even] = mean(BMD_result_SD_ML1_mcmc[,2]  < true_BMD.sd,na.rm=TRUE)
mcmc2.sd[scond,simtype,even] = mean(BMD_result_SD_ML2_mcmc[,2]  < true_BMD.sd,na.rm=TRUE)
lap1.h[scond,simtype,even]   = mean(BMD_result_HB_ML1_lapl[,2] < true_BMD.h,na.rm=TRUE)
lap2.h[scond,simtype,even]   = mean(BMD_result_HB_ML2_lapl[,2] < true_BMD.h,na.rm=TRUE)
mcmc1.h[scond,simtype,even]  = mean(BMD_result_HB_ML1_mcmc[,2]  < true_BMD.h,na.rm=TRUE)
mcmc2.h[scond,simtype,even]  = mean(BMD_result_HB_ML2_mcmc[,2]  < true_BMD.h,na.rm=TRUE)
}
mcmc1.h[,,1]
mcmc1.sd[,,1]
mcmc1.sd[,,2]
mcmc1.sd[,,3]
mcmc1.sd[,,4]
mcmc1.h[,,4]
mcmc1.h[,,1]
mcmc1.h[,,2]
mcmc1.h[,,3]
cbind(mcmc1.h[,,3],mcmc1.h[,,4]
)
cbind(mcmc2.h[,,3],mcmc2.h[,,4])
cbind(lap1.h[,,3],mcmc2.h[,,4])
cbind(lap1.h[,,3],lap1.h[,,4])
cbind(lap1.h[,,3],mcmc.h[,,3])
cbind(lap1.h[,,3],mcmc1.h[,,3])
cbind(lap1.sd[,,3],mcmc1.sd[,,3])
cbind(lap2.sd[,,3],mcmc2.sd[,,3])
install.packages("xtable")
SD_ig <- cbind(lap1.sd[,4,3],lap2.sd[,4,3],mcmc1.sd[,4,3],mcmc1.sd[,4,3])
SD_ig <- cbind(lap1.sd[,3,3],lap2.sd[,3,3],mcmc1.sd[,3,3],mcmc1.sd[,3,3])
SD_ig
SD_ig_G_5 <- cbind(lap1.sd[,3,4],lap2.sd[,3,4],mcmc1.sd[,3,4],mcmc1.sd[,3,4])
SD_ig_G_4 <- cbind(lap1.sd[,3,3],lap2.sd[,3,3],mcmc1.sd[,3,3],mcmc1.sd[,3,3])
SD_ig_G_5
SD_ig_G_4 <- cbind(lap1.sd[,3,3],lap2.sd[,3,3],mcmc1.sd[,3,3],mcmc1.sd[,3,3])
SD_ig_G_5 <- cbind(lap1.sd[,3,4],lap2.sd[,3,4],mcmc1.sd[,3,4],mcmc1.sd[,3,4])
SD_ig_E_4 <- cbind(lap1.sd[,3,1],lap2.sd[,3,1],mcmc1.sd[,3,1],mcmc1.sd[,3,1])
SD_ig_E_5 <- cbind(lap1.sd[,3,2],lap2.sd[,3,2],mcmc1.sd[,3,2],mcmc1.sd[,3,2])
SD_ig_G_5
SD_ig_E_5
SD_ig_G_4 <- cbind(lap1.sd[,3,3],lap2.sd[,3,3],mcmc1.sd[,3,3],mcmc2.sd[,3,3])
SD_ig_G_5 <- cbind(lap1.sd[,3,4],lap2.sd[,3,4],mcmc1.sd[,3,4],mcmc2.sd[,3,4])
SD_ig_E_4 <- cbind(lap1.sd[,3,1],lap2.sd[,3,1],mcmc1.sd[,3,1],mcmc2.sd[,3,1])
SD_ig_E_5 <- cbind(lap1.sd[,3,2],lap2.sd[,3,2],mcmc1.sd[,3,2],mcmc2.sd[,3,2])
HB_ig_G_4 <- cbind(lap1.h[,3,3],lap2.h[,3,3],mcmc1.h[,3,3],mcmc2.h[,3,3])
HB_ig_G_5 <- cbind(lap1.h[,3,4],lap2.h[,3,4],mcmc1.h[,3,4],mcmc2.h[,3,4])
HB_ig_E_4 <- cbind(lap1.h[,3,1],lap2.h[,3,1],mcmc1.h[,3,1],mcmc2.h[,3,1])
HB_ig_E_5 <- cbind(lap1.h[,3,2],lap2.h[,3,2],mcmc1.h[,3,2],mcmc2.h[,3,2])
HB_ig_E_4
xtable(cbind(SD_ig_E_5,SD_ig_G_5))
library(xtable)
xtable(cbind(SD_ig_E_5,SD_ig_G_5))
SD_ig_G_4 <- cbind(lap1.sd[,3,3],lap2.sd[,3,3],mcmc1.sd[,3,3],mcmc2.sd[,3,3])*100
SD_ig_G_5 <- cbind(lap1.sd[,3,4],lap2.sd[,3,4],mcmc1.sd[,3,4],mcmc2.sd[,3,4])*100
SD_ig_E_4 <- cbind(lap1.sd[,3,1],lap2.sd[,3,1],mcmc1.sd[,3,1],mcmc2.sd[,3,1])*100
SD_ig_E_5 <- cbind(lap1.sd[,3,2],lap2.sd[,3,2],mcmc1.sd[,3,2],mcmc2.sd[,3,2])*100
xtable(cbind(SD_ig_E_5,SD_ig_G_5))
?xtable
xtable(cbind(SD_ig_E_5,SD_ig_G_5),display = "%f2.1\%")
xtable(cbind(SD_ig_E_5,SD_ig_G_5),display = "%f2.1%")
xtable(cbind(SD_ig_E_5,SD_ig_G_5),display = "f", digits = 2)
xtable(cbind(SD_ig_E_5,SD_ig_G_5), digits = 2)
xtable(cbind(SD_ig_E_5,SD_ig_G_5), digits = 1)
xtable(cbind(HB_ig_E_5,HB_ig_G_5), digits = 1)
HB_ig_G_4 <- cbind(lap1.h[,3,3],lap2.h[,3,3],mcmc1.h[,3,3],mcmc2.h[,3,3])*100
HB_ig_G_5 <- cbind(lap1.h[,3,4],lap2.h[,3,4],mcmc1.h[,3,4],mcmc2.h[,3,4])*100
HB_ig_E_4 <- cbind(lap1.h[,3,1],lap2.h[,3,1],mcmc1.h[,3,1],mcmc2.h[,3,1])*100
HB_ig_E_5 <- cbind(lap1.h[,3,2],lap2.h[,3,2],mcmc1.h[,3,2],mcmc2.h[,3,2])*100
xtable(cbind(HB_ig_E_5,HB_ig_G_5), digits = 1)
setwd("~/Documents/r_software/RBMDS/Simulation/Exp/results")
setwd("~/Documents/r_software/RBMDS/Simulation/EXP/results")
setwd("~/Documents/r_software/RBMDS/Simulation/Exp-5")
BMD.H  <- matrix(bmds.H,nrow=8,ncol=3,byrow=T)
BMD.SD <- matrix(bmds.SD,nrow=8,ncol=3,byrow=T)
setwd("~/Documents/r_software/RBMDS/Simulation/Exp-5/results")
files <- dir()
ivgSims = grepl("invGaussian",files)
norSims = grepl("normal",files)
lnorSims = grepl("lognormal",files)
cond1 = grepl("sim_1",files)
cond2 = grepl("sim_2",files)
cond3 = grepl("sim_3",files)
cond4 = grepl("sim_4",files)
cond5 = grepl("sim_5",files)
cond6 = grepl("sim_6",files)
cond7 = grepl("sim_7",files)
cond8 = !(cond1 | cond2 | cond3 | cond4 | cond5 | cond6 | cond7)
is_geom = grepl("_g_",files)
is_4    = grepl("_4_",files)
lap1.sd <- array(NA,c(8,3,4))
lap2.sd <- array(NA,c(8,3,4))
mcmc1.sd <- array(NA,c(8,3,4))
mcmc2.sd <- array(NA,c(8,3,4))
lap1.h <- array(NA,c(8,3,4))
lap2.h <- array(NA,c(8,3,4))
mcmc1.h <- array(NA,c(8,3,4))
mcmc2.h <- array(NA,c(8,3,4))
for (ii in 1:length(files)){
load(files[ii])
simtype = 1
if (lnorSims[ii] == TRUE){
simtype = 2
}
if (ivgSims[ii] == TRUE){
simtype = 3
}
even = 1
if (is_geom[ii] == TRUE){
even = 3
}
if (!is_4[ii] == TRUE){ # for 5 dose groups
even = even + 1
}
#simulation condition
scond = which(c(cond1[ii],cond2[ii],cond3[ii],cond4[ii],cond5[ii],cond6[ii],cond7[ii],cond8[ii]))
true_BMD.h  = BMD.H[scond,simtype]
true_BMD.sd = BMD.SD[scond,simtype]
lap1.sd[scond,simtype,even]  = mean(BMD_result_SD_ML1_lapl[,2] < true_BMD.sd,na.rm=TRUE)
lap2.sd[scond,simtype,even]  = mean(BMD_result_SD_ML2_lapl[,2] < true_BMD.sd,na.rm=TRUE)
mcmc1.sd[scond,simtype,even] = mean(BMD_result_SD_ML1_mcmc[,2]  < true_BMD.sd,na.rm=TRUE)
mcmc2.sd[scond,simtype,even] = mean(BMD_result_SD_ML2_mcmc[,2]  < true_BMD.sd,na.rm=TRUE)
lap1.h[scond,simtype,even]   = mean(BMD_result_HB_ML1_lapl[,2] < true_BMD.h,na.rm=TRUE)
lap2.h[scond,simtype,even]   = mean(BMD_result_HB_ML2_lapl[,2] < true_BMD.h,na.rm=TRUE)
mcmc1.h[scond,simtype,even]  = mean(BMD_result_HB_ML1_mcmc[,2]  < true_BMD.h,na.rm=TRUE)
mcmc2.h[scond,simtype,even]  = mean(BMD_result_HB_ML2_mcmc[,2]  < true_BMD.h,na.rm=TRUE)
}
library(xtable)
SD_ig_G_4 <- cbind(lap1.sd[,3,3],lap2.sd[,3,3],mcmc1.sd[,3,3],mcmc2.sd[,3,3])*100
SD_ig_G_5 <- cbind(lap1.sd[,3,4],lap2.sd[,3,4],mcmc1.sd[,3,4],mcmc2.sd[,3,4])*100
SD_ig_E_4 <- cbind(lap1.sd[,3,1],lap2.sd[,3,1],mcmc1.sd[,3,1],mcmc2.sd[,3,1])*100
SD_ig_E_5 <- cbind(lap1.sd[,3,2],lap2.sd[,3,2],mcmc1.sd[,3,2],mcmc2.sd[,3,2])*100
xtable(cbind(SD_ig_E_5,SD_ig_G_5), digits = 1)
xtable(cbind(HB_ig_E_5,HB_ig_G_5), digits = 1)
load("~/Documents/r_software/RBMDS/Simulation/Exp-5/Exp-5_invGaussian_g_5_sim_7.Rdata")
plot(doses,sim_data[1,])
load("~/Documents/r_software/RBMDS/Simulation/Exp-5/Exp-5_invGaussian_e_5_sim_3.Rdata")
plot(doses,sim_data[1,])
