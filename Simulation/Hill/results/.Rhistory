full_mcmc_sd   <- ma_continuous_fit(as.matrix(cma_analysis$dose),as.matrix(cma_analysis$alt),model_list=model_list_full, fit_type = "mcmc",BMD_TYPE =   'sd',BMR = 1,samples = 75000)
full_laplace_sd <- ma_continuous_fit(as.matrix(cma_analysis$dose),as.matrix(cma_analysis$alt),model_list=model_list_full, fit_type = "laplace",BMD_TYPE = 'sd',BMR = 1,samples = 75000)
full_mcmc_hb   <- ma_continuous_fit(as.matrix(cma_analysis$dose),as.matrix(cma_analysis$alt),model_list=model_list_full, fit_type = "mcmc",BMD_TYPE =   'hybrid',BMR = 0.05, point_p = 0.025, samples = 75000)
full_laplace_hb <- ma_continuous_fit(as.matrix(cma_analysis$dose),as.matrix(cma_analysis$alt),model_list=model_list_full, fit_type = "laplace",BMD_TYPE = 'hybrid',BMR = 0.05, point_p = 0.025, samples = 75000)
print(full_laplace_sd$bmd)
print(full_mcmc_sd$bmd)
plot(full_mcmc_sd)#,axes = F,xlab = "Dimethylformamide (ppm)",ylab = "Cholesterol (mg/dL)")
#axis(1,at = seq(0,800,200))
#axis(2,at = seq(75,175,10))
plot(full_laplace_hb,axes = F,xlab = "Dimethylformamide (ppm)",ylab = "Cholesterol (mg/dL)")
#axis(1,at = seq(0,800,200))
#axis(2,at = seq(75,175,10))
class_list <- names(full_laplace_hb)
fit_idx    <- grep("Individual_Model",class_list)
model_name <- NA
bmd_sd_laplace <- NA
bmd_sd_mcmc <- NA
bmd_hb_laplace <- NA
bmd_hb_mcmc <- NA
for (ii in 1:length(fit_idx)){
mcmc_ld  <- full_mcmc_sd[[fit_idx[ii]]]
mcmc_ld2 <- full_laplace_sd[[fit_idx[ii]]]
mcmc_hd <- full_mcmc_hb[[fit_idx[ii]]]
mcmc_hd2 <- full_laplace_hb[[fit_idx[ii]]]
if (is.na(model_name[1])){
model_name <- mcmc_ld$fitted_model$full_model
bmd_sd_laplace <- sprintf("%1.1f (%1.1f, %1.1f)",mcmc_ld$bmd[1],mcmc_ld$bmd[2],mcmc_ld$bmd[3])
bmd_sd_mcmc <-    sprintf("%1.1f (%1.1f, %1.1f)",mcmc_ld2$bmd[1],mcmc_ld2$bmd[2],mcmc_ld2$bmd[3])
bmd_hb_laplace <- sprintf("%1.1f (%1.1f, %1.1f)",mcmc_hd$bmd[1],mcmc_hd$bmd[2],mcmc_hd$bmd[3])
bmd_hb_mcmc <-    sprintf("%1.1f (%1.1f, %1.1f)",mcmc_hd2$bmd[1],mcmc_hd2$bmd[2],mcmc_hd2$bmd[3])
}else{
model_name <- c(model_name,mcmc_ld$fitted_model$full_model)
bmd_sd_laplace <- c(bmd_sd_laplace,sprintf("%1.1f (%1.1f, %1.1f)",mcmc_ld$bmd[1],mcmc_ld$bmd[2],mcmc_ld$bmd[3]))
bmd_sd_mcmc <-    c(bmd_sd_mcmc,sprintf("%1.1f (%1.1f, %1.1f)",mcmc_ld2$bmd[1],mcmc_ld2$bmd[2],mcmc_ld2$bmd[3]))
bmd_hb_laplace <- c(bmd_hb_laplace,sprintf("%1.1f (%1.1f, %1.1f)",mcmc_hd$bmd[1],mcmc_hd$bmd[2],mcmc_hd$bmd[3]))
bmd_hb_mcmc <-    c(bmd_hb_mcmc,sprintf("%1.1f (%1.1f, %1.1f)",mcmc_hd2$bmd[1],mcmc_hd2$bmd[2],mcmc_hd2$bmd[3]))
}
}
table <- data.frame(probs = sprintf("%1.2f %%",100*full_mcmc_hb$posterior_probs), BMD1 = bmd_sd_laplace,
BMD2 = bmd_sd_mcmc,BMD3 = bmd_hb_laplace,BMD4 = bmd_hb_mcmc)
colnames(table) <- c("Posterior Probability", "Laplace-SD","MCMC-SD","Laplace-Hybrid","Laplace-Hybrid")
rownames(table) <- model_name
knitr::kable(table, format = "html")
xtable(table[,1:3], hline.after = TRUE,
include.colnames = TRUE,
command = c('\\toprule[1.5pt]\n', '\\midrule[1pt]\n', '\\bottomrule[1.5pt]\n'))
table <- data.frame(probs = sprintf("%1.2f %%",100*full_mcmc_hb$posterior_probs), BMD1 = bmd_hb_laplace,
BMD2 = bmd_hb_mcmc,BMD3 = bmd_hb_laplace,BMD4 = bmd_hb_mcmc)
colnames(table) <- c("Posterior Probability", "Laplace-SD","MCMC-SD","Laplace-Hybrid","Laplace-Hybrid")
rownames(table) <- model_name
knitr::kable(table, format = "html")
xtable(table[,1:3], hline.after = TRUE,
include.colnames = TRUE,
command = c('\\toprule[1.5pt]\n', '\\midrule[1pt]\n', '\\bottomrule[1.5pt]\n'))
full_mcmc_hb$bmd
full_laplace_hb$bmd
bmds.H <- c(70.97,	72.03,	66.76,
16.06,	16.41,	14.8,
6.93,	6.49,	7.54,
22.15,	20.99,	23.74)
bmds.SD <- c(88.55,	88.55,	88.55,
26.5,	26.5,	26.5,
17.12,	17.14,	17.12,
48.49,	48.54,	48.49)
BMD.H  <- matrix(bmds.H,nrow=4,ncol=3,byrow=T)
BMD.SD <- matrix(bmds.SD,nrow=4,ncol=3,byrow=T)
setwd("~/Documents/r_software/RBMDS/Simulation/Non-Parametric/results")
ivgSims = grepl("invGaussian",files)
norSims = grepl("normal",files)
lnorSims = grepl("lognormal",files)
cond1 = grepl("sim_1",files)
cond2 = grepl("sim_2",files)
cond3 = grepl("sim_3",files)
cond4 = !(cond1 | cond2 | cond3)
is_geom = grepl("_g_",files)
is_4    = grepl("_4_",files)
lap1.sd <- array(NA,c(4,3,4))
lap2.sd <- array(NA,c(4,3,4))
mcmc1.sd <- array(NA,c(4,3,4))
mcmc2.sd <- array(NA,c(4,3,4))
lap1.h <- array(NA,c(4,3,4))
lap2.h <- array(NA,c(4,3,4))
mcmc1.h <- array(NA,c(4,3,4))
mcmc2.h <- array(NA,c(4,3,4))
for (ii in 1:length(files)){
load(files[ii])
simtype = 1
if (lnorSims[ii] == TRUE){
simtype = 2
}
if (ivgSims[ii] == TRUE){
simtype = 3
}
even = 1
if (is_geom[ii] == TRUE){
even = 3
}
if (!is_4[ii] == TRUE){ # for 5 dose groups
even = even + 1
}
#simulation condition
scond = which(c(cond1[ii],cond2[ii],cond3[ii],cond4[ii]))
true_BMD.h  = BMD.H[scond,simtype]
true_BMD.sd = BMD.SD[scond,simtype]
lap1.sd[scond,simtype,even]  = mean(BMD_result_SD_ML1_lapl[,2] < true_BMD.sd,na.rm=TRUE)
lap2.sd[scond,simtype,even]  = mean(BMD_result_SD_ML2_lapl[,2] < true_BMD.sd,na.rm=TRUE)
mcmc1.sd[scond,simtype,even] = mean(BMD_result_SD_ML1_mcmc[,2]  < true_BMD.sd,na.rm=TRUE)
mcmc2.sd[scond,simtype,even] = mean(BMD_result_SD_ML2_mcmc[,2]  < true_BMD.sd,na.rm=TRUE)
lap1.h[scond,simtype,even]   = mean(BMD_result_HB_ML1_lapl[,2] < true_BMD.h,na.rm=TRUE)
lap2.h[scond,simtype,even]   = mean(BMD_result_HB_ML2_lapl[,2] < true_BMD.h,na.rm=TRUE)
mcmc1.h[scond,simtype,even]  = mean(BMD_result_HB_ML1_mcmc[,2]  < true_BMD.h,na.rm=TRUE)
mcmc2.h[scond,simtype,even]  = mean(BMD_result_HB_ML2_mcmc[,2]  < true_BMD.h,na.rm=TRUE)
}
library(xtable)
SD_no_G_4 <- cbind(lap1.sd[,1,3],lap2.sd[,1,3],mcmc1.sd[,1,3],mcmc2.sd[,1,3])*100
SD_no_G_5 <- cbind(lap1.sd[,1,4],lap2.sd[,1,4],mcmc1.sd[,1,4],mcmc2.sd[,1,4])*100
SD_no_E_4 <- cbind(lap1.sd[,1,1],lap2.sd[,1,1],mcmc1.sd[,1,1],mcmc2.sd[,1,1])*100
SD_no_E_5 <- cbind(lap1.sd[,1,2],lap2.sd[,1,2],mcmc1.sd[,1,2],mcmc2.sd[,1,2])*100
SD_lno_G_4 <- cbind(lap1.sd[,2,3],lap2.sd[,2,3],mcmc1.sd[,2,3],mcmc2.sd[,2,3])*100
SD_lno_G_5 <- cbind(lap1.sd[,2,4],lap2.sd[,2,4],mcmc1.sd[,2,4],mcmc2.sd[,2,4])*100
SD_lno_E_4 <- cbind(lap1.sd[,2,1],lap2.sd[,2,1],mcmc1.sd[,2,1],mcmc2.sd[,2,1])*100
SD_lno_E_5 <- cbind(lap1.sd[,2,2],lap2.sd[,2,2],mcmc1.sd[,2,2],mcmc2.sd[,2,2])*100
SD_ig_G_4 <- cbind(lap1.sd[,3,3],lap2.sd[,3,3],mcmc1.sd[,3,3],mcmc2.sd[,3,3])*100
SD_ig_G_5 <- cbind(lap1.sd[,3,4],lap2.sd[,3,4],mcmc1.sd[,3,4],mcmc2.sd[,3,4])*100
SD_ig_E_4 <- cbind(lap1.sd[,3,1],lap2.sd[,3,1],mcmc1.sd[,3,1],mcmc2.sd[,3,1])*100
SD_ig_E_5 <- cbind(lap1.sd[,3,2],lap2.sd[,3,2],mcmc1.sd[,3,2],mcmc2.sd[,3,2])*100
temp = cbind(SD_no_E_4,SD_no_G_4)
rownames(temp) <- c("Dose Response 1","Dose Response 2","Dose Response 3","Dose Response 4")
xtable(temp, digits = 1)
temp = cbind(SD_no_E_5,SD_no_G_5)
rownames(temp) <- c("Dose Response 1","Dose Response 2","Dose Response 3","Dose Response 4")
xtable(temp, digits = 1)
temp = cbind(SD_lno_E_4,SD_no_G_4)
rownames(temp) <- c("Dose Response 1","Dose Response 2","Dose Response 3","Dose Response 4")
xtable(temp, digits = 1)
temp = cbind(SD_lno_E_5,SD_no_G_5)
rownames(temp) <- c("Dose Response 1","Dose Response 2","Dose Response 3","Dose Response 4")
xtable(temp, digits = 1)
temp = cbind(SD_ig_E_4,SD_no_G_4)
rownames(temp) <- c("Dose Response 1","Dose Response 2","Dose Response 3","Dose Response 4")
xtable(temp, digits = 1)
temp = cbind(SD_ig_E_5,SD_no_G_5)
rownames(temp) <- c("Dose Response 1","Dose Response 2","Dose Response 3","Dose Response 4")
xtable(temp, digits = 1)
bmds.H <- c(70.97,	72.03,	66.76,
16.06,	16.41,	14.8,
6.93,	6.49,	7.54,
22.15,	20.99,	23.74)
bmds.SD <- c(88.55,	88.55,	88.55,
26.5,	26.5,	26.5,
17.12,	17.14,	17.12,
48.49,	48.54,	48.49)
BMD.H  <- matrix(bmds.H,nrow=4,ncol=3,byrow=T)
BMD.SD <- matrix(bmds.SD,nrow=4,ncol=3,byrow=T)
setwd("~/Documents/r_software/RBMDS/Simulation/Non-Parametric/results")
files <- dir()
ivgSims = grepl("invGaussian",files)
norSims = grepl("normal",files)
lnorSims = grepl("lognormal",files)
cond1 = grepl("sim_1",files)
cond2 = grepl("sim_2",files)
cond3 = grepl("sim_3",files)
cond4 = !(cond1 | cond2 | cond3)
is_geom = grepl("_g_",files)
is_4    = grepl("_4_",files)
lap1.sd <- array(NA,c(4,3,4))
lap2.sd <- array(NA,c(4,3,4))
mcmc1.sd <- array(NA,c(4,3,4))
mcmc2.sd <- array(NA,c(4,3,4))
lap1.h <- array(NA,c(4,3,4))
lap2.h <- array(NA,c(4,3,4))
mcmc1.h <- array(NA,c(4,3,4))
mcmc2.h <- array(NA,c(4,3,4))
for (ii in 1:length(files)){
load(files[ii])
simtype = 1
if (lnorSims[ii] == TRUE){
simtype = 2
}
if (ivgSims[ii] == TRUE){
simtype = 3
}
even = 1
if (is_geom[ii] == TRUE){
even = 3
}
if (!is_4[ii] == TRUE){ # for 5 dose groups
even = even + 1
}
#simulation condition
scond = which(c(cond1[ii],cond2[ii],cond3[ii],cond4[ii]))
true_BMD.h  = BMD.H[scond,simtype]
true_BMD.sd = BMD.SD[scond,simtype]
lap1.sd[scond,simtype,even]  = mean(BMD_result_SD_ML1_lapl[,2] < true_BMD.sd,na.rm=TRUE)
lap2.sd[scond,simtype,even]  = mean(BMD_result_SD_ML2_lapl[,2] < true_BMD.sd,na.rm=TRUE)
mcmc1.sd[scond,simtype,even] = mean(BMD_result_SD_ML1_mcmc[,2]  < true_BMD.sd,na.rm=TRUE)
mcmc2.sd[scond,simtype,even] = mean(BMD_result_SD_ML2_mcmc[,2]  < true_BMD.sd,na.rm=TRUE)
lap1.h[scond,simtype,even]   = mean(BMD_result_HB_ML1_lapl[,2] < true_BMD.h,na.rm=TRUE)
lap2.h[scond,simtype,even]   = mean(BMD_result_HB_ML2_lapl[,2] < true_BMD.h,na.rm=TRUE)
mcmc1.h[scond,simtype,even]  = mean(BMD_result_HB_ML1_mcmc[,2]  < true_BMD.h,na.rm=TRUE)
mcmc2.h[scond,simtype,even]  = mean(BMD_result_HB_ML2_mcmc[,2]  < true_BMD.h,na.rm=TRUE)
}
library(xtable)
SD_no_G_4 <- cbind(lap1.sd[,1,3],lap2.sd[,1,3],mcmc1.sd[,1,3],mcmc2.sd[,1,3])*100
SD_no_G_5 <- cbind(lap1.sd[,1,4],lap2.sd[,1,4],mcmc1.sd[,1,4],mcmc2.sd[,1,4])*100
SD_no_E_4 <- cbind(lap1.sd[,1,1],lap2.sd[,1,1],mcmc1.sd[,1,1],mcmc2.sd[,1,1])*100
SD_no_E_5 <- cbind(lap1.sd[,1,2],lap2.sd[,1,2],mcmc1.sd[,1,2],mcmc2.sd[,1,2])*100
SD_lno_G_4 <- cbind(lap1.sd[,2,3],lap2.sd[,2,3],mcmc1.sd[,2,3],mcmc2.sd[,2,3])*100
SD_lno_G_5 <- cbind(lap1.sd[,2,4],lap2.sd[,2,4],mcmc1.sd[,2,4],mcmc2.sd[,2,4])*100
SD_lno_E_4 <- cbind(lap1.sd[,2,1],lap2.sd[,2,1],mcmc1.sd[,2,1],mcmc2.sd[,2,1])*100
SD_lno_E_5 <- cbind(lap1.sd[,2,2],lap2.sd[,2,2],mcmc1.sd[,2,2],mcmc2.sd[,2,2])*100
SD_ig_G_4 <- cbind(lap1.sd[,3,3],lap2.sd[,3,3],mcmc1.sd[,3,3],mcmc2.sd[,3,3])*100
SD_ig_G_5 <- cbind(lap1.sd[,3,4],lap2.sd[,3,4],mcmc1.sd[,3,4],mcmc2.sd[,3,4])*100
SD_ig_E_4 <- cbind(lap1.sd[,3,1],lap2.sd[,3,1],mcmc1.sd[,3,1],mcmc2.sd[,3,1])*100
SD_ig_E_5 <- cbind(lap1.sd[,3,2],lap2.sd[,3,2],mcmc1.sd[,3,2],mcmc2.sd[,3,2])*100
temp = cbind(SD_no_E_4,SD_no_G_4)
rownames(temp) <- c("Dose Response 1","Dose Response 2","Dose Response 3","Dose Response 4")
xtable(temp, digits = 1)
temp = cbind(SD_no_E_5,SD_no_G_5)
rownames(temp) <- c("Dose Response 1","Dose Response 2","Dose Response 3","Dose Response 4")
xtable(temp, digits = 1)
temp = cbind(SD_lno_E_4,SD_no_G_4)
rownames(temp) <- c("Dose Response 1","Dose Response 2","Dose Response 3","Dose Response 4")
xtable(temp, digits = 1)
temp = cbind(SD_lno_E_5,SD_no_G_5)
rownames(temp) <- c("Dose Response 1","Dose Response 2","Dose Response 3","Dose Response 4")
xtable(temp, digits = 1)
temp = cbind(SD_ig_E_4,SD_no_G_4)
rownames(temp) <- c("Dose Response 1","Dose Response 2","Dose Response 3","Dose Response 4")
xtable(temp, digits = 1)
temp = cbind(SD_ig_E_5,SD_no_G_5)
rownames(temp) <- c("Dose Response 1","Dose Response 2","Dose Response 3","Dose Response 4")
xtable(temp, digits = 1)
temp = cbind(SD_no_E_5,SD_no_G_5)
rownames(temp) <- c("Dose Response 1","Dose Response 2","Dose Response 3","Dose Response 4")
xtable(temp, digits = 1)
temp = cbind(SD_lno_E_5,SD_no_G_5)
rownames(temp) <- c("Dose Response 1","Dose Response 2","Dose Response 3","Dose Response 4")
xtable(temp, digits = 1)
temp = cbind(SD_ig_E_5,SD_no_G_5)
rownames(temp) <- c("Dose Response 1","Dose Response 2","Dose Response 3","Dose Response 4")
xtable(temp, digits = 1)
HB_no_G_4 <- cbind(lap1.h[,1,3],lap2.h[,1,3],mcmc1.h[,1,3],mcmc2.h[,1,3])*100
HB_no_G_5 <- cbind(lap1.h[,1,4],lap2.h[,1,4],mcmc1.h[,1,4],mcmc2.h[,1,4])*100
HB_no_E_4 <- cbind(lap1.h[,1,1],lap2.h[,1,1],mcmc1.h[,1,1],mcmc2.h[,1,1])*100
HB_no_E_5 <- cbind(lap1.h[,1,2],lap2.h[,1,2],mcmc1.h[,1,2],mcmc2.h[,1,2])*100
HB_lno_G_4 <- cbind(lap1.h[,2,3],lap2.h[,2,3],mcmc1.h[,2,3],mcmc2.h[,2,3])*100
HB_lno_G_5 <- cbind(lap1.h[,2,4],lap2.h[,2,4],mcmc1.h[,2,4],mcmc2.h[,2,4])*100
HB_lno_E_4 <- cbind(lap1.h[,2,1],lap2.h[,2,1],mcmc1.h[,2,1],mcmc2.h[,2,1])*100
HB_lno_E_5 <- cbind(lap1.h[,2,2],lap2.h[,2,2],mcmc1.h[,2,2],mcmc2.h[,2,2])*100
HB_ig_G_4 <- cbind(lap1.h[,3,3],lap2.h[,3,3],mcmc1.h[,3,3],mcmc2.h[,3,3])*100
HB_ig_G_5 <- cbind(lap1.h[,3,4],lap2.h[,3,4],mcmc1.h[,3,4],mcmc2.h[,3,4])*100
HB_ig_E_4 <- cbind(lap1.h[,3,1],lap2.h[,3,1],mcmc1.h[,3,1],mcmc2.h[,3,1])*100
HB_ig_E_5 <- cbind(lap1.h[,3,2],lap2.h[,3,2],mcmc1.h[,3,2],mcmc2.h[,3,2])*100
temp = cbind(HB_no_E_5,HB_no_G_5)
rownames(temp) <- c("Dose Response 1","Dose Response 2","Dose Response 3","Dose Response 4")
xtable(temp, digits = 1)
temp = cbind(HB_lno_E_5,HB_no_G_5)
rownames(temp) <- c("Dose Response 1","Dose Response 2","Dose Response 3","Dose Response 4")
xtable(temp, digits = 1)
temp = cbind(HB_ig_E_5,HB_no_G_5)
rownames(temp) <- c("Dose Response 1","Dose Response 2","Dose Response 3","Dose Response 4")
xtable(temp, digits = 1)
bmds.H <- c(70.97,	72.03,	66.76,
16.06,	16.41,	14.8,
6.93,	6.49,	7.54,
22.15,	20.99,	23.74)
bmds.SD <- c(88.55,	88.55,	88.55,
26.5,	26.5,	26.5,
17.12,	17.14,	17.12,
48.49,	48.54,	48.49)
BMD.H  <- matrix(bmds.H,nrow=4,ncol=3,byrow=T)
BMD.SD <- matrix(bmds.SD,nrow=4,ncol=3,byrow=T)
setwd("~/Documents/r_software/RBMDS/Simulation/Non-Parametric/results")
files <- dir()
ivgSims = grepl("invGaussian",files)
norSims = grepl("normal",files)
lnorSims = grepl("lognormal",files)
cond1 = grepl("sim_1",files)
cond2 = grepl("sim_2",files)
cond3 = grepl("sim_3",files)
cond4 = !(cond1 | cond2 | cond3)
is_geom = grepl("_g_",files)
is_4    = grepl("_4_",files)
lap1.sd <- array(NA,c(4,3,4))
lap2.sd <- array(NA,c(4,3,4))
mcmc1.sd <- array(NA,c(4,3,4))
mcmc2.sd <- array(NA,c(4,3,4))
lap1.h <- array(NA,c(4,3,4))
lap2.h <- array(NA,c(4,3,4))
mcmc1.h <- array(NA,c(4,3,4))
mcmc2.h <- array(NA,c(4,3,4))
for (ii in 1:length(files)){
load(files[ii])
simtype = 1
if (lnorSims[ii] == TRUE){
simtype = 2
}
if (ivgSims[ii] == TRUE){
simtype = 3
}
even = 1
if (is_geom[ii] == TRUE){
even = 3
}
if (!is_4[ii] == TRUE){ # for 5 dose groups
even = even + 1
}
#simulation condition
scond = which(c(cond1[ii],cond2[ii],cond3[ii],cond4[ii]))
true_BMD.h  = BMD.H[scond,simtype]
true_BMD.sd = BMD.SD[scond,simtype]
lap1.sd[scond,simtype,even]  = mean(BMD_result_SD_ML1_lapl[,2] < true_BMD.sd,na.rm=TRUE)
lap2.sd[scond,simtype,even]  = mean(BMD_result_SD_ML2_lapl[,2] < true_BMD.sd,na.rm=TRUE)
mcmc1.sd[scond,simtype,even] = mean(BMD_result_SD_ML1_mcmc[,2]  < true_BMD.sd,na.rm=TRUE)
mcmc2.sd[scond,simtype,even] = mean(BMD_result_SD_ML2_mcmc[,2]  < true_BMD.sd,na.rm=TRUE)
lap1.h[scond,simtype,even]   = mean(BMD_result_HB_ML1_lapl[,2] < true_BMD.h,na.rm=TRUE)
lap2.h[scond,simtype,even]   = mean(BMD_result_HB_ML2_lapl[,2] < true_BMD.h,na.rm=TRUE)
mcmc1.h[scond,simtype,even]  = mean(BMD_result_HB_ML1_mcmc[,2]  < true_BMD.h,na.rm=TRUE)
mcmc2.h[scond,simtype,even]  = mean(BMD_result_HB_ML2_mcmc[,2]  < true_BMD.h,na.rm=TRUE)
}
library(xtable)
SD_no_G_4 <- cbind(lap1.sd[,1,3],lap2.sd[,1,3],mcmc1.sd[,1,3],mcmc2.sd[,1,3])*100
SD_no_G_5 <- cbind(lap1.sd[,1,4],lap2.sd[,1,4],mcmc1.sd[,1,4],mcmc2.sd[,1,4])*100
SD_no_E_4 <- cbind(lap1.sd[,1,1],lap2.sd[,1,1],mcmc1.sd[,1,1],mcmc2.sd[,1,1])*100
SD_no_E_5 <- cbind(lap1.sd[,1,2],lap2.sd[,1,2],mcmc1.sd[,1,2],mcmc2.sd[,1,2])*100
SD_lno_G_4 <- cbind(lap1.sd[,2,3],lap2.sd[,2,3],mcmc1.sd[,2,3],mcmc2.sd[,2,3])*100
SD_lno_G_5 <- cbind(lap1.sd[,2,4],lap2.sd[,2,4],mcmc1.sd[,2,4],mcmc2.sd[,2,4])*100
SD_lno_E_4 <- cbind(lap1.sd[,2,1],lap2.sd[,2,1],mcmc1.sd[,2,1],mcmc2.sd[,2,1])*100
SD_lno_E_5 <- cbind(lap1.sd[,2,2],lap2.sd[,2,2],mcmc1.sd[,2,2],mcmc2.sd[,2,2])*100
SD_ig_G_4 <- cbind(lap1.sd[,3,3],lap2.sd[,3,3],mcmc1.sd[,3,3],mcmc2.sd[,3,3])*100
SD_ig_G_5 <- cbind(lap1.sd[,3,4],lap2.sd[,3,4],mcmc1.sd[,3,4],mcmc2.sd[,3,4])*100
SD_ig_E_4 <- cbind(lap1.sd[,3,1],lap2.sd[,3,1],mcmc1.sd[,3,1],mcmc2.sd[,3,1])*100
SD_ig_E_5 <- cbind(lap1.sd[,3,2],lap2.sd[,3,2],mcmc1.sd[,3,2],mcmc2.sd[,3,2])*100
temp = cbind(SD_no_E_4,SD_no_G_4)
rownames(temp) <- c("Dose Response 1","Dose Response 2","Dose Response 3","Dose Response 4")
xtable(temp, digits = 1)
temp = cbind(SD_no_E_5,SD_no_G_5)
rownames(temp) <- c("Dose Response 1","Dose Response 2","Dose Response 3","Dose Response 4")
xtable(temp, digits = 1)
temp = cbind(SD_lno_E_4,SD_no_G_4)
rownames(temp) <- c("Dose Response 1","Dose Response 2","Dose Response 3","Dose Response 4")
xtable(temp, digits = 1)
temp = cbind(SD_lno_E_5,SD_no_G_5)
rownames(temp) <- c("Dose Response 1","Dose Response 2","Dose Response 3","Dose Response 4")
xtable(temp, digits = 1)
temp = cbind(SD_ig_E_4,SD_no_G_4)
rownames(temp) <- c("Dose Response 1","Dose Response 2","Dose Response 3","Dose Response 4")
xtable(temp, digits = 1)
temp = cbind(SD_ig_E_5,SD_no_G_5)
rownames(temp) <- c("Dose Response 1","Dose Response 2","Dose Response 3","Dose Response 4")
xtable(temp, digits = 1)
HB_no_G_4 <- cbind(lap1.h[,1,3],lap2.h[,1,3],mcmc1.h[,1,3],mcmc2.h[,1,3])*100
HB_no_G_5 <- cbind(lap1.h[,1,4],lap2.h[,1,4],mcmc1.h[,1,4],mcmc2.h[,1,4])*100
HB_no_E_4 <- cbind(lap1.h[,1,1],lap2.h[,1,1],mcmc1.h[,1,1],mcmc2.h[,1,1])*100
HB_no_E_5 <- cbind(lap1.h[,1,2],lap2.h[,1,2],mcmc1.h[,1,2],mcmc2.h[,1,2])*100
HB_lno_G_4 <- cbind(lap1.h[,2,3],lap2.h[,2,3],mcmc1.h[,2,3],mcmc2.h[,2,3])*100
HB_lno_G_5 <- cbind(lap1.h[,2,4],lap2.h[,2,4],mcmc1.h[,2,4],mcmc2.h[,2,4])*100
HB_lno_E_4 <- cbind(lap1.h[,2,1],lap2.h[,2,1],mcmc1.h[,2,1],mcmc2.h[,2,1])*100
HB_lno_E_5 <- cbind(lap1.h[,2,2],lap2.h[,2,2],mcmc1.h[,2,2],mcmc2.h[,2,2])*100
HB_ig_G_4 <- cbind(lap1.h[,3,3],lap2.h[,3,3],mcmc1.h[,3,3],mcmc2.h[,3,3])*100
HB_ig_G_5 <- cbind(lap1.h[,3,4],lap2.h[,3,4],mcmc1.h[,3,4],mcmc2.h[,3,4])*100
HB_ig_E_4 <- cbind(lap1.h[,3,1],lap2.h[,3,1],mcmc1.h[,3,1],mcmc2.h[,3,1])*100
HB_ig_E_5 <- cbind(lap1.h[,3,2],lap2.h[,3,2],mcmc1.h[,3,2],mcmc2.h[,3,2])*100
temp = cbind(HB_no_E_4,HB_no_G_4)
rownames(temp) <- c("Dose Response 1","Dose Response 2","Dose Response 3","Dose Response 4")
xtable(temp, digits = 1)
temp = cbind(HB_no_E_5,HB_no_G_5)
rownames(temp) <- c("Dose Response 1","Dose Response 2","Dose Response 3","Dose Response 4")
xtable(temp, digits = 1)
temp = cbind(HB_lno_E_4,HB_no_G_4)
rownames(temp) <- c("Dose Response 1","Dose Response 2","Dose Response 3","Dose Response 4")
xtable(temp, digits = 1)
temp = cbind(HB_lno_E_5,HB_no_G_5)
rownames(temp) <- c("Dose Response 1","Dose Response 2","Dose Response 3","Dose Response 4")
xtable(temp, digits = 1)
temp = cbind(HB_ig_E_4,HB_no_G_4)
rownames(temp) <- c("Dose Response 1","Dose Response 2","Dose Response 3","Dose Response 4")
xtable(temp, digits = 1)
temp = cbind(HB_ig_E_5,HB_no_G_5)
rownames(temp) <- c("Dose Response 1","Dose Response 2","Dose Response 3","Dose Response 4")
xtable(temp, digits = 1)
bmds.SD<- c(54.9,	54.91,	54.9,
21.59,	21.6,	21.59,
7.24,	7.25,	7.24,
40.92,	40.93,	40.92,
49.97,	49.97,	49.97,
16.87,	16.87,	16.87,
8.31,	8.31,	8.31,
37.23,	37.23,	37.23)
bmds.H <- c(41.49,	57.19,	42.61,
10.61,	23.94,	11.35,
3.13,	8.18,	3.39,
32.48,	42.32,	33.2,
40.08,	54.81,	38.9,
13.04,	18.79,	12.6,
5.65,	9.78,	5.37,
30.7,	40.37,	29.91)
BMD.H  <- matrix(bmds.H,nrow=8,ncol=3,byrow=T)
BMD.SD <- matrix(bmds.SD,nrow=8,ncol=3,byrow=T)
setwd("~/Documents/r_software/RBMDS/Simulation/Hill/results")
files <- dir()
ivgSims = grepl("invGaussian",files)
norSims = grepl("_normal",files)
lnorSims = grepl("lognormal",files)
cond1 = grepl("sim_1",files)
cond2 = grepl("sim_2",files)
cond3 = grepl("sim_3",files)
cond4 = grepl("sim_4",files)
cond5 = grepl("sim_5",files)
cond6 = grepl("sim_6",files)
cond7 = grepl("sim_7",files)
cond8 = !(cond1 | cond2 | cond3 | cond4 | cond5 | cond6 | cond7)
is_geom = grepl("_g_",files)
is_4    = grepl("_4_",files)
lap1.sd <- array(NA,c(8,3,4))
lap2.sd <- array(NA,c(8,3,4))
mcmc1.sd <- array(NA,c(8,3,4))
mcmc2.sd <- array(NA,c(8,3,4))
lap1.h <- array(NA,c(8,3,4))
lap2.h <- array(NA,c(8,3,4))
mcmc1.h <- array(NA,c(8,3,4))
mcmc2.h <- array(NA,c(8,3,4))
for (ii in 1:length(files)){
load(files[ii])
simtype = 1
if (lnorSims[ii] == TRUE){
simtype = 2
}
if (ivgSims[ii] == TRUE){
simtype = 3
}
even = 1
if (is_geom[ii] == TRUE){
even = 3
}
if (!is_4[ii] == TRUE){ # for 5 dose groups
even = even + 1
}
#simulation condition
scond = which(c(cond1[ii],cond2[ii],cond3[ii],cond4[ii],cond5[ii],cond6[ii],cond7[ii],cond8[ii]))
true_BMD.h  = BMD.H[scond,simtype]
true_BMD.sd = BMD.SD[scond,simtype]
lap1.sd[scond,simtype,even]  = mean(BMD_result_SD_ML1_lapl[,2] < true_BMD.sd,na.rm=TRUE)
lap2.sd[scond,simtype,even]  = mean(BMD_result_SD_ML2_lapl[,2] < true_BMD.sd,na.rm=TRUE)
mcmc1.sd[scond,simtype,even] = mean(BMD_result_SD_ML1_mcmc[,2]  < true_BMD.sd,na.rm=TRUE)
mcmc2.sd[scond,simtype,even] = mean(BMD_result_SD_ML2_mcmc[,2]  < true_BMD.sd,na.rm=TRUE)
lap1.h[scond,simtype,even]   = mean(BMD_result_HB_ML1_lapl[,2] < true_BMD.h,na.rm=TRUE)
lap2.h[scond,simtype,even]   = mean(BMD_result_HB_ML2_lapl[,2] < true_BMD.h,na.rm=TRUE)
mcmc1.h[scond,simtype,even]  = mean(BMD_result_HB_ML1_mcmc[,2]  < true_BMD.h,na.rm=TRUE)
mcmc2.h[scond,simtype,even]  = mean(BMD_result_HB_ML2_mcmc[,2]  < true_BMD.h,na.rm=TRUE)
}
library(xtable)
SD_no_G_4 <- cbind(lap1.sd[,1,3],lap2.sd[,1,3],mcmc1.sd[,1,3],mcmc2.sd[,1,3])*100
SD_no_G_5 <- cbind(lap1.sd[,1,4],lap2.sd[,1,4],mcmc1.sd[,1,4],mcmc2.sd[,1,4])*100
SD_no_E_4 <- cbind(lap1.sd[,1,1],lap2.sd[,1,1],mcmc1.sd[,1,1],mcmc2.sd[,1,1])*100
SD_no_E_5 <- cbind(lap1.sd[,1,2],lap2.sd[,1,2],mcmc1.sd[,1,2],mcmc2.sd[,1,2])*100
SD_lno_G_4 <- cbind(lap1.sd[,2,3],lap2.sd[,2,3],mcmc1.sd[,2,3],mcmc2.sd[,2,3])*100
SD_lno_G_5 <- cbind(lap1.sd[,2,4],lap2.sd[,2,4],mcmc1.sd[,2,4],mcmc2.sd[,2,4])*100
SD_lno_E_4 <- cbind(lap1.sd[,2,1],lap2.sd[,2,1],mcmc1.sd[,2,1],mcmc2.sd[,2,1])*100
SD_lno_E_5 <- cbind(lap1.sd[,2,2],lap2.sd[,2,2],mcmc1.sd[,2,2],mcmc2.sd[,2,2])*100
SD_ig_G_4 <- cbind(lap1.sd[,3,3],lap2.sd[,3,3],mcmc1.sd[,3,3],mcmc2.sd[,3,3])*100
SD_ig_G_5 <- cbind(lap1.sd[,3,4],lap2.sd[,3,4],mcmc1.sd[,3,4],mcmc2.sd[,3,4])*100
SD_ig_E_4 <- cbind(lap1.sd[,3,1],lap2.sd[,3,1],mcmc1.sd[,3,1],mcmc2.sd[,3,1])*100
SD_ig_E_5 <- cbind(lap1.sd[,3,2],lap2.sd[,3,2],mcmc1.sd[,3,2],mcmc2.sd[,3,2])*100
temp = cbind(SD_no_E_4,SD_no_G_4)
rownames(temp) <- c("Dose Response 1","Dose Response 2","Dose Response 3","Dose Response 4",
"Dose Response 5","Dose Response 6","Dose Response 7","Dose Response 8")
xtable(temp, digits = 1)
temp = cbind(SD_no_E_5,SD_no_G_5)
rownames(temp) <- c("Dose Response 1","Dose Response 2","Dose Response 3","Dose Response 4",
"Dose Response 5","Dose Response 6","Dose Response 7","Dose Response 8")
xtable(temp, digits = 1)
library(ToxicR)
library(ToxicR)
library(ToxicR)
temp_prior = create_prior_list(normprior(0,1,-18,18),
lnormprior(log(1.6),1,0,20),
lnormprior(0,1,0,20))
weib1  = create_dichotomous_prior(temp_prior,"weibull")
weibl
weib1
temp_prior = create_prior_list(normprior(0,1,-18,18),
lnormprior(log(1.6),1,0,20),
lnormprior(0,1,0,20))
weibl  = create_dichotomous_prior(temp_prior,"weibull")
weibl
logist = create_dichotomous_prior(temp_prior,"logistic")
temp_prior = create_prior_list(normprior(0,1,-18,18),
lnormprior(0,1,0,20))
logist = create_dichotomous_prior(temp_prior,"logistic")
logist
library(ToxicR)
temp_prior = create_prior_list(normprior(0,1,-18,18),
lnormprior(log(1.6),1,0,20),
lnormprior(0,1,0,20))
weibl  = create_dichotomous_prior(temp_prior,"weibull")
weibl
temp_prior = create_prior_list(normprior(0,1,-18,18),
lnormprior(0,1,0,20))
logist = create_dichotomous_prior(temp_prior,"logistic")
logist
temp_prior = create_prior_list(normprior(0,1,-18,18),
normprior(0,1,0,20),
lnormprior(0,1,0,18))
loglogist = create_dichotomous_prior(temp_prior,"log-logistic")
loglogistic
loglogist
models <- list(weibl,logist,loglogist)
source("~/.active-rstudio-document", echo=TRUE)
fit
plot(fit)
