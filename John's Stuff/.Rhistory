doses = seq(0,100,1)
require(gridExtra)
grid.arrange(my_plot, fy_plot, ncol=2)
library(ggplot2)
library(splines2)
library(ToxicR)
Hill.p <- rbind(c(481,-250.3,70,3.3),
c(481,-250.3,40,1.3),
c(481,-250.2,15,1.1),
c(481,-250.3,50,4) ,
c(10.58,9.7,70,3.5),
c(10.58,9.7,25,3),
c(10.58,9.7,15,2),
c(10.58,9.7,50,4))
hill <- data.frame(a=Hill.p[,1],b=Hill.p[,2],
c=Hill.p[,3],d=Hill.p[,4])
Exp5.p <- rbind(c(481,0.05,log(1/1.42870),2),
c(481,0.02,log(1/1.42870),2),
c(481,0.01,log(1/1.42870),2),
c(481,0.1,log(1/1.42870),2) ,
c(10.58,0.05,log(1.5),1.5),
c(10.58,0.02,log(1.5),1.5),
c(10.58,0.01,log(1.5),1.5),
c(10.58,0.1,log(1.5),1.5))
Exp5 <- data.frame(a=Exp5.p[,1],b=Exp5.p[,2],
c=Exp5.p[,3],d=Exp5.p[,4])
#log-transformed for fitting as in ToxicR use
beta1 <- c(0.15486274,0.14054532,0.05806702,0.67421470,0.18371405,0.92821744,1.60669594,1.04508522)
beta2 <- c(0.677816175,0.322787366,3.356424380,0.102841870,0.009085238,0.087907971,0.344255936,0.100000000)
#add 481 to get the background
beta3 <- c(-45.715480,-53.668821,-14.266726, -8.066441,-1.620326 ,-1.800000,-1.800000 ,-1.800000)
beta4 <- c(-11.9566632,-19.9908719,-39.3450020,-16.3895141,-2.8191037,-4.5801731,-0.834784,-0.7000000)
iSpline <- rbind(beta1,beta2,beta3,beta4)
iS <- data.frame(b1=iSpline[,1],b2=iSpline[,2],b3 = iSpline[,3],
b4=iSpline[,4],b5=iSpline[,5],b6 = iSpline[,6],
b7=iSpline[,7],b8=iSpline[,8])
row.names(iS) <- c("iSpline Simulation 1","iSpline Simulation 2",
"iSpline Simulation 3","iSpline Simulation 4")
doses = seq(0,100,1)
my_plot <- ggplot(data=data.frame(doses=doses), aes(x=doses))
d5y1 = cont_exp_5_f(Exp5.p[1,],doses)
d5y2 = cont_exp_5_f(Exp5.p[2,],doses)
d5y3 = cont_exp_5_f(Exp5.p[3,],doses)
d5y4 = cont_exp_5_f(Exp5.p[4,],doses)
dy1 = cont_hill_f(Hill.p[1,],doses)
dy2 = cont_hill_f(Hill.p[2,],doses)
dy3 = cont_hill_f(Hill.p[3,],doses)
dy4 = cont_hill_f(Hill.p[4,],doses)
X <- iSpline(doses,knots=seq(30,90,20))
dm1 <- X%*%t(iS[3,,drop=F]) + 481
dm2 <- X%*%t(iS[4,,drop=F]) + 481
my_plot <- ggplot(data=data.frame(doses=doses), aes(x=doses))
my_plot = my_plot + geom_line(aes(y=d5y1),linetype = 2,size=1.3,color = "#39568CFF") +
geom_line(aes(y=d5y2),linetype = 2,size=1.3,color = "#39568CFF") +
geom_line(aes(y=d5y3),linetype = 2,size=1.3,color = "#39568CFF") +
geom_line(aes(y=d5y4),linetype = 2,size=1.3,color = "#39568CFF") +
geom_line(aes(y=dy1),linetype = 3,size=1.3,color = "#55A667FF") +
geom_line(aes(y=dy2),linetype = 3,size=1.3,color = "#55A667FF") +
geom_line(aes(y=dy3),linetype = 3,size=1.3,color = "#55A667FF") +
geom_line(aes(y=dy4),linetype = 3,size=1.3,color = "#55A667FF") +
geom_line(aes(y=dm1),linetype = 4,size=1.3,color = "#CC6870FF") +
geom_line(aes(y=dm2),linetype = 4,size=1.3,color = "#CC6870FF") +
theme_light() + xlab("Dose") + ylab("Body Weight")
my_plot
iS <- data.frame(b1=iSpline[,1],b2=iSpline[,2],b3 = iSpline[,3],
b4=iSpline[,4],b5=iSpline[,5],b6 = iSpline[,6],
b7=iSpline[,7],b8=iSpline[,8])
row.names(iS) <- c("iSpline Simulation 1","iSpline Simulation 2",
"iSpline Simulation 3","iSpline Simulation 4")
doses = seq(0,100,1)
d5y1 = cont_exp_5_f(Exp5.p[5,],doses)
d5y2 = cont_exp_5_f(Exp5.p[6,],doses)
d5y3 = cont_exp_5_f(Exp5.p[7,],doses)
d5y4 = cont_exp_5_f(Exp5.p[8,],doses)
dy1 = cont_hill_f(Hill.p[5,],doses)
dy2 = cont_hill_f(Hill.p[6,],doses)
dy3 = cont_hill_f(Hill.p[7,],doses)
dy4 = cont_hill_f(Hill.p[8,],doses)
X <- iSpline(doses,knots=seq(30,90,20))
dm1 <- X%*%t(iS[1,,drop=F]) + 10.58
dm2 <- X%*%t(iS[2,,drop=F]) + 10.58
fy_plot <- ggplot(data=data.frame(doses=doses), aes(x=doses))
fy_plot = fy_plot + geom_line(aes(y=d5y1),linetype = 2,size=1.3,color = "#39568CFF") +
geom_line(aes(y=d5y2),linetype = 2,size=1.3,color = "#39568CFF") +
geom_line(aes(y=d5y3),linetype = 2,size=1.3,color = "#39568CFF") +
geom_line(aes(y=d5y4),linetype = 2,size=1.3,color = "#39568CFF") +
geom_line(aes(y=dy1),linetype = 3,size=1.3,color = "#55A667FF") +
geom_line(aes(y=dy2),linetype = 3,size=1.3,color = "#55A667FF") +
geom_line(aes(y=dy3),linetype = 3,size=1.3,color = "#55A667FF") +
geom_line(aes(y=dy4),linetype = 3,size=1.3,color = "#55A667FF") +
geom_line(aes(y=dm1),linetype = 4,size=1.3,color = "#CC6870FF") +
geom_line(aes(y=dm2),linetype = 4,size=1.3,color = "#CC6870FF") +
theme_light() + xlab("Dose") + ylab("Liver Weight")
fy_plot
doses = seq(0,100,1)
require(gridExtra)
grid.arrange(my_plot, fy_plot, ncol=2)
library(ggplot2)
library(splines2)
library(ToxicR)
Hill.p <- rbind(c(481,-250.3,70,3.3),
c(481,-250.3,40,1.3),
c(481,-250.2,15,1.1),
c(481,-250.3,50,4) ,
c(10.58,9.7,70,3.5),
c(10.58,9.7,25,3),
c(10.58,9.7,15,2),
c(10.58,9.7,50,4))
hill <- data.frame(a=Hill.p[,1],b=Hill.p[,2],
c=Hill.p[,3],d=Hill.p[,4])
Exp5.p <- rbind(c(481,0.05,log(1/1.42870),2),
c(481,0.02,log(1/1.42870),2),
c(481,0.01,log(1/1.42870),2),
c(481,0.1,log(1/1.42870),2) ,
c(10.58,0.05,log(1.5),1.5),
c(10.58,0.02,log(1.5),1.5),
c(10.58,0.01,log(1.5),1.5),
c(10.58,0.1,log(1.5),1.5))
Exp5 <- data.frame(a=Exp5.p[,1],b=Exp5.p[,2],
c=Exp5.p[,3],d=Exp5.p[,4])
#log-transformed for fitting as in ToxicR use
beta1 <- c(0.15486274,0.14054532,0.05806702,0.67421470,0.18371405,0.92821744,1.60669594,1.04508522)
beta2 <- c(0.677816175,0.322787366,3.356424380,0.102841870,0.009085238,0.087907971,0.344255936,0.100000000)
#add 481 to get the background
beta3 <- c(-45.715480,-53.668821,-14.266726, -8.066441,-1.620326 ,-1.800000,-1.800000 ,-1.800000)
beta4 <- c(-11.9566632,-19.9908719,-39.3450020,-16.3895141,-2.8191037,-4.5801731,-0.834784,-0.7000000)
iSpline <- rbind(beta1,beta2,beta3,beta4)
iS <- data.frame(b1=iSpline[,1],b2=iSpline[,2],b3 = iSpline[,3],
b4=iSpline[,4],b5=iSpline[,5],b6 = iSpline[,6],
b7=iSpline[,7],b8=iSpline[,8])
row.names(iS) <- c("iSpline Simulation 1","iSpline Simulation 2",
"iSpline Simulation 3","iSpline Simulation 4")
doses = seq(0,100,1)
my_plot <- ggplot(data=data.frame(doses=doses), aes(x=doses))
d5y1 = cont_exp_5_f(Exp5.p[1,],doses)
d5y2 = cont_exp_5_f(Exp5.p[2,],doses)
d5y3 = cont_exp_5_f(Exp5.p[3,],doses)
d5y4 = cont_exp_5_f(Exp5.p[4,],doses)
dy1 = cont_hill_f(Hill.p[1,],doses)
dy2 = cont_hill_f(Hill.p[2,],doses)
dy3 = cont_hill_f(Hill.p[3,],doses)
dy4 = cont_hill_f(Hill.p[4,],doses)
X <- iSpline(doses,knots=seq(30,90,20))
dm1 <- X%*%t(iS[3,,drop=F]) + 481
dm2 <- X%*%t(iS[4,,drop=F]) + 481
my_plot <- ggplot(data=data.frame(doses=doses), aes(x=doses))
my_plot = my_plot + geom_line(aes(y=d5y1),linetype = 2,size=1.3,color = "#39568CFF") +
geom_line(aes(y=d5y2),linetype = 2,size=1.3,color = "#39568CFF") +
geom_line(aes(y=d5y3),linetype = 2,size=1.3,color = "#39568CFF") +
geom_line(aes(y=d5y4),linetype = 2,size=1.3,color = "#39568CFF") +
geom_line(aes(y=dy1),linetype = 3,size=1.3,color = "#55A667FF") +
geom_line(aes(y=dy2),linetype = 3,size=1.3,color = "#55A667FF") +
geom_line(aes(y=dy3),linetype = 3,size=1.3,color = "#55A667FF") +
geom_line(aes(y=dy4),linetype = 3,size=1.3,color = "#55A667FF") +
geom_line(aes(y=dm1),linetype = 4,size=1.3,color = "#CC6870FF") +
geom_line(aes(y=dm2),linetype = 4,size=1.3,color = "#CC6870FF") +
theme_light() + xlab("Dose") + ylab("Body Weight")
my_plot
iS <- data.frame(b1=iSpline[,1],b2=iSpline[,2],b3 = iSpline[,3],
b4=iSpline[,4],b5=iSpline[,5],b6 = iSpline[,6],
b7=iSpline[,7],b8=iSpline[,8])
row.names(iS) <- c("iSpline Simulation 1","iSpline Simulation 2",
"iSpline Simulation 3","iSpline Simulation 4")
doses = seq(0,100,1)
ad5y1 = cont_exp_5_f(Exp5.p[5,],doses)
ad5y2 = cont_exp_5_f(Exp5.p[6,],doses)
ad5y3 = cont_exp_5_f(Exp5.p[7,],doses)
ad5y4 = cont_exp_5_f(Exp5.p[8,],doses)
ady1 = cont_hill_f(Hill.p[5,],doses)
ady2 = cont_hill_f(Hill.p[6,],doses)
ady3 = cont_hill_f(Hill.p[7,],doses)
ady4 = cont_hill_f(Hill.p[8,],doses)
X <- iSpline(doses,knots=seq(30,90,20))
dm1 <- X%*%t(iS[1,,drop=F]) + 10.58
dm2 <- X%*%t(iS[2,,drop=F]) + 10.58
fy_plot <- ggplot(data=data.frame(doses=doses), aes(x=doses))
fy_plot = fy_plot + geom_line(aes(y=ad5y1),linetype = 2,size=1.3,color = "#39568CFF") +
geom_line(aes(y=ad5y2),linetype = 2,size=1.3,color = "#39568CFF") +
geom_line(aes(y=ad5y3),linetype = 2,size=1.3,color = "#39568CFF") +
geom_line(aes(y=ad5y4),linetype = 2,size=1.3,color = "#39568CFF") +
geom_line(aes(y=ady1),linetype = 3,size=1.3,color = "#55A667FF") +
geom_line(aes(y=ady2),linetype = 3,size=1.3,color = "#55A667FF") +
geom_line(aes(y=ady3),linetype = 3,size=1.3,color = "#55A667FF") +
geom_line(aes(y=ady4),linetype = 3,size=1.3,color = "#55A667FF") +
geom_line(aes(y=adm1),linetype = 4,size=1.3,color = "#CC6870FF") +
geom_line(aes(y=adm2),linetype = 4,size=1.3,color = "#CC6870FF") +
theme_light() + xlab("Dose") + ylab("Liver Weight")
fy_plot
doses = seq(0,100,1)
require(gridExtra)
grid.arrange(my_plot, fy_plot, ncol=2)
library(ggplot2)
library(splines2)
library(ToxicR)
Hill.p <- rbind(c(481,-250.3,70,3.3),
c(481,-250.3,40,1.3),
c(481,-250.2,15,1.1),
c(481,-250.3,50,4) ,
c(10.58,9.7,70,3.5),
c(10.58,9.7,25,3),
c(10.58,9.7,15,2),
c(10.58,9.7,50,4))
hill <- data.frame(a=Hill.p[,1],b=Hill.p[,2],
c=Hill.p[,3],d=Hill.p[,4])
Exp5.p <- rbind(c(481,0.05,log(1/1.42870),2),
c(481,0.02,log(1/1.42870),2),
c(481,0.01,log(1/1.42870),2),
c(481,0.1,log(1/1.42870),2) ,
c(10.58,0.05,log(1.5),1.5),
c(10.58,0.02,log(1.5),1.5),
c(10.58,0.01,log(1.5),1.5),
c(10.58,0.1,log(1.5),1.5))
Exp5 <- data.frame(a=Exp5.p[,1],b=Exp5.p[,2],
c=Exp5.p[,3],d=Exp5.p[,4])
#log-transformed for fitting as in ToxicR use
beta1 <- c(0.15486274,0.14054532,0.05806702,0.67421470,0.18371405,0.92821744,1.60669594,1.04508522)
beta2 <- c(0.677816175,0.322787366,3.356424380,0.102841870,0.009085238,0.087907971,0.344255936,0.100000000)
#add 481 to get the background
beta3 <- c(-45.715480,-53.668821,-14.266726, -8.066441,-1.620326 ,-1.800000,-1.800000 ,-1.800000)
beta4 <- c(-11.9566632,-19.9908719,-39.3450020,-16.3895141,-2.8191037,-4.5801731,-0.834784,-0.7000000)
iSpline <- rbind(beta1,beta2,beta3,beta4)
iS <- data.frame(b1=iSpline[,1],b2=iSpline[,2],b3 = iSpline[,3],
b4=iSpline[,4],b5=iSpline[,5],b6 = iSpline[,6],
b7=iSpline[,7],b8=iSpline[,8])
row.names(iS) <- c("iSpline Simulation 1","iSpline Simulation 2",
"iSpline Simulation 3","iSpline Simulation 4")
doses = seq(0,100,1)
my_plot <- ggplot(data=data.frame(doses=doses), aes(x=doses))
d5y1 = cont_exp_5_f(Exp5.p[1,],doses)
d5y2 = cont_exp_5_f(Exp5.p[2,],doses)
d5y3 = cont_exp_5_f(Exp5.p[3,],doses)
d5y4 = cont_exp_5_f(Exp5.p[4,],doses)
dy1 = cont_hill_f(Hill.p[1,],doses)
dy2 = cont_hill_f(Hill.p[2,],doses)
dy3 = cont_hill_f(Hill.p[3,],doses)
dy4 = cont_hill_f(Hill.p[4,],doses)
X <- iSpline(doses,knots=seq(30,90,20))
dm1 <- X%*%t(iS[3,,drop=F]) + 481
dm2 <- X%*%t(iS[4,,drop=F]) + 481
my_plot <- ggplot(data=data.frame(doses=doses), aes(x=doses))
my_plot = my_plot + geom_line(aes(y=d5y1),linetype = 2,size=1.3,color = "#39568CFF") +
geom_line(aes(y=d5y2),linetype = 2,size=1.3,color = "#39568CFF") +
geom_line(aes(y=d5y3),linetype = 2,size=1.3,color = "#39568CFF") +
geom_line(aes(y=d5y4),linetype = 2,size=1.3,color = "#39568CFF") +
geom_line(aes(y=dy1),linetype = 3,size=1.3,color = "#55A667FF") +
geom_line(aes(y=dy2),linetype = 3,size=1.3,color = "#55A667FF") +
geom_line(aes(y=dy3),linetype = 3,size=1.3,color = "#55A667FF") +
geom_line(aes(y=dy4),linetype = 3,size=1.3,color = "#55A667FF") +
geom_line(aes(y=dm1),linetype = 4,size=1.3,color = "#CC6870FF") +
geom_line(aes(y=dm2),linetype = 4,size=1.3,color = "#CC6870FF") +
theme_light() + xlab("Dose") + ylab("Body Weight")
my_plot
iS <- data.frame(b1=iSpline[,1],b2=iSpline[,2],b3 = iSpline[,3],
b4=iSpline[,4],b5=iSpline[,5],b6 = iSpline[,6],
b7=iSpline[,7],b8=iSpline[,8])
row.names(iS) <- c("iSpline Simulation 1","iSpline Simulation 2",
"iSpline Simulation 3","iSpline Simulation 4")
doses = seq(0,100,1)
ad5y1 = cont_exp_5_f(Exp5.p[5,],doses)
ad5y2 = cont_exp_5_f(Exp5.p[6,],doses)
ad5y3 = cont_exp_5_f(Exp5.p[7,],doses)
ad5y4 = cont_exp_5_f(Exp5.p[8,],doses)
ady1 = cont_hill_f(Hill.p[5,],doses)
ady2 = cont_hill_f(Hill.p[6,],doses)
ady3 = cont_hill_f(Hill.p[7,],doses)
ady4 = cont_hill_f(Hill.p[8,],doses)
X <- iSpline(doses,knots=seq(30,90,20))
adm1 <- X%*%t(iS[1,,drop=F]) + 10.58
adm2 <- X%*%t(iS[2,,drop=F]) + 10.58
fy_plot <- ggplot(data=data.frame(doses=doses), aes(x=doses))
fy_plot = fy_plot + geom_line(aes(y=ad5y1),linetype = 2,size=1.3,color = "#39568CFF") +
geom_line(aes(y=ad5y2),linetype = 2,size=1.3,color = "#39568CFF") +
geom_line(aes(y=ad5y3),linetype = 2,size=1.3,color = "#39568CFF") +
geom_line(aes(y=ad5y4),linetype = 2,size=1.3,color = "#39568CFF") +
geom_line(aes(y=ady1),linetype = 3,size=1.3,color = "#55A667FF") +
geom_line(aes(y=ady2),linetype = 3,size=1.3,color = "#55A667FF") +
geom_line(aes(y=ady3),linetype = 3,size=1.3,color = "#55A667FF") +
geom_line(aes(y=ady4),linetype = 3,size=1.3,color = "#55A667FF") +
geom_line(aes(y=adm1),linetype = 4,size=1.3,color = "#CC6870FF") +
geom_line(aes(y=adm2),linetype = 4,size=1.3,color = "#CC6870FF") +
theme_light() + xlab("Dose") + ylab("Liver Weight")
fy_plot
doses = seq(0,100,1)
require(gridExtra)
grid.arrange(my_plot, fy_plot, ncol=2)
library(ggplot2)
library(splines2)
library(ToxicR)
Hill.p <- rbind(c(481,-250.3,70,3.3),
c(481,-250.3,40,1.3),
c(481,-250.2,15,1.1),
c(481,-250.3,50,4) ,
c(10.58,9.7,70,3.5),
c(10.58,9.7,25,3),
c(10.58,9.7,15,2),
c(10.58,9.7,50,4))
hill <- data.frame(a=Hill.p[,1],b=Hill.p[,2],
c=Hill.p[,3],d=Hill.p[,4])
Exp5.p <- rbind(c(481,0.05,log(1/1.42870),2),
c(481,0.02,log(1/1.42870),2),
c(481,0.01,log(1/1.42870),2),
c(481,0.1,log(1/1.42870),2) ,
c(10.58,0.05,log(1.5),1.5),
c(10.58,0.02,log(1.5),1.5),
c(10.58,0.01,log(1.5),1.5),
c(10.58,0.1,log(1.5),1.5))
Exp5 <- data.frame(a=Exp5.p[,1],b=Exp5.p[,2],
c=Exp5.p[,3],d=Exp5.p[,4])
#log-transformed for fitting as in ToxicR use
beta1 <- c(0.15486274,0.14054532,0.05806702,0.67421470,0.18371405,0.92821744,1.60669594,1.04508522)
beta2 <- c(0.677816175,0.322787366,3.356424380,0.102841870,0.009085238,0.087907971,0.344255936,0.100000000)
#add 481 to get the background
beta3 <- c(-45.715480,-53.668821,-14.266726, -8.066441,-1.620326 ,-1.800000,-1.800000 ,-1.800000)
beta4 <- c(-11.9566632,-19.9908719,-39.3450020,-16.3895141,-2.8191037,-4.5801731,-0.834784,-0.7000000)
iSpline <- rbind(beta1,beta2,beta3,beta4)
iS <- data.frame(b1=iSpline[,1],b2=iSpline[,2],b3 = iSpline[,3],
b4=iSpline[,4],b5=iSpline[,5],b6 = iSpline[,6],
b7=iSpline[,7],b8=iSpline[,8])
row.names(iS) <- c("iSpline Simulation 1","iSpline Simulation 2",
"iSpline Simulation 3","iSpline Simulation 4")
doses = seq(0,100,1)
my_plot <- ggplot(data=data.frame(doses=doses), aes(x=doses))
d5y1 = cont_exp_5_f(Exp5.p[1,],doses)
d5y2 = cont_exp_5_f(Exp5.p[2,],doses)
d5y3 = cont_exp_5_f(Exp5.p[3,],doses)
d5y4 = cont_exp_5_f(Exp5.p[4,],doses)
dy1 = cont_hill_f(Hill.p[1,],doses)
dy2 = cont_hill_f(Hill.p[2,],doses)
dy3 = cont_hill_f(Hill.p[3,],doses)
dy4 = cont_hill_f(Hill.p[4,],doses)
X <- iSpline(doses,knots=seq(30,90,20))
dm1 <- X%*%t(iS[3,,drop=F]) + 481
dm2 <- X%*%t(iS[4,,drop=F]) + 481
my_plot <- ggplot(data=data.frame(doses=doses), aes(x=doses))
my_plot = my_plot + geom_line(aes(y=d5y1),linetype = 2,size=1.3,color = "#39568CFF") +
geom_line(aes(y=d5y2),linetype = 2,size=1.3,color = "#39568CFF") +
geom_line(aes(y=d5y3),linetype = 2,size=1.3,color = "#39568CFF") +
geom_line(aes(y=d5y4),linetype = 2,size=1.3,color = "#39568CFF") +
geom_line(aes(y=dy1),linetype = 3,size=1.3,color = "#55A667FF") +
geom_line(aes(y=dy2),linetype = 3,size=1.3,color = "#55A667FF") +
geom_line(aes(y=dy3),linetype = 3,size=1.3,color = "#55A667FF") +
geom_line(aes(y=dy4),linetype = 3,size=1.3,color = "#55A667FF") +
geom_line(aes(y=dm1),linetype = 4,size=1.3,color = "#CC6870FF") +
geom_line(aes(y=dm2),linetype = 4,size=1.3,color = "#CC6870FF") +
theme_light() + xlab("Dose") + ylab("Body Weight (g)")
my_plot
iS <- data.frame(b1=iSpline[,1],b2=iSpline[,2],b3 = iSpline[,3],
b4=iSpline[,4],b5=iSpline[,5],b6 = iSpline[,6],
b7=iSpline[,7],b8=iSpline[,8])
row.names(iS) <- c("iSpline Simulation 1","iSpline Simulation 2",
"iSpline Simulation 3","iSpline Simulation 4")
doses = seq(0,100,1)
ad5y1 = cont_exp_5_f(Exp5.p[5,],doses)
ad5y2 = cont_exp_5_f(Exp5.p[6,],doses)
ad5y3 = cont_exp_5_f(Exp5.p[7,],doses)
ad5y4 = cont_exp_5_f(Exp5.p[8,],doses)
ady1 = cont_hill_f(Hill.p[5,],doses)
ady2 = cont_hill_f(Hill.p[6,],doses)
ady3 = cont_hill_f(Hill.p[7,],doses)
ady4 = cont_hill_f(Hill.p[8,],doses)
X <- iSpline(doses,knots=seq(30,90,20))
adm1 <- X%*%t(iS[1,,drop=F]) + 10.58
adm2 <- X%*%t(iS[2,,drop=F]) + 10.58
fy_plot <- ggplot(data=data.frame(doses=doses), aes(x=doses))
fy_plot = fy_plot + geom_line(aes(y=ad5y1),linetype = 2,size=1.3,color = "#39568CFF") +
geom_line(aes(y=ad5y2),linetype = 2,size=1.3,color = "#39568CFF") +
geom_line(aes(y=ad5y3),linetype = 2,size=1.3,color = "#39568CFF") +
geom_line(aes(y=ad5y4),linetype = 2,size=1.3,color = "#39568CFF") +
geom_line(aes(y=ady1),linetype = 3,size=1.3,color = "#55A667FF") +
geom_line(aes(y=ady2),linetype = 3,size=1.3,color = "#55A667FF") +
geom_line(aes(y=ady3),linetype = 3,size=1.3,color = "#55A667FF") +
geom_line(aes(y=ady4),linetype = 3,size=1.3,color = "#55A667FF") +
geom_line(aes(y=adm1),linetype = 4,size=1.3,color = "#CC6870FF") +
geom_line(aes(y=adm2),linetype = 4,size=1.3,color = "#CC6870FF") +
theme_light() + xlab("Dose") + ylab("Liver Weight (g)")
fy_plot
doses = seq(0,100,1)
require(gridExtra)
grid.arrange(my_plot, fy_plot, ncol=2)
rm(list=objects())
dose = seq(0,80,1)
latent_mean = -1.277 + 0.043*dose
latent_mean = -1.277 + 0.0431*dose
plot(dose,pnorm(latent_mean))
plot(dose,pnorm(latent_mean),type='l')
t_cov <- c(  1.00000000,            0.016003947 ,          -0.345598587,       0.016775706,
0.01600395 ,           1.000000000,           0.004282343 ,       -0.350611812,
-0.34559859,            0.004282343,           1.000000000 ,       0.009277648,
0.01677571 ,           -0.350611812,          0.009277648 ,       1.000000000)
cov_mat <- matrix(t_cov,4,4)
cov_mat
cov_mat <- matrix(t_cov,4,4)
dose = seq(0,80,1)
lm1 = -1.277 + 0.0431*dose
lm2 = -1.64  + 0.0311*dose
lm3 = -2.727 + 0.0482*dose
lm4 = -1.216 + 0.0339*dose
d40m = c(lm1[41],lm2[41],lm3[41],lm4[41])
d40m
pnorm(d40m)
d40m = matrix(c(lm1[41],lm2[41],lm3[41],lm4[41]),4,1)
norm_1 = matrix(rnorm(40000),4,10000)
d40m
random_values = t(chol(cov_mat))%*%norm_1 + d40m
norm_1 = matrix(rnorm(40000),4,10000)
dim(norm_1)
cov_mat
t(chol(cov_mat))%*%norm_1
random_values = t(chol(cov_mat))%*%norm_1
random_values = t(chol(cov_mat))%*%norm_1 + d40m
random_values = t(chol(cov_mat))%*%norm_1
random_values = t(chol(cov_mat))%*%norm_1 + matrix(d40m,4,10000)
random_values = t(chol(cov_mat))%*%norm_1 + matrix(d40m,4,10000)
plot(random_values[3,],random_values[4,])
plot(random_values[3,],random_values[2,])
plot(random_values[3,],random_values[1,])
abline(v=lm1[41],col="red")
abline(h=lm1[41],col="red")
plot(random_values[3,],random_values[1,])
abline(h=lm1[41],col="red")
abline(v=lm3[41],col="red")
plot(random_values[3,],random_values[1,])
abline(h=0,col="red")
abline(v=0,col="red")
plot(pnorm(random_values[3,]),pnorm(random_values[1,]))
abline(h=0.5,col="red")
abline(v=0.5,col="red")
#dose = 0
d0m = matrix(c(lm1[1],lm2[1],lm3[1],lm4[1]),4,1)
norm_1 = matrix(rnorm(40000),4,10000)
random_values = t(chol(cov_mat))%*%norm_1 + matrix(d40m,4,10000)
plot(random_values[3,],random_values[1,])
abline(h=0,col="red")
abline(v=0,col="red")
plot(pnorm(random_values[3,]),pnorm(random_values[1,]))
abline(h=0.5,col="red")
abline(v=0.5,col="red")
plot(dose,pnorm(latent_mean),type='l')
#dose = 0
d0m = matrix(c(lm1[1],lm2[1],lm3[1],lm4[1]),4,1)
norm_1 = matrix(rnorm(40000),4,10000)
random_values = t(chol(cov_mat))%*%norm_1 + matrix(d40m,4,10000)
plot(random_values[3,],random_values[1,])
abline(h=0,col="red")
abline(v=0,col="red")
#dose = 0
d0m = matrix(c(lm1[1],lm2[1],lm3[1],lm4[1]),4,1)
norm_1 = matrix(rnorm(40000),4,10000)
random_values = t(chol(cov_mat))%*%norm_1 + matrix(d0m,4,10000)
plot(random_values[3,],random_values[1,])
abline(h=0,col="red")
abline(v=0,col="red")
d0m = matrix(c(lm1[11],lm2[11],lm3[11],lm4[11]),4,1)
norm_1 = matrix(rnorm(40000),4,10000)
random_values = t(chol(cov_mat))%*%norm_1 + matrix(d0m,4,10000)
plot(random_values[3,],random_values[1,])
abline(h=0,col="red")
abline(v=0,col="red")
library(ToxicR)
setwd("~/Documents/r_software/RBMDS")
library(ToxicR)
doses<- c(0,0,0,0,0.156,0.156,0.156,0.3125,0.3125,0.3125,
0.625,0.625,0.625,1.25,1.25,1.25,2.5,2.5,2.5,5,5,
5,5,10,10,10,10,20,20,20,20)
PFOA_Liver <- read_table2("~/Documents/PFOA_Liver.txt",
col_names = FALSE)
library(ToxicR)
doses<- c(0,0,0,0,0.156,0.156,0.156,0.3125,0.3125,0.3125,
0.625,0.625,0.625,1.25,1.25,1.25,2.5,2.5,2.5,5,5,
5,5,10,10,10,10,20,20,20,20)
PFOA_Liver <- read_table2("~/Documents/PFOA_Liver.txt",
col_names = FALSE)
library(ToxicR)
library(readr)
doses<- c(0,0,0,0,0.156,0.156,0.156,0.3125,0.3125,0.3125,
0.625,0.625,0.625,1.25,1.25,1.25,2.5,2.5,2.5,5,5,
5,5,10,10,10,10,20,20,20,20)
PFOA_Liver <- read_table2("~/Documents/PFOA_Liver.txt",
col_names = FALSE)
rm(list=objects())
temp <- PFOA_Liver %>% filter(X1 == "CYP3A1_32809")
v1 <- as.numeric(temp[2:length(temp)])
library(dplyr)
temp <- PFOA_Liver %>% filter(X1 == "CYP3A1_32809")
library(ToxicR)
library(readr)
doses<- c(0,0,0,0,0.156,0.156,0.156,0.3125,0.3125,0.3125,
0.625,0.625,0.625,1.25,1.25,1.25,2.5,2.5,2.5,5,5,
5,5,10,10,10,10,20,20,20,20)
setwd("~/Documents")
PFOA_Liver <- read_table2("PFOA_Liver.txt",
col_names = FALSE)
temp <- PFOA_Liver %>% filter(X1 == "CYP3A1_32809")
v1 <- as.numeric(temp[2:length(temp)])
fit1  <- single_continuous_fit(as.matrix((doses)),as.matrix(v1),model_type = "exp-5", distribution="normal",degree=3,fit_type = "laplace",BMR = 3,isFast=T)
fit2  <- single_continuous_fit(as.matrix((doses)),as.matrix(v1),model_type = "hill", distribution="normal",degree=3,fit_type = "mcmc",BMR = 0.2,BMD_TYPE = "reldev")
fit3  <- ma_continuous_fit(as.matrix(doses),as.matrix(v1),fit_type = "laplace",BMD_TYPE = "SD", BMR =1.5)
temp <- PFOA_Liver %>% filter(X1 == "CYP3A1_32809")
v1 <- as.numeric(temp[2:length(temp)])
fit1  <- single_continuous_fit(as.matrix((doses)),as.matrix(v1),model_type = "exp-5", distribution="normal",degree=3,fit_type = "laplace",BMR = 3,isFast=T)
plot(fit1)
fit2  <- single_continuous_fit(as.matrix((doses)),as.matrix(v1),model_type = "hill", distribution="normal",
degree=3,fit_type = "mcmc",BMR = 0.2,BMD_TYPE = "rel") #20% increase
plot(fit2)
fit2  <- single_continuous_fit(as.matrix((doses)),as.matrix(v1),model_type = "hill", distribution="normal",
degree=3,fit_type = "mcmc",BMR = 1.2,BMD_TYPE = "rel") #20% increase
fit2  <- single_continuous_fit(as.matrix((doses)),as.matrix(v1),model_type = "hill", distribution="normal",
degree=3,fit_type = "mcmc",BMR = 0.05,BMD_TYPE = "rel") #5% increase
plot(fit2)
fit3  <- ma_continuous_fit(as.matrix(doses),as.matrix(v1),fit_type = "laplace",BMD_TYPE = "sd", BMR =1.5) #1.5 standard deviations
plot(fit3)
setwd("~/Documents/r_software/RBMDS/John's Stuff")
